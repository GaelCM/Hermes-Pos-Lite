DO $$
DECLARE
    cat_id INT;
    prod_id INT;
    unit_id INT;
    sucursal_id INT := 2; -- El Amigo
BEGIN

    -- Row 2: 613008738822 (Pz Kiwi Fresa Arizona 680ml) - [Factor: 1]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '613008738822';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('613008738822', 'Pz Kiwi Fresa Arizona 680ml', 1, 15.2) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'Pieza' (Factor: 1)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 1 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 1 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'Pieza', 1) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 16, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 16, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 0, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 0, 0);
    END IF;

    -- Row 3: 7501055303878 (2lt Fanta) - [Factor: 1]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '7501055303878';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('7501055303878', '2lt Fanta', 1, 20.75) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'Pieza' (Factor: 1)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 1 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 1 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'Pieza', 1) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 23.12, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 23.12, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 0, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 0, 0);
    END IF;

    -- Row 4: 7501055303885 (2lt Fresca) - [Factor: 1]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '7501055303885';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('7501055303885', '2lt Fresca', 1, 20.75) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'Pieza' (Factor: 1)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 1 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 1 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'Pieza', 1) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 23.16, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 23.16, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 32, cantidad_minima = 8 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 32, 8);
    END IF;

    -- Row 5: 7501055340002 (2lt Sidral) - [Factor: 1]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '7501055340002';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('7501055340002', '2lt Sidral', 1, 20.75) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'Pieza' (Factor: 1)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 1 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 1 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'Pieza', 1) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 23.12, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 23.12, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 96, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 96, 0);
    END IF;

    -- Row 6: 7501055305650 (2lt Sprite) - [Factor: 1]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '7501055305650';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('7501055305650', '2lt Sprite', 1, 20.75) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'Pieza' (Factor: 1)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 1 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 1 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'Pieza', 1) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 23.11, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 23.11, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 136, cantidad_minima = 8 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 136, 8);
    END IF;

    -- Row 7: 7503049695655 (AGUA AQUA 3L 6PZ) - [Factor: 6]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '7503049695655';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('7503049695655', 'AGUA AQUA 3L 6PZ', 1, 65) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'PAQUETE' (Factor: 6)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 6 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 6 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'PAQUETE', 6) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 90, precio_mayoreo = 80 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 90, 80);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 177, cantidad_minima = 1 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 177, 1);
    END IF;

    -- Row 8: 7501086801015 (AGUA EPURA 1.5ML CON 12PZ) - [Factor: 12]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '7501086801015';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('7501086801015', 'AGUA EPURA 1.5ML CON 12PZ', 1, 135) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'PAQUETE' (Factor: 12)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 12 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 12 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'PAQUETE', 12) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 155, precio_mayoreo = 150 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 155, 150);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 0, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 0, 0);
    END IF;

    -- Row 9: 7501086801121 (AGUA Epura De 600 Ml CON 12 PZ) - [Factor: 12]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '7501086801121';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('7501086801121', 'AGUA Epura De 600 Ml CON 12 PZ', 1, 78) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'PAQUETE' (Factor: 12)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 12 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 12 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'PAQUETE', 12) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 95, precio_mayoreo = 90 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 95, 90);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 13, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 13, 0);
    END IF;

    -- Row 10: 7500533013445 (AGUA MEMBER 237ML 40PZ) - [Factor: 40]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '7500533013445';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('7500533013445', 'AGUA MEMBER 237ML 40PZ', 1, 80) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'PAQUETE' (Factor: 40)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 40 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 40 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'PAQUETE', 40) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 95, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 95, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 1, cantidad_minima = 1 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 1, 1);
    END IF;

    -- Row 11: 7500533003910 (AGUA MEMBERS 355ML 40PZ) - [Factor: 40]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '7500533003910';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('7500533003910', 'AGUA MEMBERS 355ML 40PZ', 1, 96.16) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'PAQUETE' (Factor: 40)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 40 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 40 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'PAQUETE', 40) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 110, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 110, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 9, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 9, 0);
    END IF;

    -- Row 12: 7503037623684 (AGUA VIDA 1.5L) - [Factor: 1]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '7503037623684';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('7503037623684', 'AGUA VIDA 1.5L', 1, 70) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'Pieza' (Factor: 1)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 1 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 1 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'Pieza', 1) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 95, precio_mayoreo = 85 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 95, 85);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 95, cantidad_minima = 1 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 95, 1);
    END IF;

    -- Row 13: 7506192511155 (AMPER MANGO 473ML) - [Factor: 1]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '7506192511155';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('7506192511155', 'AMPER MANGO 473ML', 14, 170) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'Pieza' (Factor: 1)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 1 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 1 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'Pieza', 1) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 190, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 190, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 15, cantidad_minima = 1 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 15, 1);
    END IF;

    -- Row 14: 17501060500016 (Aceite Patrona 1lt Con 12 Pz) - [Factor: 12]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '17501060500016';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('17501060500016', 'Aceite Patrona 1lt Con 12 Pz', 2, 389) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'PAQUETE' (Factor: 12)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 12 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 12 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'PAQUETE', 12) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 420, precio_mayoreo = 420 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 420, 420);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 3, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 3, 0);
    END IF;

    -- Row 15: AGUAAQUA67807 (Agua Aqua 625ml) - [Factor: 1]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = 'AGUAAQUA67807';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('AGUAAQUA67807', 'Agua Aqua 625ml', 1, 48) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'Pieza' (Factor: 1)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 1 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 1 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'Pieza', 1) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 65, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 65, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 31, cantidad_minima = 1 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 31, 1);
    END IF;

    -- Row 16: 7501055337033 (Agua Ciel 2l 8pz) - [Factor: 8]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '7501055337033';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('7501055337033', 'Agua Ciel 2l 8pz', 1, 120) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'PAQUETE' (Factor: 8)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 8 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 8 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'PAQUETE', 8) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 135, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 135, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 9, cantidad_minima = 1 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 9, 1);
    END IF;

    -- Row 17: 7501086800636 (Agua E Pura 2l 8pz) - [Factor: 8]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '7501086800636';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('7501086800636', 'Agua E Pura 2l 8pz', 1, 87.04) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'PAQUETE' (Factor: 8)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 8 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 8 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'PAQUETE', 8) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 120, precio_mayoreo = 115 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 120, 115);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 29, cantidad_minima = 1 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 29, 1);
    END IF;

    -- Row 18: 7501086801046 (Agua EPura 1l Con 12 Pzs) - [Factor: 12]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '7501086801046';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('7501086801046', 'Agua EPura 1l Con 12 Pzs', 1, 95.88) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'PAQUETE' (Factor: 12)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 12 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 12 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'PAQUETE', 12) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 110, precio_mayoreo = 100 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 110, 100);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 37, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 37, 0);
    END IF;

    -- Row 19: 7874213780 (Agua Members 1.5lt 15pz) - [Factor: 15]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '7874213780';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('7874213780', 'Agua Members 1.5lt 15pz', 1, 66) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'PAQUETE' (Factor: 15)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 15 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 15 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'PAQUETE', 15) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 120, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 120, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 13, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 13, 0);
    END IF;

    -- Row 20: 750053300797 (Agua Membert 1lt 18 Pz) - [Factor: 18]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '750053300797';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('750053300797', 'Agua Membert 1lt 18 Pz', 1, 78.05) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'PAQUETE' (Factor: 18)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 18 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 18 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'PAQUETE', 18) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 100, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 100, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 4, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 4, 0);
    END IF;

    -- Row 21: 7500533002944 (Agua Membert 500ml 45 Pa) - [Factor: 1]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '7500533002944';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('7500533002944', 'Agua Membert 500ml 45 Pa', 1, 117.3) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'Pieza' (Factor: 1)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 1 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 1 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'Pieza', 1) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 140, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 140, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 6, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 6, 0);
    END IF;

    -- Row 22: 2113601048 (Agua Mineral Topochico 1.5) - [Factor: 1]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '2113601048';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('2113601048', 'Agua Mineral Topochico 1.5', 1, 142.8) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'Pieza' (Factor: 1)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 1 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 1 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'Pieza', 1) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 160, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 160, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 2, cantidad_minima = 1 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 2, 1);
    END IF;

    -- Row 23: 758104005666 (Aguita Bonakids Manzana 300ml Con 6pz) - [Factor: 6]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '758104005666';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('758104005666', 'Aguita Bonakids Manzana 300ml Con 6pz', 1, 40) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'PAQUETE' (Factor: 6)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 6 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 6 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'PAQUETE', 6) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 45, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 45, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 1, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 1, 0);
    END IF;

    -- Row 24: 758104005994 (Aguita Bonakids Naranja 300ml Con 6 Pz) - [Factor: 6]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '758104005994';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('758104005994', 'Aguita Bonakids Naranja 300ml Con 6 Pz', 1, 40) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'PAQUETE' (Factor: 6)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 6 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 6 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'PAQUETE', 6) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 45, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 45, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 9, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 9, 0);
    END IF;

    -- Row 25: 758104006588 (Aguita Bonakids Surtido 300ml Tapa Con 24 Pz) - [Factor: 24]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '758104006588';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('758104006588', 'Aguita Bonakids Surtido 300ml Tapa Con 24 Pz', 1, 124.5) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'PAQUETE' (Factor: 24)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 24 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 24 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'PAQUETE', 24) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 145, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 145, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 0, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 0, 0);
    END IF;

    -- Row 26: 758104005673 (Aguita Bonakids Uva 300ml Con 6pz) - [Factor: 6]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '758104005673';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('758104005673', 'Aguita Bonakids Uva 300ml Con 6pz', 1, 40) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'PAQUETE' (Factor: 6)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 6 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 6 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'PAQUETE', 6) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 45, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 45, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 11, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 11, 0);
    END IF;

    -- Row 27: 7506192509084 (Amper Kalaca Punch 473ml) - [Factor: 1]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '7506192509084';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('7506192509084', 'Amper Kalaca Punch 473ml', 14, 172) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'Pieza' (Factor: 1)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 1 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 1 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'Pieza', 1) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 190, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 190, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 13, cantidad_minima = 1 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 13, 1);
    END IF;

    -- Row 28: 1275061925077181524 (Amper Lata Mora De 473ml Con 12pz) - [Factor: 12]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '1275061925077181524';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('1275061925077181524', 'Amper Lata Mora De 473ml Con 12pz', 14, 172) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'PAQUETE' (Factor: 12)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 12 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 12 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'PAQUETE', 12) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 190, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 190, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 13, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 13, 0);
    END IF;

    -- Row 29: 7506192509633 (Amper Mora Plastico 400ml 12 Pz) - [Factor: 12]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '7506192509633';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('7506192509633', 'Amper Mora Plastico 400ml 12 Pz', 10, 85) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'PAQUETE' (Factor: 12)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 12 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 12 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'PAQUETE', 12) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 144, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 144, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 0, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 0, 0);
    END IF;

    -- Row 30: ARIZONA12 (Arizona 680ml Media Caja) - [Factor: 1]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = 'ARIZONA12';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('ARIZONA12', 'Arizona 680ml Media Caja', 1, 188) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'Pieza' (Factor: 1)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 1 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 1 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'Pieza', 1) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 198, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 198, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 8, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 8, 0);
    END IF;

    -- Row 31: 613008765200 (Arizona Lata 460ml Sdo 24pz) - [Factor: 24]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '613008765200';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('613008765200', 'Arizona Lata 460ml Sdo 24pz', 1, 299.45) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'PAQUETE' (Factor: 24)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 24 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 24 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'PAQUETE', 24) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 340, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 340, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 14, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 14, 0);
    END IF;

    -- Row 32: ARIZONA24 (Arizona Sdo 24pz 680ml) - [Factor: 24]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = 'ARIZONA24';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('ARIZONA24', 'Arizona Sdo 24pz 680ml', 1, 338.64) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'PAQUETE' (Factor: 24)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 24 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 24 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'PAQUETE', 24) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 390, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 390, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 2, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 2, 0);
    END IF;

    -- Row 33: 7501013106091 (Arizona Sutida  Plastico De 591ml Con 12pz) - [Factor: 12]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '7501013106091';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('7501013106091', 'Arizona Sutida  Plastico De 591ml Con 12pz', 1, 157.09) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'PAQUETE' (Factor: 12)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 12 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 12 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'PAQUETE', 12) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 180, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 180, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 0, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 0, 0);
    END IF;

    -- Row 34: 7501022015940 (BE LIGHT CHUPON 330ML 24PZ SURTD) - [Factor: 24]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '7501022015940';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('7501022015940', 'BE LIGHT CHUPON 330ML 24PZ SURTD', 1, 148.85) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'PAQUETE' (Factor: 24)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 24 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 24 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'PAQUETE', 24) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 170, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 170, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 8, cantidad_minima = 1 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 8, 1);
    END IF;

    -- Row 35: 7501013191141 (BIDA 500 SURTIDO 12 PZ) - [Factor: 12]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '7501013191141';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('7501013191141', 'BIDA 500 SURTIDO 12 PZ', 1, 132) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'PAQUETE' (Factor: 12)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 12 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 12 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'PAQUETE', 12) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 150, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 150, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 16, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 16, 0);
    END IF;

    -- Row 36: 750081010013250 (BIG MIX FUEGO 55GR) - [Factor: 1]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '750081010013250';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('750081010013250', 'BIG MIX FUEGO 55GR', 7, 7.56) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'Pieza' (Factor: 1)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 1 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 1 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'Pieza', 1) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 8, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 8, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 1, cantidad_minima = 1 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 1, 1);
    END IF;

    -- Row 37: 758104000340 (BONAFON 750ML CHUPON) - [Factor: 1]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '758104000340';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('758104000340', 'BONAFON 750ML CHUPON', 1, 49.5) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'Pieza' (Factor: 1)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 1 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 1 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'Pieza', 1) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 60, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 60, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 7, cantidad_minima = 1 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 7, 1);
    END IF;

    -- Row 38: 758104000159 (BONAFONT 1.5L CON 12PZ) - [Factor: 12]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '758104000159';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('758104000159', 'BONAFONT 1.5L CON 12PZ', 1, 98.82) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'PAQUETE' (Factor: 12)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 12 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 12 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'PAQUETE', 12) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 130, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 130, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 203, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 203, 0);
    END IF;

    -- Row 39: 758104100422 (BONAFONT 1LT CON 12PZ) - [Factor: 12]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '758104100422';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('758104100422', 'BONAFONT 1LT CON 12PZ', 1, 81.02) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'PAQUETE' (Factor: 12)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 12 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 12 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'PAQUETE', 12) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 100, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 100, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 365, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 365, 0);
    END IF;

    -- Row 40: 758104007769 (BONAFONT 500ML CON 18PZ) - [Factor: 18]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '758104007769';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('758104007769', 'BONAFONT 500ML CON 18PZ', 1, 72) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'PAQUETE' (Factor: 18)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 18 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 18 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'PAQUETE', 18) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 90, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 90, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 4, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 4, 0);
    END IF;

    -- Row 41: 7501055387908 (Bacardi Mixed With Coca Cola 473ml 6pz) - [Factor: 6]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '7501055387908';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('7501055387908', 'Bacardi Mixed With Coca Cola 473ml 6pz', 10, 129.2) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'PAQUETE' (Factor: 6)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 6 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 6 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'PAQUETE', 6) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 150, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 150, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 8, cantidad_minima = 1 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 8, 1);
    END IF;

    -- Row 42: 7500533004719 (Banderilla De Tamarindo) - [Factor: 1]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '7500533004719';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('7500533004719', 'Banderilla De Tamarindo', 7, 142.19) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'Pieza' (Factor: 1)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 1 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 1 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'Pieza', 1) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 160, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 160, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 0, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 0, 0);
    END IF;

    -- Row 43: 757528037703 (7 Botanas Sdo 25pz) - [Factor: 25]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '757528037703';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('757528037703', '7 Botanas Sdo 25pz', 2, 222.72) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'PAQUETE' (Factor: 25)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 25 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 25 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'PAQUETE', 25) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 255, precio_mayoreo = 235 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 255, 235);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 0, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 0, 0);
    END IF;

    -- Row 44: 7501064114359 (Barrilito 355) - [Factor: 1]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '7501064114359';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('7501064114359', 'Barrilito 355', 10, 240) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'Pieza' (Factor: 1)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 1 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 1 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'Pieza', 1) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 270, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 270, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 53, cantidad_minima = 1 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 53, 1);
    END IF;

    -- Row 45: 7501011181809 (Be Ligh 1.5lt Sabores 6pz) - [Factor: 6]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '7501011181809';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('7501011181809', 'Be Ligh 1.5lt Sabores 6pz', 1, 100) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'PAQUETE' (Factor: 6)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 6 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 6 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'PAQUETE', 6) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 115, precio_mayoreo = 100 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 115, 100);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 1, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 1, 0);
    END IF;

    -- Row 46: 7501013105155 (Bida Lata 460ml Surtd) - [Factor: 1]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '7501013105155';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('7501013105155', 'Bida Lata 460ml Surtd', 1, 142.6) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'Pieza' (Factor: 1)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 1 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 1 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'Pieza', 1) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 160, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 160, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 19, cantidad_minima = 1 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 19, 1);
    END IF;

    -- Row 47: 7503033076859 (Big Cifrut 300ml 15pz) - [Factor: 15]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '7503033076859';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('7503033076859', 'Big Cifrut 300ml 15pz', 1, 56.25) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'PAQUETE' (Factor: 15)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 15 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 15 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'PAQUETE', 15) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 75, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 75, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 0, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 0, 0);
    END IF;

    -- Row 48: 7503027753070 (Big Cifrut 625ml 12pz) - [Factor: 12]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '7503027753070';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('7503027753070', 'Big Cifrut 625ml 12pz', 1, 90) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'PAQUETE' (Factor: 12)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 12 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 12 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'PAQUETE', 12) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 110, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 110, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 0, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 0, 0);
    END IF;

    -- Row 49: 7503049695099 (Big Cifrut Mora Azul 15pz 300ml) - [Factor: 15]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '7503049695099';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('7503049695099', 'Big Cifrut Mora Azul 15pz 300ml', 1, 56.25) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'PAQUETE' (Factor: 15)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 15 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 15 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'PAQUETE', 15) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 75, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 75, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 0, cantidad_minima = 1 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 0, 1);
    END IF;

    -- Row 50: 7503033076941 (Big Cola 300ml 12pz) - [Factor: 12]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '7503033076941';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('7503033076941', 'Big Cola 300ml 12pz', 1, 56) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'PAQUETE' (Factor: 12)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 12 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 12 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'PAQUETE', 12) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 70, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 70, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 0, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 0, 0);
    END IF;

    -- Row 51: 7506241203888 (Big Cola 3lt Con 6pz) - [Factor: 6]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '7506241203888';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('7506241203888', 'Big Cola 3lt Con 6pz', 1, 166) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'PAQUETE' (Factor: 6)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 6 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 6 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'PAQUETE', 6) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 180, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 180, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 7, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 7, 0);
    END IF;

    -- Row 52: 7503027753186 (Big Cola 9100ml) - [Factor: 1]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '7503027753186';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('7503027753186', 'Big Cola 9100ml', 1, 139) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'Pieza' (Factor: 1)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 1 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 1 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'Pieza', 1) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 160, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 160, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 0, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 0, 0);
    END IF;

    -- Row 53: 7500810013199 (Big Mix Fuego 80gr) - [Factor: 1]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '7500810013199';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('7500810013199', 'Big Mix Fuego 80gr', 7, 14.22) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'Pieza' (Factor: 1)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 1 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 1 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'Pieza', 1) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 16.35, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 16.35, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 0, cantidad_minima = 1 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 0, 1);
    END IF;

    -- Row 54: 7500810013205 (Big Mix Inglesa Limon 80gr) - [Factor: 1]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '7500810013205';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('7500810013205', 'Big Mix Inglesa Limon 80gr', 7, 14.22) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'Pieza' (Factor: 1)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 1 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 1 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'Pieza', 1) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 16.35, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 16.35, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 1, cantidad_minima = 1 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 1, 1);
    END IF;

    -- Row 55: 7500810013182 (Big Mix Queso 80gr) - [Factor: 1]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '7500810013182';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('7500810013182', 'Big Mix Queso 80gr', 7, 14.22) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'Pieza' (Factor: 1)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 1 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 1 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'Pieza', 1) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 16.35, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 16.35, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 5, cantidad_minima = 1 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 5, 1);
    END IF;

    -- Row 56: 7500533000568 (Bombones Members) - [Factor: 1]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '7500533000568';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('7500533000568', 'Bombones Members', 7, 41.77) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'Pieza' (Factor: 1)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 1 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 1 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'Pieza', 1) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 55, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 55, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 3, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 3, 0);
    END IF;

    -- Row 57: 758104001972 (Bonafont 2lt Con 12pz) - [Factor: 12]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '758104001972';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('758104001972', 'Bonafont 2lt Con 12pz', 1, 156) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'PAQUETE' (Factor: 12)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 12 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 12 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'PAQUETE', 12) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 175, precio_mayoreo = 160 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 175, 160);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 277, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 277, 0);
    END IF;

    -- Row 58: 758104005543 (Bonafont 355ml Con 24pz) - [Factor: 24]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '758104005543';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('758104005543', 'Bonafont 355ml Con 24pz', 1, 116.42) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'PAQUETE' (Factor: 24)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 24 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 24 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'PAQUETE', 24) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 130, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 130, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 0, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 0, 0);
    END IF;

    -- Row 59: 758104001712 (Bonafont 600ml 12pz) - [Factor: 12]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '758104001712';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('758104001712', 'Bonafont 600ml 12pz', 1, 73.5) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'PAQUETE' (Factor: 12)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 12 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 12 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'PAQUETE', 12) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 90, precio_mayoreo = 85 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 90, 85);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 18, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 18, 0);
    END IF;

    -- Row 60: 758104003174 (Bonafont 6lt 2pz) - [Factor: 2]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '758104003174';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('758104003174', 'Bonafont 6lt 2pz', 1, 60.45) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'PAQUETE' (Factor: 2)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 2 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 2 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'PAQUETE', 2) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 70, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 70, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 12, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 12, 0);
    END IF;

    -- Row 61: 758104006311 (Bonafont Levite Sabores 1lt Con 6pz) - [Factor: 6]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '758104006311';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('758104006311', 'Bonafont Levite Sabores 1lt Con 6pz', 1, 73) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'PAQUETE' (Factor: 6)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 6 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 6 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'PAQUETE', 6) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 90, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 90, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 0, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 0, 0);
    END IF;

    -- Row 62: 7506192510882 (Bonicessote 4pz De100g) - [Factor: 4]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '7506192510882';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('7506192510882', 'Bonicessote 4pz De100g', 2, 24.88) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'PAQUETE' (Factor: 4)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 4 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 4 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'PAQUETE', 4) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 30, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 30, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 137, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 137, 0);
    END IF;

    -- Row 63: 7506192510844 (Bonnieve 4pz De 100ml) - [Factor: 4]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '7506192510844';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('7506192510844', 'Bonnieve 4pz De 100ml', 2, 23.8) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'PAQUETE' (Factor: 4)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 4 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 4 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'PAQUETE', 4) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 28, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 28, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 0, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 0, 0);
    END IF;

    -- Row 64: 797038010445 (Bubli Bubli 170pz Surtido) - [Factor: 170]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '797038010445';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('797038010445', 'Bubli Bubli 170pz Surtido', 7, 100) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'PAQUETE' (Factor: 170)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 170 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 170 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'PAQUETE', 170) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 115, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 115, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 0, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 0, 0);
    END IF;

    -- Row 65: 7503004955428 (CAJA DE NARANYUSS 500ML 24PZ) - [Factor: 24]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '7503004955428';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('7503004955428', 'CAJA DE NARANYUSS 500ML 24PZ', 1, 138.76) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'PAQUETE' (Factor: 24)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 24 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 24 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'PAQUETE', 24) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 170, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 170, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 0, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 0, 0);
    END IF;

    -- Row 66: 7503004955466 (CHESCOSO 160ML 24 PZ) - [Factor: 24]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '7503004955466';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('7503004955466', 'CHESCOSO 160ML 24 PZ', 1, 46) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'PAQUETE' (Factor: 24)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 24 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 24 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'PAQUETE', 24) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 60, precio_mayoreo = 55 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 60, 55);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 26, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 26, 0);
    END IF;

    -- Row 67: 7503030199728 (CHICHARRON 100%DE CERDO 30GR) - [Factor: 1]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '7503030199728';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('7503030199728', 'CHICHARRON 100%DE CERDO 30GR', 7, 13.06) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'Pieza' (Factor: 1)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 1 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 1 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'Pieza', 1) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 15, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 15, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 1, cantidad_minima = 1 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 1, 1);
    END IF;

    -- Row 68: CIEL600 (CIEL 600ML 12 PZ) - [Factor: 12]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = 'CIEL600';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('CIEL600', 'CIEL 600ML 12 PZ', 1, 77.3) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'PAQUETE' (Factor: 12)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 12 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 12 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'PAQUETE', 12) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 95, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 95, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 17, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 17, 0);
    END IF;

    -- Row 69: CIEL1.5 (CIEL1.5LT 12 PZ) - [Factor: 12]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = 'CIEL1.5';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('CIEL1.5', 'CIEL1.5LT 12 PZ', 1, 127) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'PAQUETE' (Factor: 12)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 12 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 12 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'PAQUETE', 12) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 145, precio_mayoreo = 140 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 145, 140);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 6, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 6, 0);
    END IF;

    -- Row 70: 75056308 (CIGARRO BENSO CRISTAL VIOLET CAJ) - [Factor: 1]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '75056308';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('75056308', 'CIGARRO BENSO CRISTAL VIOLET CAJ', 11, 67.16) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'Pieza' (Factor: 1)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 1 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 1 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'Pieza', 1) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 75, precio_mayoreo = 69 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 75, 69);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 5, cantidad_minima = 10 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 5, 10);
    END IF;

    -- Row 71: 75016777 (CIGARRO BENSON MENTOLADO CAJ.) - [Factor: 1]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '75016777';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('75016777', 'CIGARRO BENSON MENTOLADO CAJ.', 11, 80.9) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'Pieza' (Factor: 1)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 1 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 1 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'Pieza', 1) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 90, precio_mayoreo = 85 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 90, 85);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 58, cantidad_minima = 20 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 58, 20);
    END IF;

    -- Row 72: 75001384 (CIGARRO MARLBORO ARCTIC  AZUL CAJ) - [Factor: 1]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '75001384';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('75001384', 'CIGARRO MARLBORO ARCTIC  AZUL CAJ', 11, 67.46) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'Pieza' (Factor: 1)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 1 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 1 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'Pieza', 1) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 75, precio_mayoreo = 70.5 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 75, 70.5);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 96, cantidad_minima = 20 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 96, 20);
    END IF;

    -- Row 73: 75035259 (CIGARRO MARLBORO BLANCO CAJ) - [Factor: 1]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '75035259';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('75035259', 'CIGARRO MARLBORO BLANCO CAJ', 11, 69.76) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'Pieza' (Factor: 1)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 1 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 1 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'Pieza', 1) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 80, precio_mayoreo = 78.5 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 80, 78.5);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 0, cantidad_minima = 10 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 0, 10);
    END IF;

    -- Row 74: 75074746 (CIGARRO MARLBORO CHICLE BLOSOON CAJ) - [Factor: 1]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '75074746';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('75074746', 'CIGARRO MARLBORO CHICLE BLOSOON CAJ', 11, 67.4) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'Pieza' (Factor: 1)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 1 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 1 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'Pieza', 1) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 75, precio_mayoreo = 70.5 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 75, 70.5);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 40, cantidad_minima = 10 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 40, 10);
    END IF;

    -- Row 75: 75068769 (CIGARRO MARLBORO DURAZNO DOUBLE FUSION VELVET CAJETILLA) - [Factor: 1]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '75068769';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('75068769', 'CIGARRO MARLBORO DURAZNO DOUBLE FUSION VELVET CAJETILLA', 11, 77.3) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'Pieza' (Factor: 1)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 1 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 1 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'Pieza', 1) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 85, precio_mayoreo = 80.5 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 85, 80.5);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 0, cantidad_minima = 20 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 0, 20);
    END IF;

    -- Row 76: 75001360 (CIGARRO MARLBORO PEPINO GARDEN FUSION CAJETILLA) - [Factor: 1]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '75001360';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('75001360', 'CIGARRO MARLBORO PEPINO GARDEN FUSION CAJETILLA', 11, 65) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'Pieza' (Factor: 1)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 1 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 1 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'Pieza', 1) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 75, precio_mayoreo = 70.5 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 75, 70.5);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 0, cantidad_minima = 20 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 0, 20);
    END IF;

    -- Row 77: 75001322 (CIGARRO MARLBORO ROJO CAJETILLA) - [Factor: 1]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '75001322';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('75001322', 'CIGARRO MARLBORO ROJO CAJETILLA', 11, 77.4) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'Pieza' (Factor: 1)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 1 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 1 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'Pieza', 1) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 85, precio_mayoreo = 80.5 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 85, 80.5);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 87, cantidad_minima = 20 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 87, 20);
    END IF;

    -- Row 78: 75021597 (CIGARRO MARLBORO ROJO CON CAPSULA CAJETILLA) - [Factor: 1]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '75021597';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('75021597', 'CIGARRO MARLBORO ROJO CON CAPSULA CAJETILLA', 11, 77.3) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'Pieza' (Factor: 1)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 1 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 1 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'Pieza', 1) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 85, precio_mayoreo = 80.5 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 85, 80.5);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 49, cantidad_minima = 20 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 49, 20);
    END IF;

    -- Row 79: 75068783 (CIGARRO MARLBORO RUBY DOUBLE FUSION CAJETILLA) - [Factor: 1]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '75068783';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('75068783', 'CIGARRO MARLBORO RUBY DOUBLE FUSION CAJETILLA', 11, 77.36) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'Pieza' (Factor: 1)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 1 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 1 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'Pieza', 1) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 85, precio_mayoreo = 80.5 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 85, 80.5);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 0, cantidad_minima = 20 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 0, 20);
    END IF;

    -- Row 80: 75066345 (CIGARRO MARLBORO SANDIA SUMMER FUSION CAJETILLA) - [Factor: 1]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '75066345';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('75066345', 'CIGARRO MARLBORO SANDIA SUMMER FUSION CAJETILLA', 11, 67.5) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'Pieza' (Factor: 1)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 1 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 1 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'Pieza', 1) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 75, precio_mayoreo = 70.5 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 75, 70.5);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 26, cantidad_minima = 20 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 26, 20);
    END IF;

    -- Row 81: 75074753 (CIGARRO MARLBORO WINTER SHUFFLE CAJ) - [Factor: 1]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '75074753';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('75074753', 'CIGARRO MARLBORO WINTER SHUFFLE CAJ', 11, 56.8) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'Pieza' (Factor: 1)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 1 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 1 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'Pieza', 1) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 65, precio_mayoreo = 62 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 65, 62);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 0, cantidad_minima = 10 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 0, 10);
    END IF;

    -- Row 82: 7501055306541 (COCA 2L 8PZ) - [Factor: 8]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '7501055306541';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('7501055306541', 'COCA 2L 8PZ', 1, 240) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'PAQUETE' (Factor: 8)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 8 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 8 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'PAQUETE', 8) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 280, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 280, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 0, cantidad_minima = 1 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 0, 1);
    END IF;

    -- Row 83: 7501055356188 (COCA CHOBY 355 12 PZ) - [Factor: 12]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '7501055356188';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('7501055356188', 'COCA CHOBY 355 12 PZ', 1, 124.14) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'PAQUETE' (Factor: 12)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 12 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 12 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'PAQUETE', 12) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 145, precio_mayoreo = 130 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 145, 130);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 3, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 3, 0);
    END IF;

    -- Row 84: 7501055349234 (COCA SIN AZUCAR 300ML CON 6PZ) - [Factor: 6]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '7501055349234';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('7501055349234', 'COCA SIN AZUCAR 300ML CON 6PZ', 1, 39.5) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'PAQUETE' (Factor: 6)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 6 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 6 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'PAQUETE', 6) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 45.5, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 45.5, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 5, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 5, 0);
    END IF;

    -- Row 85: CARIBEDMANDARINA (Caribe Cooler Mandarina 12pz 300ml) - [Factor: 12]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = 'CARIBEDMANDARINA';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('CARIBEDMANDARINA', 'Caribe Cooler Mandarina 12pz 300ml', 10, 218.03) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'PAQUETE' (Factor: 12)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 12 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 12 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'PAQUETE', 12) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 240, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 240, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 7, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 7, 0);
    END IF;

    -- Row 86: CARIBESURTIDA (Caribe Cooler Surtida 300ml Con 12pz) - [Factor: 12]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = 'CARIBESURTIDA';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('CARIBESURTIDA', 'Caribe Cooler Surtida 300ml Con 12pz', 10, 218.5) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'PAQUETE' (Factor: 12)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 12 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 12 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'PAQUETE', 12) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 240, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 240, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 256, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 256, 0);
    END IF;

    -- Row 87: CARIBETINTO (Caribe Cooler Tinto 12 Pz De 300ml) - [Factor: 12]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = 'CARIBETINTO';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('CARIBETINTO', 'Caribe Cooler Tinto 12 Pz De 300ml', 10, 218.5) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'PAQUETE' (Factor: 12)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 12 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 12 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'PAQUETE', 12) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 240, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 240, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 13, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 13, 0);
    END IF;

    -- Row 88: CARIBEFRESA (Caribe Fresa 300ml Con 12pz) - [Factor: 12]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = 'CARIBEFRESA';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('CARIBEFRESA', 'Caribe Fresa 300ml Con 12pz', 10, 218.03) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'PAQUETE' (Factor: 12)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 12 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 12 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'PAQUETE', 12) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 240, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 240, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 27, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 27, 0);
    END IF;

    -- Row 89: 17500326114226 (Chaparritas 250ml 24pz Sdo) - [Factor: 24]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '17500326114226';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('17500326114226', 'Chaparritas 250ml 24pz Sdo', 1, 168) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'PAQUETE' (Factor: 24)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 24 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 24 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'PAQUETE', 24) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 185, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 185, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 0, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 0, 0);
    END IF;

    -- Row 90: 18804022067 (Chicle Canels Vitrolero 300pz) - [Factor: 300]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '18804022067';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('18804022067', 'Chicle Canels Vitrolero 300pz', 1, 188.5) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'PAQUETE' (Factor: 300)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 300 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 300 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'PAQUETE', 300) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 215, precio_mayoreo = 220 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 215, 220);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 3, cantidad_minima = 1 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 3, 1);
    END IF;

    -- Row 91: 18804002410 (Chicles Canels) - [Factor: 1]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '18804002410';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('18804002410', 'Chicles Canels', 1, 79) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'Pieza' (Factor: 1)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 1 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 1 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'Pieza', 1) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 100, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 100, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 1, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 1, 0);
    END IF;

    -- Row 92: 7501056913595 (Chicles Clorets Pastilla) - [Factor: 1]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '7501056913595';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('7501056913595', 'Chicles Clorets Pastilla', 1, 43.98) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'Pieza' (Factor: 1)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 1 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 1 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'Pieza', 1) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 60, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 60, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 0, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 0, 0);
    END IF;

    -- Row 93: 24142006713 (Chicloso Vainilla) - [Factor: 1]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '24142006713';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('24142006713', 'Chicloso Vainilla', 1, 150.38) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'Pieza' (Factor: 1)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 1 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 1 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'Pieza', 1) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 165, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 165, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 0, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 0, 0);
    END IF;

    -- Row 94: 7500810027646 (Chipotles 65gr) - [Factor: 1]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '7500810027646';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('7500810027646', 'Chipotles 65gr', 7, 12.09) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'Pieza' (Factor: 1)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 1 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 1 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'Pieza', 1) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 14, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 14, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 0, cantidad_minima = 1 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 0, 1);
    END IF;

    -- Row 95: 7500810024560 (Chips Pqt Surrtido) - [Factor: 1]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '7500810024560';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('7500810024560', 'Chips Pqt Surrtido', 1, 15.12) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'Pieza' (Factor: 1)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 1 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 1 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'Pieza', 1) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 17, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 17, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 64, cantidad_minima = 1 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 64, 1);
    END IF;

    -- Row 96: 7501020556964 (Chocolate Yomy) - [Factor: 1]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '7501020556964';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('7501020556964', 'Chocolate Yomy', 1, 6.25) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'Pieza' (Factor: 1)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 1 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 1 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'Pieza', 1) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 7.22, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 7.22, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 0, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 0, 0);
    END IF;

    -- Row 97: 7501055308248 (Ciel Agua Mineral 600ml 12 Pz) - [Factor: 12]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '7501055308248';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('7501055308248', 'Ciel Agua Mineral 600ml 12 Pz', 1, 136) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'PAQUETE' (Factor: 12)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 12 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 12 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'PAQUETE', 12) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 160, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 160, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 0, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 0, 0);
    END IF;

    -- Row 98: 7501055310883 (Ciel De 1L CON 12 Pz) - [Factor: 12]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '7501055310883';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('7501055310883', 'Ciel De 1L CON 12 Pz', 1, 80) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'PAQUETE' (Factor: 12)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 12 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 12 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'PAQUETE', 12) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 100, precio_mayoreo = 110 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 100, 110);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 82, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 82, 0);
    END IF;

    -- Row 99: 7501055352531 (Ciel Jamaica Ilt Con 6pz) - [Factor: 6]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '7501055352531';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('7501055352531', 'Ciel Jamaica Ilt Con 6pz', 1, 72.24) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'PAQUETE' (Factor: 6)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 6 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 6 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'PAQUETE', 6) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 80, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 80, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 1, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 1, 0);
    END IF;

    -- Row 100: 7501055352463 (Ciel Limon 1 Lt 6pz) - [Factor: 6]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '7501055352463';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('7501055352463', 'Ciel Limon 1 Lt 6pz', 1, 73) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'PAQUETE' (Factor: 6)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 6 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 6 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'PAQUETE', 6) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 85, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 85, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 1, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 1, 0);
    END IF;

    -- Row 101: 7501055305742 (Ciel Mineralizada 2 Lt 4pz) - [Factor: 4]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '7501055305742';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('7501055305742', 'Ciel Mineralizada 2 Lt 4pz', 1, 71) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'PAQUETE' (Factor: 4)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 4 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 4 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'PAQUETE', 4) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 85, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 85, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 0, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 0, 0);
    END IF;

    -- Row 102: 75068776 (Cigarro Benso Dorado) - [Factor: 1]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '75068776';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('75068776', 'Cigarro Benso Dorado', 11, 65) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'Pieza' (Factor: 1)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 1 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 1 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'Pieza', 1) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 75, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 75, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 4, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 4, 0);
    END IF;

    -- Row 103: 75044916 (Cigarro Malboro Clavo) - [Factor: 1]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '75044916';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('75044916', 'Cigarro Malboro Clavo', 11, 80.9) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'Pieza' (Factor: 1)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 1 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 1 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'Pieza', 1) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 90, precio_mayoreo = 85 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 90, 85);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 9, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 9, 0);
    END IF;

    -- Row 104: 75019006 (Cigarro Marlboro Caribbean Guayaba) - [Factor: 1]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '75019006';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('75019006', 'Cigarro Marlboro Caribbean Guayaba', 11, 65) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'Pieza' (Factor: 1)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 1 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 1 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'Pieza', 1) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 75, precio_mayoreo = 70.5 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 75, 70.5);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 6, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 6, 0);
    END IF;

    -- Row 105: 75063801 (Cigarro Marlboro Ice Mix Azul Caj.) - [Factor: 1]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '75063801';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('75063801', 'Cigarro Marlboro Ice Mix Azul Caj.', 11, 54) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'Pieza' (Factor: 1)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 1 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 1 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'Pieza', 1) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 65, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 65, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 0, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 0, 0);
    END IF;

    -- Row 106: 75074920 (Cigarro Pall Iceberg) - [Factor: 1]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '75074920';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('75074920', 'Cigarro Pall Iceberg', 11, 50) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'Pieza' (Factor: 1)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 1 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 1 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'Pieza', 1) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 55, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 55, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 0, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 0, 0);
    END IF;

    -- Row 107: 75076429 (Cigarro Pall MALL HAWAII) - [Factor: 1]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '75076429';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('75076429', 'Cigarro Pall MALL HAWAII', 11, 73.27) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'Pieza' (Factor: 1)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 1 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 1 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'Pieza', 1) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 80, precio_mayoreo = 76 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 80, 76);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 5, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 5, 0);
    END IF;

    -- Row 108: 75071295 (Cigarro Pall Mall Alaska) - [Factor: 1]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '75071295';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('75071295', 'Cigarro Pall Mall Alaska', 11, 73.27) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'Pieza' (Factor: 1)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 1 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 1 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'Pieza', 1) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 78, precio_mayoreo = 75 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 78, 75);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 0, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 0, 0);
    END IF;

    -- Row 109: 75080495 (Cigarro Pall Mall Iceland) - [Factor: 1]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '75080495';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('75080495', 'Cigarro Pall Mall Iceland', 11, 60) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'Pieza' (Factor: 1)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 1 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 1 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'Pieza', 1) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 72, precio_mayoreo = 70 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 72, 70);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 1, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 1, 0);
    END IF;

    -- Row 110: 75076412 (Cigarro Pall Mall London) - [Factor: 1]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '75076412';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('75076412', 'Cigarro Pall Mall London', 11, 69.29) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'Pieza' (Factor: 1)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 1 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 1 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'Pieza', 1) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 80, precio_mayoreo = 76 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 80, 76);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 2, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 2, 0);
    END IF;

    -- Row 111: 75064648 (Cigarro Pall Mall Mykonos) - [Factor: 1]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '75064648';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('75064648', 'Cigarro Pall Mall Mykonos', 11, 73.27) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'Pieza' (Factor: 1)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 1 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 1 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'Pieza', 1) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 80, precio_mayoreo = 76 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 80, 76);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 8, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 8, 0);
    END IF;

    -- Row 112: 75052836 (Cigarro Pall Mall Tokyo) - [Factor: 1]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '75052836';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('75052836', 'Cigarro Pall Mall Tokyo', 11, 73.27) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'Pieza' (Factor: 1)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 1 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 1 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'Pieza', 1) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 80, precio_mayoreo = 76 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 80, 76);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 0, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 0, 0);
    END IF;

    -- Row 113: 14800515329 (Clamato 473Ml) - [Factor: 1]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '14800515329';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('14800515329', 'Clamato 473Ml', 1, 265) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'Pieza' (Factor: 1)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 1 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 1 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'Pieza', 1) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 280, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 280, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 0, cantidad_minima = 1 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 0, 1);
    END IF;

    -- Row 114: 7501055371655 (Coca 1.35ml Con 12pz) - [Factor: 12]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '7501055371655';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('7501055371655', 'Coca 1.35ml Con 12pz', 1, 327) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'PAQUETE' (Factor: 12)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 12 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 12 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'PAQUETE', 12) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 375, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 375, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 17, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 17, 0);
    END IF;

    -- Row 115: 7501055313532 (Coca 1.75ml) - [Factor: 1]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '7501055313532';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('7501055313532', 'Coca 1.75ml', 1, 252.83) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'Pieza' (Factor: 1)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 1 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 1 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'Pieza', 1) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 285, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 285, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 0, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 0, 0);
    END IF;

    -- Row 116: 7501055302451 (Coca 1lt Con 12pz) - [Factor: 12]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '7501055302451';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('7501055302451', 'Coca 1lt Con 12pz', 1, 276) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'PAQUETE' (Factor: 12)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 12 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 12 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'PAQUETE', 12) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 290, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 290, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 6, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 6, 0);
    END IF;

    -- Row 117: 7501055304004 (Coca 2.25ml Con 8pz) - [Factor: 8]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '7501055304004';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('7501055304004', 'Coca 2.25ml Con 8pz', 1, 285.26) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'PAQUETE' (Factor: 8)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 8 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 8 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'PAQUETE', 8) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 330, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 330, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 13, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 13, 0);
    END IF;

    -- Row 118: 7501055310227 (Coca 2.5 Retornable Con 8pz) - [Factor: 8]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '7501055310227';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('7501055310227', 'Coca 2.5 Retornable Con 8pz', 1, 243) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'PAQUETE' (Factor: 8)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 8 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 8 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'PAQUETE', 8) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 265, precio_mayoreo = 245 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 265, 245);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 42, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 42, 0);
    END IF;

    -- Row 119: 7501055335060 (Coca 2.75ml Con 8 Pz) - [Factor: 8]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '7501055335060';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('7501055335060', 'Coca 2.75ml Con 8 Pz', 1, 331.56) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'PAQUETE' (Factor: 8)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 8 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 8 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'PAQUETE', 8) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 342, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 342, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 0, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 0, 0);
    END IF;

    -- Row 120: 75034917 (Coca 200ml Con 24) - [Factor: 24]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '75034917';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('75034917', 'Coca 200ml Con 24', 1, 192) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'PAQUETE' (Factor: 24)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 24 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 24 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'PAQUETE', 24) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 210, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 210, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 0, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 0, 0);
    END IF;

    -- Row 121: 7501055355310 (Coca 250ml Con 12 Pz) - [Factor: 12]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '7501055355310';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('7501055355310', 'Coca 250ml Con 12 Pz', 1, 121.29) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'PAQUETE' (Factor: 12)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 12 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 12 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'PAQUETE', 12) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 140, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 140, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 0, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 0, 0);
    END IF;

    -- Row 122: 7501055313068 (Coca 3lt Retornable Con 6 pz) - [Factor: 6]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '7501055313068';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('7501055313068', 'Coca 3lt Retornable Con 6 pz', 1, 211.58) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'PAQUETE' (Factor: 6)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 6 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 6 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'PAQUETE', 6) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 225, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 225, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 10, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 10, 0);
    END IF;

    -- Row 123: 7501055328345 (Coca 400ml 12 Pz) - [Factor: 12]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '7501055328345';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('7501055328345', 'Coca 400ml 12 Pz', 1, 151.85) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'PAQUETE' (Factor: 12)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 12 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 12 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'PAQUETE', 12) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 175, precio_mayoreo = 170 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 175, 170);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 9, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 9, 0);
    END IF;

    -- Row 124: 7501055354917 (Coca 8 Onzas Con 24pz Desch.) - [Factor: 24]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '7501055354917';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('7501055354917', 'Coca 8 Onzas Con 24pz Desch.', 1, 323.75) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'PAQUETE' (Factor: 24)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 24 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 24 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'PAQUETE', 24) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 340, precio_mayoreo = 325 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 340, 325);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 0, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 0, 0);
    END IF;

    -- Row 125: 7501055356256 (Coca Choby Sin Azucar 355ml) - [Factor: 1]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '7501055356256';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('7501055356256', 'Coca Choby Sin Azucar 355ml', 1, 42.4) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'Pieza' (Factor: 1)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 1 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 1 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'Pieza', 1) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 60, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 60, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 12, cantidad_minima = 1 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 12, 1);
    END IF;

    -- Row 126: 7501055361557 (Coca Cola Lata Sin Azucar 355ml) - [Factor: 1]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '7501055361557';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('7501055361557', 'Coca Cola Lata Sin Azucar 355ml', 1, 202) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'Pieza' (Factor: 1)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 1 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 1 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'Pieza', 1) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 210, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 210, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 4, cantidad_minima = 1 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 4, 1);
    END IF;

    -- Row 127: 7501055361540 (Coca Lata Con 12pz) - [Factor: 12]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '7501055361540';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('7501055361540', 'Coca Lata Con 12pz', 1, 185) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'PAQUETE' (Factor: 12)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 12 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 12 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'PAQUETE', 12) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 230, precio_mayoreo = 200 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 230, 200);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 216, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 216, 0);
    END IF;

    -- Row 128: 7501055305339 (Coca Light 600ml CON 12 PZ) - [Factor: 12]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '7501055305339';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('7501055305339', 'Coca Light 600ml CON 12 PZ', 1, 202.5) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'PAQUETE' (Factor: 12)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 12 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 12 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'PAQUETE', 12) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 230, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 230, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 3, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 3, 0);
    END IF;

    -- Row 129: 7501055365395 (Coca Light Lata Con 12 Pz) - [Factor: 12]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '7501055365395';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('7501055365395', 'Coca Light Lata Con 12 Pz', 1, 121) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'PAQUETE' (Factor: 12)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 12 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 12 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'PAQUETE', 12) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 180, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 180, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 3, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 3, 0);
    END IF;

    -- Row 130: 7501055300952 (Coca Litro Y Cuarto Vidrio Con 8pz) - [Factor: 8]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '7501055300952';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('7501055300952', 'Coca Litro Y Cuarto Vidrio Con 8pz', 1, 189.2) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'PAQUETE' (Factor: 8)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 8 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 8 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'PAQUETE', 8) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 215, precio_mayoreo = 200 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 215, 200);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 8, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 8, 0);
    END IF;

    -- Row 131: 75004699 (Coca Medio Litro Vidrio Con 24pz) - [Factor: 24]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '75004699';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('75004699', 'Coca Medio Litro Vidrio Con 24pz', 1, 309) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'PAQUETE' (Factor: 24)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 24 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 24 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'PAQUETE', 24) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 345, precio_mayoreo = 318 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 345, 318);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 66, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 66, 0);
    END IF;

    -- Row 132: 7501055349432 (Coca Mini Lata Con 24pz) - [Factor: 24]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '7501055349432';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('7501055349432', 'Coca Mini Lata Con 24pz', 1, 309) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'PAQUETE' (Factor: 24)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 24 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 24 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'PAQUETE', 24) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 340, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 340, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 0, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 0, 0);
    END IF;

    -- Row 133: 7501055359035 (Coca Minilata 235ml 8pz) - [Factor: 8]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '7501055359035';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('7501055359035', 'Coca Minilata 235ml 8pz', 1, 56) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'PAQUETE' (Factor: 8)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 8 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 8 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'PAQUETE', 8) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 120, precio_mayoreo = 75 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 120, 75);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 5, cantidad_minima = 1 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 5, 1);
    END IF;

    -- Row 134: 75005771 (Coca Optima Retornable Con 24pz) - [Factor: 24]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '75005771';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('75005771', 'Coca Optima Retornable Con 24pz', 1, 286) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'PAQUETE' (Factor: 24)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 24 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 24 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'PAQUETE', 24) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 310, precio_mayoreo = 315 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 310, 315);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 30, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 30, 0);
    END IF;

    -- Row 135: 7501055320639 (Coca Sin Azucar 600ml Con 12pz) - [Factor: 12]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '7501055320639';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('7501055320639', 'Coca Sin Azucar 600ml Con 12pz', 1, 171.9) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'PAQUETE' (Factor: 12)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 12 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 12 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'PAQUETE', 12) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 195, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 195, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 3, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 3, 0);
    END IF;

    -- Row 136: 7501064199271 (Corona 710ml Con 12 Pz) - [Factor: 12]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '7501064199271';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('7501064199271', 'Corona 710ml Con 12 Pz', 10, 406) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'PAQUETE' (Factor: 12)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 12 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 12 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'PAQUETE', 12) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 420, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 420, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 4, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 4, 0);
    END IF;

    -- Row 137: 7501064190711 (Corona Bote 355ml Con 24 Pz) - [Factor: 24]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '7501064190711';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('7501064190711', 'Corona Bote 355ml Con 24 Pz', 10, 370) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'PAQUETE' (Factor: 24)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 24 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 24 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'PAQUETE', 24) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 390, precio_mayoreo = 380 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 390, 380);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 10, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 10, 0);
    END IF;

    -- Row 138: 7503024460018 (Corona Cero Lata 355 Ml 24pz) - [Factor: 24]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '7503024460018';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('7503024460018', 'Corona Cero Lata 355 Ml 24pz', 10, 328) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'PAQUETE' (Factor: 24)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 24 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 24 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'PAQUETE', 24) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 360, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 360, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 2, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 2, 0);
    END IF;

    -- Row 139: 7501064103100 (Corona Cuarto Con 24pz) - [Factor: 24]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '7501064103100';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('7501064103100', 'Corona Cuarto Con 24pz', 10, 219.49) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'PAQUETE' (Factor: 24)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 24 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 24 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'PAQUETE', 24) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 235, precio_mayoreo = 220 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 235, 220);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 34, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 34, 0);
    END IF;

    -- Row 140: 7501064193859 (Corona Laton 473ml Con 24pz) - [Factor: 24]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '7501064193859';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('7501064193859', 'Corona Laton 473ml Con 24pz', 10, 455.37) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'PAQUETE' (Factor: 24)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 24 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 24 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'PAQUETE', 24) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 470, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 470, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 4, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 4, 0);
    END IF;

    -- Row 141: 7501064194214 (Corona Light Bote 355ml 24pz) - [Factor: 24]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '7501064194214';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('7501064194214', 'Corona Light Bote 355ml 24pz', 10, 346) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'PAQUETE' (Factor: 24)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 24 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 24 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'PAQUETE', 24) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 350, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 350, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 0, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 0, 0);
    END IF;

    -- Row 142: 7411204846203 (Cosecha Pura Lata 355ml 12pz) - [Factor: 12]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '7411204846203';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('7411204846203', 'Cosecha Pura Lata 355ml 12pz', 1, 130) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'PAQUETE' (Factor: 12)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 12 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 12 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'PAQUETE', 12) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 140, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 140, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 0, cantidad_minima = 1 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 0, 1);
    END IF;

    -- Row 143: DELAWERTVIDRIO (DELAWER VIDRIO REJA) - [Factor: 1]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = 'DELAWERTVIDRIO';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('DELAWERTVIDRIO', 'DELAWER VIDRIO REJA', 1, 196.35) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'Pieza' (Factor: 1)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 1 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 1 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'Pieza', 1) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 225, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 225, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 1, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 1, 0);
    END IF;

    -- Row 144: 17501026027533 (DETERGENTE BLANCA NIEVES 1 KILO 10 PZ) - [Factor: 10]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '17501026027533';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('17501026027533', 'DETERGENTE BLANCA NIEVES 1 KILO 10 PZ', 2, 270) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'PAQUETE' (Factor: 10)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 10 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 10 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'PAQUETE', 10) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 320, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 320, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 0, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 0, 0);
    END IF;

    -- Row 145: 17501026027557 (DETERGENTE BLANCA NIEVES 250GR 40 PZ) - [Factor: 40]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '17501026027557';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('17501026027557', 'DETERGENTE BLANCA NIEVES 250GR 40 PZ', 2, 309.69) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'PAQUETE' (Factor: 40)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 40 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 40 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'PAQUETE', 40) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 360, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 360, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 6, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 6, 0);
    END IF;

    -- Row 146: 17501026026543 (DETERGENTE FOCA 1K 10 PZ) - [Factor: 10]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '17501026026543';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('17501026026543', 'DETERGENTE FOCA 1K 10 PZ', 2, 270) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'PAQUETE' (Factor: 10)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 10 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 10 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'PAQUETE', 10) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 320, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 320, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 0, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 0, 0);
    END IF;

    -- Row 147: 17501026026574 (DETERGENTE FOCA 250GR 40 PZ) - [Factor: 40]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '17501026026574';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('17501026026574', 'DETERGENTE FOCA 250GR 40 PZ', 2, 323.6) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'PAQUETE' (Factor: 40)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 40 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 40 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'PAQUETE', 40) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 370, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 370, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 2, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 2, 0);
    END IF;

    -- Row 148: 17501026026567 (DETERGENTE FOCA 500G 20PZ) - [Factor: 20]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '17501026026567';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('17501026026567', 'DETERGENTE FOCA 500G 20PZ', 2, 323.5) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'PAQUETE' (Factor: 20)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 20 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 20 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'PAQUETE', 20) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 370, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 370, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 0, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 0, 0);
    END IF;

    -- Row 149: 17501026004602 (DETERGENTE ROMA 1 KILO CON 10 PZ) - [Factor: 10]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '17501026004602';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('17501026004602', 'DETERGENTE ROMA 1 KILO CON 10 PZ', 2, 252) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'PAQUETE' (Factor: 10)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 10 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 10 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'PAQUETE', 10) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 310, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 310, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 0, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 0, 0);
    END IF;

    -- Row 150: 17501026004626 (DETERGENTE ROMA 250G 40PZ) - [Factor: 40]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '17501026004626';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('17501026004626', 'DETERGENTE ROMA 250G 40PZ', 2, 318.76) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'PAQUETE' (Factor: 40)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 40 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 40 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'PAQUETE', 40) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 370, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 370, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 0, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 0, 0);
    END IF;

    -- Row 151: 17501026004619 (DETERGENTE ROMA 500GR 20 PZ) - [Factor: 20]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '17501026004619';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('17501026004619', 'DETERGENTE ROMA 500GR 20 PZ', 2, 317.58) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'PAQUETE' (Factor: 20)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 20 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 20 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'PAQUETE', 20) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 370, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 370, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 0, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 0, 0);
    END IF;

    -- Row 152: 7501198350418 (DR PEPPER 600ML 12PZ) - [Factor: 12]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '7501198350418';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('7501198350418', 'DR PEPPER 600ML 12PZ', 1, 138.5) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'PAQUETE' (Factor: 12)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 12 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 12 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'PAQUETE', 12) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 163, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 163, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 1, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 1, 0);
    END IF;

    -- Row 153: DELAWER (Delawer Punch 600ml 12pz) - [Factor: 12]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = 'DELAWER';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('DELAWER', 'Delawer Punch 600ml 12pz', 1, 170) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'PAQUETE' (Factor: 12)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 12 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 12 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'PAQUETE', 12) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 205, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 205, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 1, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 1, 0);
    END IF;

    -- Row 154: 7501055304691 (Delawere Puch 2lt Con8pz) - [Factor: 8]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '7501055304691';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('7501055304691', 'Delawere Puch 2lt Con8pz', 1, 166.6) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'PAQUETE' (Factor: 8)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 8 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 8 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'PAQUETE', 8) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 185, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 185, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 0, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 0, 0);
    END IF;

    -- Row 155: 17501026027540 (Detergente Blanca Nieves 500gr) - [Factor: 1]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '17501026027540';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('17501026027540', 'Detergente Blanca Nieves 500gr', 2, 350) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'Pieza' (Factor: 1)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 1 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 1 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'Pieza', 1) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 360, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 360, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 0, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 0, 0);
    END IF;

    -- Row 156: DOWNYSURTIDO (Downy Surtido 12pz) - [Factor: 12]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = 'DOWNYSURTIDO';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('DOWNYSURTIDO', 'Downy Surtido 12pz', 2, 259.2) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'PAQUETE' (Factor: 12)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 12 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 12 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'PAQUETE', 12) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 280, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 280, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 0, cantidad_minima = 1 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 0, 1);
    END IF;

    -- Row 157: 7501345700257 (Dragonsitos) - [Factor: 1]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '7501345700257';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('7501345700257', 'Dragonsitos', 7, 80.81) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'Pieza' (Factor: 1)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 1 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 1 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'Pieza', 1) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 95, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 95, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 0, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 0, 0);
    END IF;

    -- Row 158: 757528024024 (Duvalin 65pz) - [Factor: 65]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '757528024024';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('757528024024', 'Duvalin 65pz', 7, 83) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'PAQUETE' (Factor: 65)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 65 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 65 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'PAQUETE', 65) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 96, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 96, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 1, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 1, 0);
    END IF;

    -- Row 159: 7503034673965 (Duvaslin 65pz) - [Factor: 65]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '7503034673965';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('7503034673965', 'Duvaslin 65pz', 7, 82.86) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'PAQUETE' (Factor: 65)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 65 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 65 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'PAQUETE', 65) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 100, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 100, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 0, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 0, 0);
    END IF;

    -- Row 160: 18804059247 (El Piatero1.7kl) - [Factor: 1]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '18804059247';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('18804059247', 'El Piatero1.7kl', 7, 193.34) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'Pieza' (Factor: 1)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 1 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 1 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'Pieza', 1) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 210, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 210, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 1, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 1, 0);
    END IF;

    -- Row 161: 7501125104411 (Electrolit Coco) - [Factor: 1]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '7501125104411';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('7501125104411', 'Electrolit Coco', 14, 218) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'Pieza' (Factor: 1)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 1 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 1 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'Pieza', 1) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 235, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 235, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 26, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 26, 0);
    END IF;

    -- Row 162: 7501125104268 (Electrolit Fresa 625 Ml Con 12 Pz) - [Factor: 12]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '7501125104268';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('7501125104268', 'Electrolit Fresa 625 Ml Con 12 Pz', 14, 218) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'PAQUETE' (Factor: 12)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 12 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 12 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'PAQUETE', 12) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 235, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 235, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 9, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 9, 0);
    END IF;

    -- Row 163: 7501125149221 (Electrolit Fresa Kiwi) - [Factor: 1]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '7501125149221';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('7501125149221', 'Electrolit Fresa Kiwi', 14, 218) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'Pieza' (Factor: 1)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 1 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 1 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'Pieza', 1) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 235, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 235, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 20, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 20, 0);
    END IF;

    -- Row 164: 7501125187179 (Electrolit Guayaba 625 Ml 12 Pz) - [Factor: 12]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '7501125187179';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('7501125187179', 'Electrolit Guayaba 625 Ml 12 Pz', 14, 205) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'PAQUETE' (Factor: 12)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 12 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 12 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'PAQUETE', 12) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 235, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 235, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 0, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 0, 0);
    END IF;

    -- Row 165: 7501125118562 (Electrolit Lima Limon) - [Factor: 1]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '7501125118562';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('7501125118562', 'Electrolit Lima Limon', 14, 218) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'Pieza' (Factor: 1)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 1 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 1 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'Pieza', 1) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 235, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 235, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 16, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 16, 0);
    END IF;

    -- Row 166: 7501125104343 (Electrolit Manzana 625ML CON 12 PZ) - [Factor: 12]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '7501125104343';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('7501125104343', 'Electrolit Manzana 625ML CON 12 PZ', 14, 153) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'PAQUETE' (Factor: 12)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 12 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 12 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'PAQUETE', 12) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 235, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 235, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 10, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 10, 0);
    END IF;

    -- Row 167: 7501125174797 (Electrolit Mora 625ml Con 12 Pz) - [Factor: 12]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '7501125174797';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('7501125174797', 'Electrolit Mora 625ml Con 12 Pz', 14, 218) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'PAQUETE' (Factor: 12)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 12 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 12 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'PAQUETE', 12) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 235, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 235, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 34, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 34, 0);
    END IF;

    -- Row 168: 7501125104688 (Electrolit Naranja 625ml Con 12 Pz) - [Factor: 12]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '7501125104688';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('7501125104688', 'Electrolit Naranja 625ml Con 12 Pz', 14, 218) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'PAQUETE' (Factor: 12)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 12 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 12 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'PAQUETE', 12) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 235, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 235, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 19, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 19, 0);
    END IF;

    -- Row 169: 7501125103582 (Electrolit Pia 625ml Con 12 Pz) - [Factor: 12]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '7501125103582';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('7501125103582', 'Electrolit Pia 625ml Con 12 Pz', 14, 218) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'PAQUETE' (Factor: 12)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 12 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 12 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'PAQUETE', 12) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 235, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 235, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 0, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 0, 0);
    END IF;

    -- Row 170: ELECTROLIT1LT (Electrolit Sdo 1lt 6pz) - [Factor: 6]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = 'ELECTROLIT1LT';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('ELECTROLIT1LT', 'Electrolit Sdo 1lt 6pz', 14, 155) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'PAQUETE' (Factor: 6)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 6 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 6 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'PAQUETE', 6) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 170, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 170, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 21, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 21, 0);
    END IF;

    -- Row 171: 20230401202504010012 (Electrolit Surtido 625ml Con 12 Pz) - [Factor: 12]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '20230401202504010012';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('20230401202504010012', 'Electrolit Surtido 625ml Con 12 Pz', 14, 218) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'PAQUETE' (Factor: 12)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 12 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 12 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'PAQUETE', 12) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 235, precio_mayoreo = 230 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 235, 230);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 230, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 230, 0);
    END IF;

    -- Row 172: 7501125144851 (Electrolit Uva 625ml Con 12 Pz) - [Factor: 12]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '7501125144851';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('7501125144851', 'Electrolit Uva 625ml Con 12 Pz', 14, 218) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'PAQUETE' (Factor: 12)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 12 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 12 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'PAQUETE', 12) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 235, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 235, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 27, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 27, 0);
    END IF;

    -- Row 173: 7501125187131 (Electrolt 625ml Horchata 12 Pz) - [Factor: 12]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '7501125187131';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('7501125187131', 'Electrolt 625ml Horchata 12 Pz', 14, 218) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'PAQUETE' (Factor: 12)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 12 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 12 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'PAQUETE', 12) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 235, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 235, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 0, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 0, 0);
    END IF;

    -- Row 174: 70330617278 (Encendedor Bic Maxi 5pz) - [Factor: 5]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '70330617278';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('70330617278', 'Encendedor Bic Maxi 5pz', 11, 82) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'PAQUETE' (Factor: 5)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 5 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 5 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'PAQUETE', 5) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 95, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 95, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 3, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 3, 0);
    END IF;

    -- Row 175: 17501086106896 (Encendedor Tokai Transparente 25pz) - [Factor: 25]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '17501086106896';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('17501086106896', 'Encendedor Tokai Transparente 25pz', 2, 130) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'PAQUETE' (Factor: 25)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 25 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 25 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'PAQUETE', 25) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 140, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 140, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 1, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 1, 0);
    END IF;

    -- Row 176: 7501072910509 (FRIKO SDO CON 24PZ) - [Factor: 24]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '7501072910509';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('7501072910509', 'FRIKO SDO CON 24PZ', 1, 84) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'PAQUETE' (Factor: 24)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 24 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 24 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'PAQUETE', 24) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 95, precio_mayoreo = 90 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 95, 90);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 96, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 96, 0);
    END IF;

    -- Row 177: 7501055317875 (FUZETEA 600ML DURAZNO 6PZ) - [Factor: 6]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '7501055317875';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('7501055317875', 'FUZETEA 600ML DURAZNO 6PZ', 1, 85) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'PAQUETE' (Factor: 6)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 6 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 6 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'PAQUETE', 6) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 110, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 110, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 10, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 10, 0);
    END IF;

    -- Row 178: 7501055369621 (FUZETEA 600ML DURAZNO SIN AZUCAR 6PZ) - [Factor: 6]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '7501055369621';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('7501055369621', 'FUZETEA 600ML DURAZNO SIN AZUCAR 6PZ', 1, 84) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'PAQUETE' (Factor: 6)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 6 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 6 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'PAQUETE', 6) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 100, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 100, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 1, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 1, 0);
    END IF;

    -- Row 179: 7501055343690 (FUZETEA 600ML FRUTOS ROJOS 6PZ) - [Factor: 6]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '7501055343690';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('7501055343690', 'FUZETEA 600ML FRUTOS ROJOS 6PZ', 1, 84) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'PAQUETE' (Factor: 6)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 6 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 6 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'PAQUETE', 6) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 110, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 110, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 0, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 0, 0);
    END IF;

    -- Row 180: 7501055358892 (FUZETEA 600ML LIMON 6PZ) - [Factor: 6]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '7501055358892';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('7501055358892', 'FUZETEA 600ML LIMON 6PZ', 1, 84.63) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'PAQUETE' (Factor: 6)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 6 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 6 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'PAQUETE', 6) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 110, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 110, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 3, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 3, 0);
    END IF;

    -- Row 181: 7501055350650 (FUZETEA 600ML MANGO MANZANILLA 6PZ) - [Factor: 6]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '7501055350650';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('7501055350650', 'FUZETEA 600ML MANGO MANZANILLA 6PZ', 1, 84) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'PAQUETE' (Factor: 6)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 6 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 6 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'PAQUETE', 6) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 110, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 110, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 0, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 0, 0);
    END IF;

    -- Row 182: 7501055368594 (Fanta 2.5 Retonable Con 8pz) - [Factor: 8]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '7501055368594';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('7501055368594', 'Fanta 2.5 Retonable Con 8pz', 1, 150) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'PAQUETE' (Factor: 8)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 8 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 8 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'PAQUETE', 8) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 170, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 170, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 0, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 0, 0);
    END IF;

    -- Row 183: FANTAFRESA3LT (Fanta 3lt Con 8pz Fresa) - [Factor: 8]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = 'FANTAFRESA3LT';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('FANTAFRESA3LT', 'Fanta 3lt Con 8pz Fresa', 1, 242) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'PAQUETE' (Factor: 8)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 8 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 8 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'PAQUETE', 8) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 270, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 270, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 2, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 2, 0);
    END IF;

    -- Row 184: FANTA3LTPIA (Fanta 3lt Con 8pz Pia) - [Factor: 8]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = 'FANTA3LTPIA';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('FANTA3LTPIA', 'Fanta 3lt Con 8pz Pia', 1, 242) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'PAQUETE' (Factor: 8)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 8 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 8 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'PAQUETE', 8) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 270, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 270, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 2, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 2, 0);
    END IF;

    -- Row 185: FANTA3LTUVA (Fanta 3lt Con 8pz Uva) - [Factor: 8]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = 'FANTA3LTUVA';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('FANTA3LTUVA', 'Fanta 3lt Con 8pz Uva', 1, 242) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'PAQUETE' (Factor: 8)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 8 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 8 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'PAQUETE', 8) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 270, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 270, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 3, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 3, 0);
    END IF;

    -- Row 186: FANTA3LT4PZNRJ (Fanta 3lt Naranja 4pz) - [Factor: 4]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = 'FANTA3LT4PZNRJ';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('FANTA3LT4PZNRJ', 'Fanta 3lt Naranja 4pz', 1, 120) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'PAQUETE' (Factor: 4)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 4 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 4 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'PAQUETE', 4) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 125, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 125, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 2, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 2, 0);
    END IF;

    -- Row 187: 7622202231803 (Fiesta Mix) - [Factor: 1]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '7622202231803';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('7622202231803', 'Fiesta Mix', 7, 234) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'Pieza' (Factor: 1)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 1 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 1 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'Pieza', 1) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 250, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 250, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 0, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 0, 0);
    END IF;

    -- Row 188: 7501055381906 (Flashlyte 625ml Uva) - [Factor: 1]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '7501055381906';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('7501055381906', 'Flashlyte 625ml Uva', 14, 79) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'Pieza' (Factor: 1)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 1 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 1 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'Pieza', 1) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 85, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 85, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 2, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 2, 0);
    END IF;

    -- Row 189: 7501020556971 (Fresa Yomi) - [Factor: 1]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '7501020556971';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('7501020556971', 'Fresa Yomi', 9, 6.25) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'Pieza' (Factor: 1)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 1 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 1 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'Pieza', 1) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 7.22, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 7.22, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 0, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 0, 0);
    END IF;

    -- Row 190: FRESCA 600ML CON 12P (Fresca 600ml Con 12pz) - [Factor: 12]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = 'FRESCA 600ML CON 12P';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('FRESCA 600ML CON 12P', 'Fresca 600ml Con 12pz', 1, 149) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'PAQUETE' (Factor: 12)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 12 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 12 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'PAQUETE', 12) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 205, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 205, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 12, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 12, 0);
    END IF;

    -- Row 191: 7501055379941 (Fresca Fusion 2lt 8pz) - [Factor: 8]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '7501055379941';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('7501055379941', 'Fresca Fusion 2lt 8pz', 1, 178.36) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'PAQUETE' (Factor: 8)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 8 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 8 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'PAQUETE', 8) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 185, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 185, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 25, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 25, 0);
    END IF;

    -- Row 192: 7501055379910 (Fresca Fusion Mini Lata 12pz) - [Factor: 12]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '7501055379910';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('7501055379910', 'Fresca Fusion Mini Lata 12pz', 1, 44) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'PAQUETE' (Factor: 12)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 12 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 12 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'PAQUETE', 12) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 60, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 60, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 0, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 0, 0);
    END IF;

    -- Row 193: 75001964 (Frutsi Manzana 6pz) - [Factor: 6]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '75001964';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('75001964', 'Frutsi Manzana 6pz', 1, 22) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'PAQUETE' (Factor: 6)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 6 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 6 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'PAQUETE', 6) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 22.5, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 22.5, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 0, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 0, 0);
    END IF;

    -- Row 194: 10032239062013 (Frutsi Sdo Con 24) - [Factor: 24]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '10032239062013';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('10032239062013', 'Frutsi Sdo Con 24', 1, 79) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'PAQUETE' (Factor: 24)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 24 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 24 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'PAQUETE', 24) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 90, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 90, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 0, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 0, 0);
    END IF;

    -- Row 195: 75001988 (Frutsy Fresa 6pz) - [Factor: 6]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '75001988';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('75001988', 'Frutsy Fresa 6pz', 1, 26.35) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'PAQUETE' (Factor: 6)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 6 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 6 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'PAQUETE', 6) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 30, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 30, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 0, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 0, 0);
    END IF;

    -- Row 196: 75001957 (Frutsy Uva 6pz) - [Factor: 6]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '75001957';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('75001957', 'Frutsy Uva 6pz', 1, 26.35) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'PAQUETE' (Factor: 6)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 6 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 6 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'PAQUETE', 6) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 30, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 30, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 0, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 0, 0);
    END IF;

    -- Row 197: 7502254751231 (Fruty Queko 1l 12pz) - [Factor: 12]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '7502254751231';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('7502254751231', 'Fruty Queko 1l 12pz', 1, 125.45) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'PAQUETE' (Factor: 12)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 12 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 12 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'PAQUETE', 12) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 145, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 145, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 5, cantidad_minima = 1 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 5, 1);
    END IF;

    -- Row 198: 503012313012 (Fruty Queko 473ml) - [Factor: 1]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '503012313012';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('503012313012', 'Fruty Queko 473ml', 1, 86.36) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'Pieza' (Factor: 1)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 1 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 1 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'Pieza', 1) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 105, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 105, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 12, cantidad_minima = 1 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 12, 1);
    END IF;

    -- Row 199: 7502254750036 (Fruty Queko Chupon 330ml 12pz) - [Factor: 12]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '7502254750036';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('7502254750036', 'Fruty Queko Chupon 330ml 12pz', 1, 82.72) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'PAQUETE' (Factor: 12)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 12 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 12 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'PAQUETE', 12) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 100, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 100, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 34, cantidad_minima = 1 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 34, 1);
    END IF;

    -- Row 200: 7501055358885 (Fuze Tea Te Negro 6pz 600ml) - [Factor: 6]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '7501055358885';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('7501055358885', 'Fuze Tea Te Negro 6pz 600ml', 1, 85) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'PAQUETE' (Factor: 6)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 6 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 6 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'PAQUETE', 6) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 110, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 110, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 6, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 6, 0);
    END IF;

    -- Row 201: 7501055374427 (Fuzetea 2lt Te Negra 4pz) - [Factor: 4]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '7501055374427';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('7501055374427', 'Fuzetea 2lt Te Negra 4pz', 1, 70) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'PAQUETE' (Factor: 4)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 4 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 4 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'PAQUETE', 4) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 80, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 80, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 0, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 0, 0);
    END IF;

    -- Row 202: 7501055383757 (Fuzetea 600ml 6pz) - [Factor: 6]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '7501055383757';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('7501055383757', 'Fuzetea 600ml 6pz', 1, 73) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'PAQUETE' (Factor: 6)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 6 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 6 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'PAQUETE', 6) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 110, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 110, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 0, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 0, 0);
    END IF;

    -- Row 203: 7501022014141 (GATORADE SDO 1LT CON 12PZ) - [Factor: 12]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '7501022014141';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('7501022014141', 'GATORADE SDO 1LT CON 12PZ', 14, 254.93) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'PAQUETE' (Factor: 12)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 12 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 12 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'PAQUETE', 12) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 290, precio_mayoreo = 280 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 290, 280);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 52, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 52, 0);
    END IF;

    -- Row 204: 17500478039132 (Galleta Maria Gamesa 22rollo) - [Factor: 1]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '17500478039132';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('17500478039132', 'Galleta Maria Gamesa 22rollo', 2, 229) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'Pieza' (Factor: 1)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 1 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 1 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'Pieza', 1) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 255, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 255, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 28, cantidad_minima = 5 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 28, 5);
    END IF;

    -- Row 205: 7501022009536 (Gatorade 350ml Surtido Con 24pz) - [Factor: 24]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '7501022009536';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('7501022009536', 'Gatorade 350ml Surtido Con 24pz', 14, 225.37) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'PAQUETE' (Factor: 24)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 24 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 24 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'PAQUETE', 24) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 260, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 260, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 0, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 0, 0);
    END IF;

    -- Row 206: 7501022015223 (Gatorade 600ml Surtido Con 24 Pz) - [Factor: 24]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '7501022015223';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('7501022015223', 'Gatorade 600ml Surtido Con 24 Pz', 14, 342.41) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'PAQUETE' (Factor: 24)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 24 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 24 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'PAQUETE', 24) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 395, precio_mayoreo = 385 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 395, 385);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 0, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 0, 0);
    END IF;

    -- Row 207: 36731137913 (Gatorade 750ml Mora Con 20pz) - [Factor: 20]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '36731137913';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('36731137913', 'Gatorade 750ml Mora Con 20pz', 14, 270) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'PAQUETE' (Factor: 20)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 20 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 20 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'PAQUETE', 20) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 320, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 320, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 0, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 0, 0);
    END IF;

    -- Row 208: 7501072936271 (Gugar 3.1ml Con 6pz Surtido) - [Factor: 6]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '7501072936271';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('7501072936271', 'Gugar 3.1ml Con 6pz Surtido', 1, 127) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'PAQUETE' (Factor: 6)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 6 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 6 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'PAQUETE', 6) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 140, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 140, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 14, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 14, 0);
    END IF;

    -- Row 209: 7501072936691 (Gugar 500ml Surtido Con 24pz) - [Factor: 24]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '7501072936691';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('7501072936691', 'Gugar 500ml Surtido Con 24pz', 1, 148.27) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'PAQUETE' (Factor: 24)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 24 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 24 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'PAQUETE', 24) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 170, precio_mayoreo = 165 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 170, 165);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 8, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 8, 0);
    END IF;

    -- Row 210: 7622210457462 (Halls Sdo 12 Pz) - [Factor: 12]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '7622210457462';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('7622210457462', 'Halls Sdo 12 Pz', 7, 70.8) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'PAQUETE' (Factor: 12)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 12 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 12 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'PAQUETE', 12) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 80, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 80, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 5, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 5, 0);
    END IF;

    -- Row 211: 99072000674 (Higienico Premier  12pz) - [Factor: 12]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '99072000674';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('99072000674', 'Higienico Premier  12pz', 2, 280) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'PAQUETE' (Factor: 12)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 12 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 12 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'PAQUETE', 12) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 300, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 300, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 0, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 0, 0);
    END IF;

    -- Row 212: 7503037475214 (Huevito Gomitas Sabor Durazno) - [Factor: 1]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '7503037475214';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('7503037475214', 'Huevito Gomitas Sabor Durazno', 7, 56) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'Pieza' (Factor: 1)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 1 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 1 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'Pieza', 1) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 70, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 70, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 8, cantidad_minima = 1 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 8, 1);
    END IF;

    -- Row 213: 7501055381470 (JACK DANIELS 350ML CON 6PZ) - [Factor: 6]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '7501055381470';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('7501055381470', 'JACK DANIELS 350ML CON 6PZ', 10, 135) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'PAQUETE' (Factor: 6)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 6 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 6 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'PAQUETE', 6) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 145, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 145, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 0, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 0, 0);
    END IF;

    -- Row 214: JARRITOS600ML (JARRITO 600ML 24PZ SURTD) - [Factor: 24]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = 'JARRITOS600ML';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('JARRITOS600ML', 'JARRITO 600ML 24PZ SURTD', 1, 236) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'PAQUETE' (Factor: 24)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 24 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 24 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'PAQUETE', 24) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 290, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 290, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 0, cantidad_minima = 1 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 0, 1);
    END IF;

    -- Row 215: 17501013102786 (JUEMX MANGO 1LT 12 PZ) - [Factor: 12]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '17501013102786';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('17501013102786', 'JUEMX MANGO 1LT 12 PZ', 1, 230.22) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'PAQUETE' (Factor: 12)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 12 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 12 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'PAQUETE', 12) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 250, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 250, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 5, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 5, 0);
    END IF;

    -- Row 216: 7501005102735 (JUGO ADES 946 SOYA 3PZ) - [Factor: 3]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '7501005102735';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('7501005102735', 'JUGO ADES 946 SOYA 3PZ', 1, 65.88) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'PAQUETE' (Factor: 3)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 3 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 3 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'PAQUETE', 3) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 70.59, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 70.59, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 0, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 0, 0);
    END IF;

    -- Row 217: BOING LATA 355ML (JUGO BOING LATA 24PZ) - [Factor: 24]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = 'BOING LATA 355ML';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('BOING LATA 355ML', 'JUGO BOING LATA 24PZ', 1, 265) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'PAQUETE' (Factor: 24)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 24 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 24 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'PAQUETE', 24) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 280, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 280, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 27, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 27, 0);
    END IF;

    -- Row 218: 7501055335978 (JUGO DEL VALLE DURAZNO CAJITA 4PZ 250ML) - [Factor: 4]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '7501055335978';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('7501055335978', 'JUGO DEL VALLE DURAZNO CAJITA 4PZ 250ML', 1, 57.38) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'PAQUETE' (Factor: 4)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 4 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 4 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'PAQUETE', 4) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 67, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 67, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 0, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 0, 0);
    END IF;

    -- Row 219: 17501013104063 (JUMEX DURAZNO 1LT 12PZ) - [Factor: 12]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '17501013104063';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('17501013104063', 'JUMEX DURAZNO 1LT 12PZ', 1, 230.22) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'PAQUETE' (Factor: 12)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 12 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 12 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'PAQUETE', 12) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 250, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 250, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 0, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 0, 0);
    END IF;

    -- Row 220: 7501013103939 (JUMEX LATA SDO 355ML CON 24 PZ) - [Factor: 24]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '7501013103939';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('7501013103939', 'JUMEX LATA SDO 355ML CON 24 PZ', 1, 241.77) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'PAQUETE' (Factor: 24)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 24 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 24 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'PAQUETE', 24) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 275, precio_mayoreo = 250 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 275, 250);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 66, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 66, 0);
    END IF;

    -- Row 221: 7501013102789 (JUMEX MANGO 1LT 12 PZ) - [Factor: 12]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '7501013102789';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('7501013102789', 'JUMEX MANGO 1LT 12 PZ', 1, 230) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'PAQUETE' (Factor: 12)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 12 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 12 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'PAQUETE', 12) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 250, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 250, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 0, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 0, 0);
    END IF;

    -- Row 222: 17501013104070 (JUMEX MANZANA 1LT 12PZ) - [Factor: 12]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '17501013104070';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('17501013104070', 'JUMEX MANZANA 1LT 12PZ', 1, 230.22) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'PAQUETE' (Factor: 12)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 12 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 12 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'PAQUETE', 12) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 250, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 250, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 0, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 0, 0);
    END IF;

    -- Row 223: 7501013105469 (JUMEX NARANJA 1LT 12PZ) - [Factor: 12]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '7501013105469';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('7501013105469', 'JUMEX NARANJA 1LT 12PZ', 1, 230.22) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'PAQUETE' (Factor: 12)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 12 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 12 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'PAQUETE', 12) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 250, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 250, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 7, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 7, 0);
    END IF;

    -- Row 224: 27501013109683 (JUMEX PIA 1LT 12PZ) - [Factor: 12]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '27501013109683';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('27501013109683', 'JUMEX PIA 1LT 12PZ', 1, 230.22) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'PAQUETE' (Factor: 12)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 12 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 12 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'PAQUETE', 12) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 250, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 250, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 7, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 7, 0);
    END IF;

    -- Row 225: JUMEXMANGO475ML (JUMEX TAPARROSCA SURT 475ML 12PZ) - [Factor: 12]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = 'JUMEXMANGO475ML';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('JUMEXMANGO475ML', 'JUMEX TAPARROSCA SURT 475ML 12PZ', 1, 178) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'PAQUETE' (Factor: 12)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 12 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 12 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'PAQUETE', 12) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 195, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 195, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 32, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 32, 0);
    END IF;

    -- Row 226: 17501013105503 (JUMEX UVA 1LT 12PZ) - [Factor: 12]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '17501013105503';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('17501013105503', 'JUMEX UVA 1LT 12PZ', 1, 230.22) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'PAQUETE' (Factor: 12)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 12 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 12 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'PAQUETE', 12) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 250, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 250, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 2, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 2, 0);
    END IF;

    -- Row 227: 17501026005371 (Jabon Zote Blanca 400gr 25 Pz) - [Factor: 25]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '17501026005371';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('17501026005371', 'Jabon Zote Blanca 400gr 25 Pz', 2, 337.5) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'PAQUETE' (Factor: 25)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 25 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 25 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'PAQUETE', 25) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 460, precio_mayoreo = 400 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 460, 400);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 1, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 1, 0);
    END IF;

    -- Row 228: 17501026005678 (Jabon Zote Rosa 400gr 25pz) - [Factor: 25]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '17501026005678';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('17501026005678', 'Jabon Zote Rosa 400gr 25pz', 2, 480) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'PAQUETE' (Factor: 25)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 25 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 25 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'PAQUETE', 25) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 500, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 500, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 0, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 0, 0);
    END IF;

    -- Row 229: 7501441843991 (Jarrit Lata 355ml 24pz) - [Factor: 24]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '7501441843991';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('7501441843991', 'Jarrit Lata 355ml 24pz', 1, 243.51) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'PAQUETE' (Factor: 24)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 24 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 24 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'PAQUETE', 24) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 260, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 260, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 1, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 1, 0);
    END IF;

    -- Row 230: 7501441604916 (Jarrito 2lt 8pz Fresa) - [Factor: 8]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '7501441604916';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('7501441604916', 'Jarrito 2lt 8pz Fresa', 1, 150) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'PAQUETE' (Factor: 8)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 8 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 8 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'PAQUETE', 8) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 155, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 155, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 0, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 0, 0);
    END IF;

    -- Row 231: JARRITO2LTSDO (Jarrito 2lt Surtido Tamarindo 2lt 8pz) - [Factor: 8]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = 'JARRITO2LTSDO';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('JARRITO2LTSDO', 'Jarrito 2lt Surtido Tamarindo 2lt 8pz', 1, 152) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'PAQUETE' (Factor: 8)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 8 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 8 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'PAQUETE', 8) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 195, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 195, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 14, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 14, 0);
    END IF;

    -- Row 232: JARRITOSURTIDO3LT (Jarrito 3lt Surtido  Con 8pz) - [Factor: 8]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = 'JARRITOSURTIDO3LT';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('JARRITOSURTIDO3LT', 'Jarrito 3lt Surtido  Con 8pz', 1, 220.5) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'PAQUETE' (Factor: 8)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 8 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 8 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'PAQUETE', 8) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 280, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 280, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 30, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 30, 0);
    END IF;

    -- Row 233: JARRITO400SABOR (Jarrito 400ml 12pz Surtido) - [Factor: 12]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = 'JARRITO400SABOR';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('JARRITO400SABOR', 'Jarrito 400ml 12pz Surtido', 1, 105) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'PAQUETE' (Factor: 12)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 12 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 12 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'PAQUETE', 12) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 120, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 120, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 0, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 0, 0);
    END IF;

    -- Row 234: 7501441604411 (Jarritos Frutti 2L) - [Factor: 1]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '7501441604411';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('7501441604411', 'Jarritos Frutti 2L', 1, 157) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'Pieza' (Factor: 1)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 1 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 1 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'Pieza', 1) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 170, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 170, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 2, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 2, 0);
    END IF;

    -- Row 235: 7501005113373 (Jugo Ades 200ml  Durazno 4pz) - [Factor: 4]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '7501005113373';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('7501005113373', 'Jugo Ades 200ml  Durazno 4pz', 1, 34) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'PAQUETE' (Factor: 4)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 4 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 4 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'PAQUETE', 4) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 40, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 40, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 1, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 1, 0);
    END IF;

    -- Row 236: 7501005114509 (Jugo Ades 200ml Manzana) - [Factor: 1]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '7501005114509';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('7501005114509', 'Jugo Ades 200ml Manzana', 1, 34) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'Pieza' (Factor: 1)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 1 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 1 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'Pieza', 1) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 40, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 40, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 0, cantidad_minima = 5 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 0, 5);
    END IF;

    -- Row 237: 7501005102681 (Jugo Ades 946 Ml Mango 3PZ) - [Factor: 3]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '7501005102681';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('7501005102681', 'Jugo Ades 946 Ml Mango 3PZ', 1, 65.88) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'PAQUETE' (Factor: 3)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 3 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 3 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'PAQUETE', 3) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 75, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 75, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 0, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 0, 0);
    END IF;

    -- Row 238: 7501005114523 (Jugo Ades De Mango200ML) - [Factor: 1]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '7501005114523';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('7501005114523', 'Jugo Ades De Mango200ML', 1, 15) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'Pieza' (Factor: 1)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 1 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 1 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'Pieza', 1) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 20, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 20, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 0, cantidad_minima = 5 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 0, 5);
    END IF;

    -- Row 239: 7501005102674 (Jugo Ades Manzana 946 Ml 3PZ) - [Factor: 3]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '7501005102674';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('7501005102674', 'Jugo Ades Manzana 946 Ml 3PZ', 1, 65.88) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'PAQUETE' (Factor: 3)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 3 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 3 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'PAQUETE', 3) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 75, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 75, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 1, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 1, 0);
    END IF;

    -- Row 240: 9 (Jugo Bida 500ml 12 Pz Sdo) - [Factor: 12]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '9';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('9', 'Jugo Bida 500ml 12 Pz Sdo', 1, 100) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'PAQUETE' (Factor: 12)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 12 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 12 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'PAQUETE', 12) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 126, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 126, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 1, cantidad_minima = 2 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 1, 2);
    END IF;

    -- Row 241: 10019836100751 (Jugo Boing 125ml Con 24pz Surtidas) - [Factor: 24]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '10019836100751';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('10019836100751', 'Jugo Boing 125ml Con 24pz Surtidas', 1, 119) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'PAQUETE' (Factor: 24)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 24 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 24 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'PAQUETE', 24) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 135, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 135, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 2, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 2, 0);
    END IF;

    -- Row 242: 17501039400880 (Jugo Boing 1lt Surtido) - [Factor: 1]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '17501039400880';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('17501039400880', 'Jugo Boing 1lt Surtido', 1, 295) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'Pieza' (Factor: 1)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 1 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 1 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'Pieza', 1) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 310, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 310, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 11, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 11, 0);
    END IF;

    -- Row 243: 19836100198 (Jugo Boing 250ml Surtido Con 27pz) - [Factor: 27]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '19836100198';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('19836100198', 'Jugo Boing 250ml Surtido Con 27pz', 1, 206) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'PAQUETE' (Factor: 27)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 27 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 27 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'PAQUETE', 27) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 230, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 230, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 57, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 57, 0);
    END IF;

    -- Row 244: 10019836103868 (Jugo Boing Botellin Surtido 354ml Vidrio) - [Factor: 1]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '10019836103868';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('10019836103868', 'Jugo Boing Botellin Surtido 354ml Vidrio', 1, 290) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'Pieza' (Factor: 1)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 1 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 1 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'Pieza', 1) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 300, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 300, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 0, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 0, 0);
    END IF;

    -- Row 245: 1983620021 (Jugo Boing Durazno 500ml Con 24pz) - [Factor: 24]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '1983620021';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('1983620021', 'Jugo Boing Durazno 500ml Con 24pz', 1, 295) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'PAQUETE' (Factor: 24)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 24 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 24 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'PAQUETE', 24) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 310, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 310, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 70, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 70, 0);
    END IF;

    -- Row 246: 75003135 (Jugo Boing Guayaba 500ml Con 24) - [Factor: 24]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '75003135';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('75003135', 'Jugo Boing Guayaba 500ml Con 24', 1, 295) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'PAQUETE' (Factor: 24)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 24 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 24 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'PAQUETE', 24) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 320, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 320, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 1, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 1, 0);
    END IF;

    -- Row 247: 75003104 (Jugo Boing Mango 500ml Con 24 Pz) - [Factor: 24]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '75003104';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('75003104', 'Jugo Boing Mango 500ml Con 24 Pz', 1, 295) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'PAQUETE' (Factor: 24)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 24 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 24 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'PAQUETE', 24) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 320, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 320, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 8, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 8, 0);
    END IF;

    -- Row 248: 7501039401156 (Jugo Boing Manzana 500ml Con 24pz) - [Factor: 24]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '7501039401156';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('7501039401156', 'Jugo Boing Manzana 500ml Con 24pz', 1, 296.82) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'PAQUETE' (Factor: 24)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 24 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 24 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'PAQUETE', 24) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 320, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 320, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 3, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 3, 0);
    END IF;

    -- Row 249: 19836200195 (Jugo Boing Surtido De 500ml Con 24pz) - [Factor: 24]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '19836200195';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('19836200195', 'Jugo Boing Surtido De 500ml Con 24pz', 1, 295) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'PAQUETE' (Factor: 24)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 24 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 24 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'PAQUETE', 24) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 320, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 320, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 22, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 22, 0);
    END IF;

    -- Row 250: 7501039400913 (Jugo Boing Triangulo 200ml Con 18 Pz Sdo) - [Factor: 18]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '7501039400913';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('7501039400913', 'Jugo Boing Triangulo 200ml Con 18 Pz Sdo', 1, 123.48) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'PAQUETE' (Factor: 18)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 18 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 18 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'PAQUETE', 18) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 140, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 140, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 1, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 1, 0);
    END IF;

    -- Row 251: JUGO BOING (Jugo Boing Vidrio Reja) - [Factor: 1]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = 'JUGO BOING';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('JUGO BOING', 'Jugo Boing Vidrio Reja', 1, 295) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'Pieza' (Factor: 1)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 1 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 1 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'Pieza', 1) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 320, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 320, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 15, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 15, 0);
    END IF;

    -- Row 252: 17501039400408 (Jugo Boing Vidrio Sdo Desechable Con 24pz) - [Factor: 24]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '17501039400408';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('17501039400408', 'Jugo Boing Vidrio Sdo Desechable Con 24pz', 1, 223) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'PAQUETE' (Factor: 24)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 24 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 24 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'PAQUETE', 24) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 240, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 240, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 10, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 10, 0);
    END IF;

    -- Row 253: 7501055377978 (Jugo Florida 473ml Con 24pz) - [Factor: 24]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '7501055377978';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('7501055377978', 'Jugo Florida 473ml Con 24pz', 1, 163) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'PAQUETE' (Factor: 24)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 24 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 24 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'PAQUETE', 24) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 190, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 190, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 0, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 0, 0);
    END IF;

    -- Row 254: 32239058156 (Juguito Valle 200ml) - [Factor: 1]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '32239058156';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('32239058156', 'Juguito Valle 200ml', 1, 3) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'Pieza' (Factor: 1)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 1 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 1 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'Pieza', 1) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 5, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 5, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 21, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 21, 0);
    END IF;

    -- Row 255: 17501013122036 (Jumex 1lt Surtido) - [Factor: 1]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '17501013122036';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('17501013122036', 'Jumex 1lt Surtido', 1, 232) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'Pieza' (Factor: 1)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 1 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 1 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'Pieza', 1) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 265, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 265, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 83, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 83, 0);
    END IF;

    -- Row 256: 7501013105599 (Jumex 237ml Surtido 24 Pz) - [Factor: 24]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '7501013105599';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('7501013105599', 'Jumex 237ml Surtido 24 Pz', 1, 202.6) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'PAQUETE' (Factor: 24)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 24 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 24 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'PAQUETE', 24) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 220, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 220, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 34, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 34, 0);
    END IF;

    -- Row 257: 7501013102918 (Jumex 3pz1lt Sdo) - [Factor: 3]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '7501013102918';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('7501013102918', 'Jumex 3pz1lt Sdo', 1, 45) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'PAQUETE' (Factor: 3)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 3 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 3 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'PAQUETE', 3) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 60, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 60, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 0, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 0, 0);
    END IF;

    -- Row 258: 17501013108078 (Jumex Ami 946 Ml 12pz) - [Factor: 12]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '17501013108078';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('17501013108078', 'Jumex Ami 946 Ml 12pz', 1, 190) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'PAQUETE' (Factor: 12)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 12 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 12 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'PAQUETE', 12) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 195, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 195, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 7, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 7, 0);
    END IF;

    -- Row 259: 17501013105862 (Jumex Ami Surtido 591 Ml 12 Pz) - [Factor: 12]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '17501013105862';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('17501013105862', 'Jumex Ami Surtido 591 Ml 12 Pz', 1, 144) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'PAQUETE' (Factor: 12)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 12 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 12 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'PAQUETE', 12) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 165, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 165, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 4, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 4, 0);
    END IF;

    -- Row 260: 7501031307258 (Jumex Fresh 2l Naranja) - [Factor: 1]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '7501031307258';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('7501031307258', 'Jumex Fresh 2l Naranja', 1, 138) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'Pieza' (Factor: 1)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 1 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 1 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'Pieza', 1) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 165, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 165, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 0, cantidad_minima = 1 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 0, 1);
    END IF;

    -- Row 261: 7501022010778 (Jumex Fruzzo 1.5) - [Factor: 1]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '7501022010778';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('7501022010778', 'Jumex Fruzzo 1.5', 1, 118) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'Pieza' (Factor: 1)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 1 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 1 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'Pieza', 1) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 130, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 130, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 1, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 1, 0);
    END IF;

    -- Row 262: 7501013102925 (Jumex 1a Sdo12px 450ml) - [Factor: 1]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '7501013102925';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('7501013102925', 'Jumex 1a Sdo12px 450ml', 1, 168) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'Pieza' (Factor: 1)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 1 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 1 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'Pieza', 1) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 185, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 185, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 16, cantidad_minima = 5 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 16, 5);
    END IF;

    -- Row 263: 7501013102840 (Jumex Lata Botella Sdo 473ml 12pz) - [Factor: 12]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '7501013102840';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('7501013102840', 'Jumex Lata Botella Sdo 473ml 12pz', 1, 196.6) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'PAQUETE' (Factor: 12)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 12 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 12 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'PAQUETE', 12) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 215, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 215, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 47, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 47, 0);
    END IF;

    -- Row 264: 7501013102321 (Jumex Minibik 250ml 40pz) - [Factor: 40]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '7501013102321';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('7501013102321', 'Jumex Minibik 250ml 40pz', 1, 135.5) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'PAQUETE' (Factor: 40)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 40 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 40 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'PAQUETE', 40) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 325, precio_mayoreo = 195 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 325, 195);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 1, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 1, 0);
    END IF;

    -- Row 265: 17506192509593 (Kool Blue Berry 355ml 12pz) - [Factor: 12]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '17506192509593';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('17506192509593', 'Kool Blue Berry 355ml 12pz', 10, 180) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'PAQUETE' (Factor: 12)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 12 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 12 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'PAQUETE', 12) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 210, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 210, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 17, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 17, 0);
    END IF;

    -- Row 266: 17506192509609 (Kool Citrus 355ml 12pz) - [Factor: 12]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '17506192509609';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('17506192509609', 'Kool Citrus 355ml 12pz', 10, 170) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'PAQUETE' (Factor: 12)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 12 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 12 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'PAQUETE', 12) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 210, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 210, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 0, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 0, 0);
    END IF;

    -- Row 267: 17506192509586 (Kool Durazno 355ml 12pz) - [Factor: 12]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '17506192509586';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('17506192509586', 'Kool Durazno 355ml 12pz', 10, 192) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'PAQUETE' (Factor: 12)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 12 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 12 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'PAQUETE', 12) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 210, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 210, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 8, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 8, 0);
    END IF;

    -- Row 268: 17506192510728 (Kool Fresa Moras) - [Factor: 1]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '17506192510728';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('17506192510728', 'Kool Fresa Moras', 10, 192) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'Pieza' (Factor: 1)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 1 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 1 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'Pieza', 1) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 210, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 210, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 16, cantidad_minima = 1 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 16, 1);
    END IF;

    -- Row 269: 7506192510325 (Kool Mango 355ml 12 Pz) - [Factor: 12]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '7506192510325';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('7506192510325', 'Kool Mango 355ml 12 Pz', 10, 192) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'PAQUETE' (Factor: 12)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 12 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 12 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'PAQUETE', 12) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 210, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 210, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 16, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 16, 0);
    END IF;

    -- Row 270: 70847035916 (LATA Monster 473ml Energy Lata PZ) - [Factor: 1]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '70847035916';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('70847035916', 'LATA Monster 473ml Energy Lata PZ', 14, 23.33) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'Pieza' (Factor: 1)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 1 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 1 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'Pieza', 1) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 27.5, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 27.5, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 112, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 112, 0);
    END IF;

    -- Row 271: 7501295600157 (LECHE SANTA CLARA DESLACTOSADA 6PZ 1L) - [Factor: 6]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '7501295600157';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('7501295600157', 'LECHE SANTA CLARA DESLACTOSADA 6PZ 1L', 9, 140) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'PAQUETE' (Factor: 6)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 6 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 6 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'PAQUETE', 6) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 160, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 160, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 10, cantidad_minima = 1 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 10, 1);
    END IF;

    -- Row 272: 7501055912872 (Leche Alpura Deslactosada 1lt 6pz) - [Factor: 6]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '7501055912872';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('7501055912872', 'Leche Alpura Deslactosada 1lt 6pz', 9, 130.16) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'PAQUETE' (Factor: 6)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 6 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 6 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'PAQUETE', 6) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 135, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 135, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 0, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 0, 0);
    END IF;

    -- Row 273: 7501020558173 (Leche Lala Deslactosada 1lt 6pz) - [Factor: 6]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '7501020558173';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('7501020558173', 'Leche Lala Deslactosada 1lt 6pz', 9, 118) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'PAQUETE' (Factor: 6)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 6 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 6 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'PAQUETE', 6) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 132, precio_mayoreo = 130 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 132, 130);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 0, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 0, 0);
    END IF;

    -- Row 274: 17501020544395 (Leche Nutri Deslactosada Con 12) - [Factor: 12]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '17501020544395';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('17501020544395', 'Leche Nutri Deslactosada Con 12', 9, 200) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'PAQUETE' (Factor: 12)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 12 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 12 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'PAQUETE', 12) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 225, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 225, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 0, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 0, 0);
    END IF;

    -- Row 275: 7501020540703 (Leche Nutrileche 1lt Con 12 Pz) - [Factor: 12]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '7501020540703';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('7501020540703', 'Leche Nutrileche 1lt Con 12 Pz', 9, 203) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'PAQUETE' (Factor: 12)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 12 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 12 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'PAQUETE', 12) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 215, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 215, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 8, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 8, 0);
    END IF;

    -- Row 276: 7501295600126 (Leche Santa Clara 1lt 6pz ENTERA) - [Factor: 6]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '7501295600126';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('7501295600126', 'Leche Santa Clara 1lt 6pz ENTERA', 9, 139.5) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'PAQUETE' (Factor: 6)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 6 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 6 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'PAQUETE', 6) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 160, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 160, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 12, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 12, 0);
    END IF;

    -- Row 277: 7501055915613 (Lechita Alpurita Surtida Con 24 Pz 180ml) - [Factor: 24]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '7501055915613';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('7501055915613', 'Lechita Alpurita Surtida Con 24 Pz 180ml', 9, 144) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'PAQUETE' (Factor: 24)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 24 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 24 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'PAQUETE', 24) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 180, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 180, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 2, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 2, 0);
    END IF;

    -- Row 278: 7501055377183 (Lechita Santa Clara 4pz) - [Factor: 4]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '7501055377183';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('7501055377183', 'Lechita Santa Clara 4pz', 9, 39) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'PAQUETE' (Factor: 4)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 4 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 4 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'PAQUETE', 4) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 45, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 45, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 0, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 0, 0);
    END IF;

    -- Row 279: 7501055377596 (Lechita Santa Clara Surtido 27pz) - [Factor: 27]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '7501055377596';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('7501055377596', 'Lechita Santa Clara Surtido 27pz', 9, 240) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'PAQUETE' (Factor: 27)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 27 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 27 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'PAQUETE', 27) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 260, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 260, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 6, cantidad_minima = 1 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 6, 1);
    END IF;

    -- Row 280: YOMYSURTIDO (Lechita Yomy Surtida 27pz) - [Factor: 27]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = 'YOMYSURTIDO';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('YOMYSURTIDO', 'Lechita Yomy Surtida 27pz', 9, 164.5) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'PAQUETE' (Factor: 27)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 27 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 27 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'PAQUETE', 27) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 190, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 190, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 16, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 16, 0);
    END IF;

    -- Row 281: 7502226815169 (Lucas Panzon) - [Factor: 1]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '7502226815169';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('7502226815169', 'Lucas Panzon', 7, 183) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'Pieza' (Factor: 1)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 1 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 1 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'Pieza', 1) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 200, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 200, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 1, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 1, 0);
    END IF;

    -- Row 282: 41789901980 (MARUCHA VASO PIQUIN CON 12 PZ) - [Factor: 12]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '41789901980';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('41789901980', 'MARUCHA VASO PIQUIN CON 12 PZ', 2, 160) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'PAQUETE' (Factor: 12)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 12 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 12 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'PAQUETE', 12) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 175, precio_mayoreo = 185 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 175, 185);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 15, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 15, 0);
    END IF;

    -- Row 283: 41789901836 (MARUCHA VASO QUESO CON 12 PZ) - [Factor: 12]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '41789901836';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('41789901836', 'MARUCHA VASO QUESO CON 12 PZ', 2, 151.2) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'PAQUETE' (Factor: 12)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 12 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 12 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'PAQUETE', 12) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 170, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 170, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 0, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 0, 0);
    END IF;

    -- Row 284: 41789908019 (MARUCHAN OTTIMA PASTA 22PZ) - [Factor: 22]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '41789908019';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('41789908019', 'MARUCHAN OTTIMA PASTA 22PZ', 2, 143) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'PAQUETE' (Factor: 22)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 22 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 22 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'PAQUETE', 22) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 165, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 165, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 3, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 3, 0);
    END IF;

    -- Row 285: 41789901911 (MARUCHAN POLLO VASO 12 PZ) - [Factor: 12]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '41789901911';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('41789901911', 'MARUCHAN POLLO VASO 12 PZ', 2, 178) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'PAQUETE' (Factor: 12)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 12 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 12 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'PAQUETE', 12) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 190, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 190, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 2, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 2, 0);
    END IF;

    -- Row 286: 41789901867 (MARUCHAN VASO HABANERO CON 12 PZ) - [Factor: 12]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '41789901867';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('41789901867', 'MARUCHAN VASO HABANERO CON 12 PZ', 2, 150) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'PAQUETE' (Factor: 12)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 12 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 12 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'PAQUETE', 12) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 175, precio_mayoreo = 165 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 175, 165);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 346, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 346, 0);
    END IF;

    -- Row 287: 417899079 (MARUCHAN YAKISOBA) - [Factor: 1]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '417899079';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('417899079', 'MARUCHAN YAKISOBA', 2, 144) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'Pieza' (Factor: 1)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 1 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 1 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'Pieza', 1) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 165, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 165, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 19, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 19, 0);
    END IF;

    -- Row 288: 7501064101410 (MEDIA CORONA) - [Factor: 1]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '7501064101410';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('7501064101410', 'MEDIA CORONA', 10, 13.11) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'Pieza' (Factor: 1)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 1 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 1 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'Pieza', 1) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 15.54, precio_mayoreo = 14.38 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 15.54, 14.38);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 2320, cantidad_minima = 720 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 2320, 720);
    END IF;

    -- Row 289: 7501064115400 (MEDIA VICTORIA) - [Factor: 1]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '7501064115400';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('7501064115400', 'MEDIA VICTORIA', 10, 12.59) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'Pieza' (Factor: 1)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 1 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 1 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'Pieza', 1) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 14.5, precio_mayoreo = 14.37 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 14.5, 14.37);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 1115, cantidad_minima = 720 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 1115, 720);
    END IF;

    -- Row 290: 7501064191909 (MEGA VICTORIA) - [Factor: 1]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '7501064191909';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('7501064191909', 'MEGA VICTORIA', 10, 460) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'Pieza' (Factor: 1)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 1 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 1 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'Pieza', 1) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 490, precio_mayoreo = 470 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 490, 470);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 71, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 71, 0);
    END IF;

    -- Row 291: 7506192508704 (MEXICANA 600ML 12PZ) - [Factor: 12]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '7506192508704';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('7506192508704', 'MEXICANA 600ML 12PZ', 1, 140) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'PAQUETE' (Factor: 12)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 12 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 12 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'PAQUETE', 12) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 160, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 160, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 2, cantidad_minima = 1 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 2, 1);
    END IF;

    -- Row 292: 7506192508698 (MEXINA 400ML 12PZ) - [Factor: 12]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '7506192508698';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('7506192508698', 'MEXINA 400ML 12PZ', 1, 95) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'PAQUETE' (Factor: 12)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 12 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 12 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'PAQUETE', 12) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 105, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 105, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 0, cantidad_minima = 1 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 0, 1);
    END IF;

    -- Row 293: 7501030448242 (MINITAKIS FUEGO 35GR TIRA 10PZ) - [Factor: 10]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '7501030448242';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('7501030448242', 'MINITAKIS FUEGO 35GR TIRA 10PZ', 7, 7.56) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'PAQUETE' (Factor: 10)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 10 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 10 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'PAQUETE', 10) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 8, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 8, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 20, cantidad_minima = 1 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 20, 1);
    END IF;

    -- Row 294: 75001339 (Malboro Rojo 14) - [Factor: 1]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '75001339';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('75001339', 'Malboro Rojo 14', 11, 515) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'Pieza' (Factor: 1)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 1 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 1 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'Pieza', 1) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 540, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 540, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 10, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 10, 0);
    END IF;

    -- Row 295: 41789901959 (Marucha Camaron Vaso Con 12pz) - [Factor: 12]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '41789901959';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('41789901959', 'Marucha Camaron Vaso Con 12pz', 2, 178) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'PAQUETE' (Factor: 12)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 12 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 12 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'PAQUETE', 12) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 185, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 185, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 42, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 42, 0);
    END IF;

    -- Row 296: 41789901850 (Marucha Vaso Camaron Y Limon) - [Factor: 1]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '41789901850';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('41789901850', 'Marucha Vaso Camaron Y Limon', 2, 176) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'Pieza' (Factor: 1)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 1 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 1 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'Pieza', 1) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 185, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 185, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 8, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 8, 0);
    END IF;

    -- Row 297: 41789901928 (Marucha Vaso De Res) - [Factor: 1]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '41789901928';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('41789901928', 'Marucha Vaso De Res', 2, 178) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'Pieza' (Factor: 1)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 1 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 1 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'Pieza', 1) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 190, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 190, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 2, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 2, 0);
    END IF;

    -- Row 298: 41789002991 (Marucham Ramen Pollo Picante 24pz) - [Factor: 24]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '41789002991';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('41789002991', 'Marucham Ramen Pollo Picante 24pz', 2, 165) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'PAQUETE' (Factor: 24)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 24 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 24 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'PAQUETE', 24) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 165, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 165, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 3, cantidad_minima = 1 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 3, 1);
    END IF;

    -- Row 299: 41789001840 (Maruchan Pollo Picante) - [Factor: 1]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '41789001840';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('41789001840', 'Maruchan Pollo Picante', 2, 170) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'Pieza' (Factor: 1)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 1 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 1 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'Pieza', 1) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 175, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 175, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 0, cantidad_minima = 1 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 0, 1);
    END IF;

    -- Row 300: 41789902987 (Maruchan Ramen Camaron Picante 24pz) - [Factor: 24]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '41789902987';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('41789902987', 'Maruchan Ramen Camaron Picante 24pz', 2, 160) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'PAQUETE' (Factor: 24)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 24 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 24 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'PAQUETE', 24) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 175, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 175, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 8, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 8, 0);
    END IF;

    -- Row 301: 41789002960 (Maruchan Ramen Habanero) - [Factor: 1]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '41789002960';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('41789002960', 'Maruchan Ramen Habanero', 2, 160) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'Pieza' (Factor: 1)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 1 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 1 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'Pieza', 1) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 165, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 165, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 17, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 17, 0);
    END IF;

    -- Row 302: 41789902994 (Maruchan Ramen Pollo Picante 24pz) - [Factor: 24]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '41789902994';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('41789902994', 'Maruchan Ramen Pollo Picante 24pz', 2, 160) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'PAQUETE' (Factor: 24)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 24 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 24 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'PAQUETE', 24) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 175, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 175, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 0, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 0, 0);
    END IF;

    -- Row 303: 7501064101205 (Mega Corona 12 Pz) - [Factor: 12]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '7501064101205';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('7501064101205', 'Mega Corona 12 Pz', 10, 465) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'PAQUETE' (Factor: 12)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 12 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 12 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'PAQUETE', 12) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 490, precio_mayoreo = 470 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 490, 470);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 39, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 39, 0);
    END IF;

    -- Row 304: 7501064199301 (Michelod Ultra Laton 473ml) - [Factor: 1]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '7501064199301';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('7501064199301', 'Michelod Ultra Laton 473ml', 10, 517.29) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'Pieza' (Factor: 1)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 1 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 1 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'Pieza', 1) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 535, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 535, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 1, cantidad_minima = 1 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 1, 1);
    END IF;

    -- Row 305: 7503024460889 (Modelo 710ml  Lata Con 12 Pz) - [Factor: 12]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '7503024460889';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('7503024460889', 'Modelo 710ml  Lata Con 12 Pz', 10, 453) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'PAQUETE' (Factor: 12)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 12 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 12 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'PAQUETE', 12) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 470, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 470, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 5, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 5, 0);
    END IF;

    -- Row 306: 7501064112546 (Modelo Bote 355 Ml Con 24pz) - [Factor: 24]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '7501064112546';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('7501064112546', 'Modelo Bote 355 Ml Con 24pz', 10, 385) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'PAQUETE' (Factor: 24)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 24 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 24 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'PAQUETE', 24) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 405, precio_mayoreo = 400 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 405, 400);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 24, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 24, 0);
    END IF;

    -- Row 307: 7501064191886 (Modelo Laton 473ml Con 24 Pz) - [Factor: 24]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '7501064191886';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('7501064191886', 'Modelo Laton 473ml Con 24 Pz', 10, 465) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'PAQUETE' (Factor: 24)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 24 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 24 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'PAQUETE', 24) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 490, precio_mayoreo = 470 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 490, 470);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 73, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 73, 0);
    END IF;

    -- Row 308: 7501064198519 (Modelo Litron 12pz) - [Factor: 12]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '7501064198519';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('7501064198519', 'Modelo Litron 12pz', 10, 468) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'PAQUETE' (Factor: 12)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 12 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 12 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'PAQUETE', 12) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 485, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 485, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 4, cantidad_minima = 3 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 4, 3);
    END IF;

    -- Row 309: 7503034941163 (Modelo Negra 473ml Con 24 Pz) - [Factor: 24]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '7503034941163';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('7503034941163', 'Modelo Negra 473ml Con 24 Pz', 10, 550) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'PAQUETE' (Factor: 24)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 24 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 24 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'PAQUETE', 24) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 565, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 565, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 9, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 9, 0);
    END IF;

    -- Row 310: 7501064196935 (Modelo Negra Bote 355ml Con 24pz) - [Factor: 24]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '7501064196935';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('7501064196935', 'Modelo Negra Bote 355ml Con 24pz', 10, 416) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'PAQUETE' (Factor: 24)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 24 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 24 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'PAQUETE', 24) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 430, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 430, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 0, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 0, 0);
    END IF;

    -- Row 311: 75027285 (Modelo Negra Cristal 355ml) - [Factor: 1]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '75027285';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('75027285', 'Modelo Negra Cristal 355ml', 10, 213) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'Pieza' (Factor: 1)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 1 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 1 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'Pieza', 1) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 225, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 225, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 0, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 0, 0);
    END IF;

    -- Row 312: 7503024460070 (Modelo Negra Litron 12pz) - [Factor: 12]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '7503024460070';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('7503024460070', 'Modelo Negra Litron 12pz', 10, 468) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'PAQUETE' (Factor: 12)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 12 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 12 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'PAQUETE', 12) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 485, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 485, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 7, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 7, 0);
    END IF;

    -- Row 313: 70847036043 (Monster Energy Cero Ultra 473ml 4pak) - [Factor: 1]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '70847036043';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('70847036043', 'Monster Energy Cero Ultra 473ml 4pak', 1, 114) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'Pieza' (Factor: 1)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 1 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 1 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'Pieza', 1) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 125, precio_mayoreo = 118.33 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 125, 118.33);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 12, cantidad_minima = 1 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 12, 1);
    END IF;

    -- Row 314: 70847894216 (Monster Golden 473ml 4pz) - [Factor: 4]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '70847894216';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('70847894216', 'Monster Golden 473ml 4pz', 14, 110) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'PAQUETE' (Factor: 4)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 4 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 4 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'PAQUETE', 4) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 120, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 120, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 0, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 0, 0);
    END IF;

    -- Row 315: 70847890355 (Monster Watermelon 473ml 4pz) - [Factor: 4]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '70847890355';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('70847890355', 'Monster Watermelon 473ml 4pz', 14, 114) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'PAQUETE' (Factor: 4)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 4 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 4 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'PAQUETE', 4) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 120, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 120, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 0, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 0, 0);
    END IF;

    -- Row 316: 7502226815190 (Muecas Lucas 20pz) - [Factor: 20]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '7502226815190';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('7502226815190', 'Muecas Lucas 20pz', 7, 142.19) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'PAQUETE' (Factor: 20)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 20 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 20 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'PAQUETE', 20) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 160, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 160, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 0, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 0, 0);
    END IF;

    -- Row 317: 744607008907 (NEW MIX CANTARITO 355ML 6PZ) - [Factor: 6]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '744607008907';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('744607008907', 'NEW MIX CANTARITO 355ML 6PZ', 10, 121.8) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'PAQUETE' (Factor: 6)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 6 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 6 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'PAQUETE', 6) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 135, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 135, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 1, cantidad_minima = 1 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 1, 1);
    END IF;

    -- Row 318: 27541007619 (NIAGARA 500ML CON 35PZ) - [Factor: 35]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '27541007619';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('27541007619', 'NIAGARA 500ML CON 35PZ', 1, 80) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'PAQUETE' (Factor: 35)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 35 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 35 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'PAQUETE', 35) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 95, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 95, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 0, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 0, 0);
    END IF;

    -- Row 319: 744607002707 (New Mix Bampiro Laton 473ml 6pz) - [Factor: 6]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '744607002707';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('744607002707', 'New Mix Bampiro Laton 473ml 6pz', 10, 158.67) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'PAQUETE' (Factor: 6)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 6 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 6 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'PAQUETE', 6) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 170, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 170, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 32, cantidad_minima = 1 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 32, 1);
    END IF;

    -- Row 320: 744607840804 (New Mix Paloma 350ml Con 6pz) - [Factor: 6]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '744607840804';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('744607840804', 'New Mix Paloma 350ml Con 6pz', 10, 124.85) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'PAQUETE' (Factor: 6)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 6 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 6 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'PAQUETE', 6) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 140, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 140, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 40, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 40, 0);
    END IF;

    -- Row 321: 744607002691 (New Mix Paloma Laton 473ml 6pz) - [Factor: 6]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '744607002691';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('744607002691', 'New Mix Paloma Laton 473ml 6pz', 10, 158.57) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'PAQUETE' (Factor: 6)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 6 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 6 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'PAQUETE', 6) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 170, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 170, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 40, cantidad_minima = 1 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 40, 1);
    END IF;

    -- Row 322: 744607588805 (New Mix Vampiro 350ml) - [Factor: 1]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '744607588805';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('744607588805', 'New Mix Vampiro 350ml', 10, 124.85) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'Pieza' (Factor: 1)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 1 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 1 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'Pieza', 1) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 140, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 140, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 40, cantidad_minima = 1 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 40, 1);
    END IF;

    -- Row 323: 7500463584411 (OSITO GOBY 190ML 20PZ) - [Factor: 20]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '7500463584411';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('7500463584411', 'OSITO GOBY 190ML 20PZ', 1, 55) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'PAQUETE' (Factor: 20)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 20 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 20 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'PAQUETE', 20) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 70, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 70, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 1, cantidad_minima = 1 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 1, 1);
    END IF;

    -- Row 324: 7500810027783 (PAPAS 7 SAL DE MESA 28GR) - [Factor: 1]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '7500810027783';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('7500810027783', 'PAPAS 7 SAL DE MESA 28GR', 7, 7.56) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'Pieza' (Factor: 1)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 1 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 1 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'Pieza', 1) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 8, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 8, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 18, cantidad_minima = 1 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 18, 1);
    END IF;

    -- Row 325: 7501022009321 (PEPSI 1.75L CON 12PZ) - [Factor: 12]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '7501022009321';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('7501022009321', 'PEPSI 1.75L CON 12PZ', 1, 252.04) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'PAQUETE' (Factor: 12)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 12 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 12 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'PAQUETE', 12) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 275, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 275, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 0, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 0, 0);
    END IF;

    -- Row 326: PEPSI600ML (PEPSI 600ML CON 12 PZ) - [Factor: 12]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = 'PEPSI600ML';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('PEPSI600ML', 'PEPSI 600ML CON 12 PZ', 1, 157) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'PAQUETE' (Factor: 12)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 12 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 12 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'PAQUETE', 12) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 200, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 200, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 17, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 17, 0);
    END IF;

    -- Row 327: 7501031311309 (PEPSI LATA 355ML CON 24PZ) - [Factor: 24]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '7501031311309';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('7501031311309', 'PEPSI LATA 355ML CON 24PZ', 1, 234) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'PAQUETE' (Factor: 24)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 24 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 24 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'PAQUETE', 24) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 275, precio_mayoreo = 270 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 275, 270);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 3, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 3, 0);
    END IF;

    -- Row 328: 1PEPSISURTD (PEPSI MULTISABOR 3L) - [Factor: 1]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '1PEPSISURTD';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('1PEPSISURTD', 'PEPSI MULTISABOR 3L', 1, 195) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'Pieza' (Factor: 1)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 1 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 1 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'Pieza', 1) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 200, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 200, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 4, cantidad_minima = 1 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 4, 1);
    END IF;

    -- Row 329: 7501022013380 (PEPSI MULTISABOR 600ML CON 24 PZ) - [Factor: 24]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '7501022013380';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('7501022013380', 'PEPSI MULTISABOR 600ML CON 24 PZ', 1, 261.7) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'PAQUETE' (Factor: 24)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 24 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 24 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'PAQUETE', 24) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 310, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 310, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 2, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 2, 0);
    END IF;

    -- Row 330: REJASABOR (PEPSI SABOR MEDIO LITRO VIDRIO) - [Factor: 1]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = 'REJASABOR';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('REJASABOR', 'PEPSI SABOR MEDIO LITRO VIDRIO', 1, 208) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'Pieza' (Factor: 1)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 1 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 1 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'Pieza', 1) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 230, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 230, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 6, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 6, 0);
    END IF;

    -- Row 331: SABORPEPSI600 (PEPSI Sabores 600 CON 12PZ) - [Factor: 12]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = 'SABORPEPSI600';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('SABORPEPSI600', 'PEPSI Sabores 600 CON 12PZ', 1, 157) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'PAQUETE' (Factor: 12)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 12 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 12 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'PAQUETE', 12) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 180, precio_mayoreo = 175 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 180, 175);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 3, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 3, 0);
    END IF;

    -- Row 332: 7501073842144 (PEAFIEL 355  ADAS CON 24) - [Factor: 24]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '7501073842144';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('7501073842144', 'PEAFIEL 355  ADAS CON 24', 1, 200.41) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'PAQUETE' (Factor: 24)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 24 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 24 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'PAQUETE', 24) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 225, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 225, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 5, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 5, 0);
    END IF;

    -- Row 333: 7501073830028 (PEAFIEL AGUA MINERAL 1LT 12 PZ) - [Factor: 12]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '7501073830028';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('7501073830028', 'PEAFIEL AGUA MINERAL 1LT 12 PZ', 1, 193.5) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'PAQUETE' (Factor: 12)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 12 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 12 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'PAQUETE', 12) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 210, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 210, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 1, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 1, 0);
    END IF;

    -- Row 334: PEAFIELFRESA600 (PEAFIEL FRESA 600ML 12 PZ) - [Factor: 12]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = 'PEAFIELFRESA600';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('PEAFIELFRESA600', 'PEAFIEL FRESA 600ML 12 PZ', 1, 157.5) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'PAQUETE' (Factor: 12)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 12 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 12 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'PAQUETE', 12) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 195, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 195, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 0, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 0, 0);
    END IF;

    -- Row 335: 7501073831469 (PEAFIEL TWIST 600ML 12PZ) - [Factor: 12]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '7501073831469';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('7501073831469', 'PEAFIEL TWIST 600ML 12PZ', 1, 175.5) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'PAQUETE' (Factor: 12)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 12 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 12 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'PAQUETE', 12) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 195, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 195, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 7, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 7, 0);
    END IF;

    -- Row 336: 815154022705 (PREDATOR 473ML GOLD STRIKE 6PZ DORADO) - [Factor: 6]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '815154022705';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('815154022705', 'PREDATOR 473ML GOLD STRIKE 6PZ DORADO', 14, 73.4) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'PAQUETE' (Factor: 6)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 6 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 6 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'PAQUETE', 6) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 95, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 95, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 1, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 1, 0);
    END IF;

    -- Row 337: 815154022156 (PREDATOR 473ML MEAT GREEN 6PZ VERDE) - [Factor: 6]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '815154022156';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('815154022156', 'PREDATOR 473ML MEAT GREEN 6PZ VERDE', 14, 70) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'PAQUETE' (Factor: 6)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 6 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 6 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'PAQUETE', 6) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 80, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 80, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 2, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 2, 0);
    END IF;

    -- Row 338: 815154025096 (PREDATOR RED APPLE  6PZ ROJO) - [Factor: 6]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '815154025096';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('815154025096', 'PREDATOR RED APPLE  6PZ ROJO', 14, 92) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'PAQUETE' (Factor: 6)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 6 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 6 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'PAQUETE', 6) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 95, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 95, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 6, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 6, 0);
    END IF;

    -- Row 339: 7501013104714 (PZ JUMEX DURAZNO 475ML) - [Factor: 1]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '7501013104714';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('7501013104714', 'PZ JUMEX DURAZNO 475ML', 1, 12.61) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'Pieza' (Factor: 1)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 1 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 1 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'Pieza', 1) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 14.58, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 14.58, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 4, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 4, 0);
    END IF;

    -- Row 340: 7501013102765 (PZ JUMEX MANGO 475 ML) - [Factor: 1]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '7501013102765';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('7501013102765', 'PZ JUMEX MANGO 475 ML', 1, 12.61) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'Pieza' (Factor: 1)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 1 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 1 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'Pieza', 1) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 14.58, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 14.58, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 4, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 4, 0);
    END IF;

    -- Row 341: 7501013104707 (PZ JUMEX MANZANA 475) - [Factor: 1]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '7501013104707';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('7501013104707', 'PZ JUMEX MANZANA 475', 1, 12.61) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'Pieza' (Factor: 1)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 1 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 1 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'Pieza', 1) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 14.58, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 14.58, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 52, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 52, 0);
    END IF;

    -- Row 342: 7501036624015 (PZ REGIO 8 ROLLOS) - [Factor: 1]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '7501036624015';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('7501036624015', 'PZ REGIO 8 ROLLOS', 2, 38) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'Pieza' (Factor: 1)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 1 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 1 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'Pieza', 1) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 40, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 40, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 5, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 5, 0);
    END IF;

    -- Row 343: 7501022014585 (PZ ZUP 600ML) - [Factor: 1]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '7501022014585';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('7501022014585', 'PZ ZUP 600ML', 1, 10.69) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'Pieza' (Factor: 1)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 1 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 1 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'Pieza', 1) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 13.33, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 13.33, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 1, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 1, 0);
    END IF;

    -- Row 344: 7501064199615 (Pacifico 355ml 24pz) - [Factor: 24]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '7501064199615';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('7501064199615', 'Pacifico 355ml 24pz', 10, 374.81) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'PAQUETE' (Factor: 24)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 24 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 24 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'PAQUETE', 24) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 420, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 420, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 27, cantidad_minima = 1 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 27, 1);
    END IF;

    -- Row 345: 7503031361957 (Paleta Vero Mix Banda Fuego 65pz) - [Factor: 65]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '7503031361957';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('7503031361957', 'Paleta Vero Mix Banda Fuego 65pz', 7, 127.87) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'PAQUETE' (Factor: 65)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 65 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 65 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'PAQUETE', 65) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 145, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 145, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 0, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 0, 0);
    END IF;

    -- Row 346: 7503031361964 (Paleta Vero Mix Dulce 65pz) - [Factor: 65]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '7503031361964';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('7503031361964', 'Paleta Vero Mix Dulce 65pz', 7, 127.87) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'PAQUETE' (Factor: 65)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 65 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 65 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'PAQUETE', 65) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 145, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 145, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 0, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 0, 0);
    END IF;

    -- Row 347: 7503040847817 (Paletas Space Girl 24pz) - [Factor: 24]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '7503040847817';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('7503040847817', 'Paletas Space Girl 24pz', 7, 72) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'PAQUETE' (Factor: 24)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 24 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 24 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'PAQUETE', 24) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 85, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 85, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 30, cantidad_minima = 1 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 30, 1);
    END IF;

    -- Row 348: 75079017 (Pall Mall Bora Bora Sunbreak) - [Factor: 1]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '75079017';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('75079017', 'Pall Mall Bora Bora Sunbreak', 11, 73) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'Pieza' (Factor: 1)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 1 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 1 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'Pieza', 1) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 80, precio_mayoreo = 76 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 80, 76);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 9, cantidad_minima = 1 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 9, 1);
    END IF;

    -- Row 349: 75074944 (Pall Mall Rio Sunset) - [Factor: 1]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '75074944';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('75074944', 'Pall Mall Rio Sunset', 11, 73) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'Pieza' (Factor: 1)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 1 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 1 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'Pieza', 1) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 78, precio_mayoreo = 75 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 78, 75);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 0, cantidad_minima = 1 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 0, 1);
    END IF;

    -- Row 350: 7500810027813 (Papas 7 Toreada 45gr) - [Factor: 1]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '7500810027813';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('7500810027813', 'Papas 7 Toreada 45gr', 7, 12.09) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'Pieza' (Factor: 1)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 1 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 1 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'Pieza', 1) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 13.9, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 13.9, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 1, cantidad_minima = 1 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 1, 1);
    END IF;

    -- Row 351: 7500810012277 (Papatinas Chips Chilix Pz) - [Factor: 1]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '7500810012277';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('7500810012277', 'Papatinas Chips Chilix Pz', 7, 12.09) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'Pieza' (Factor: 1)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 1 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 1 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'Pieza', 1) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 14, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 14, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 10, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 10, 0);
    END IF;

    -- Row 352: 7500810012284 (PapatinasChips Fuego Pz) - [Factor: 1]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '7500810012284';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('7500810012284', 'PapatinasChips Fuego Pz', 7, 12.09) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'Pieza' (Factor: 1)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 1 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 1 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'Pieza', 1) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 14, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 14, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 16, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 16, 0);
    END IF;

    -- Row 353: 7501013105407 (Pau Pau Con 24pz) - [Factor: 24]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '7501013105407';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('7501013105407', 'Pau Pau Con 24pz', 1, 95) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'PAQUETE' (Factor: 24)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 24 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 24 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'PAQUETE', 24) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 105, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 105, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 2, cantidad_minima = 2 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 2, 2);
    END IF;

    -- Row 354: 719886250545 (Pelon Chupelon) - [Factor: 1]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '719886250545';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('719886250545', 'Pelon Chupelon', 7, 131.95) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'Pieza' (Factor: 1)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 1 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 1 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'Pieza', 1) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 145, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 145, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 1, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 1, 0);
    END IF;

    -- Row 355: 719886250415 (Pelon Peloneta) - [Factor: 1]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '719886250415';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('719886250415', 'Pelon Peloneta', 7, 110.48) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'Pieza' (Factor: 1)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 1 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 1 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'Pieza', 1) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 125, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 125, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 0, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 0, 0);
    END IF;

    -- Row 356: 719886400230 (Pelon Pelone1) - [Factor: 1]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '719886400230';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('719886400230', 'Pelon Pelone1', 7, 118) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'Pieza' (Factor: 1)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 1 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 1 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'Pieza', 1) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 135, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 135, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 1, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 1, 0);
    END IF;

    -- Row 357: 719886211812 (Pelon Pelorico 20pz 30gr) - [Factor: 20]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '719886211812';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('719886211812', 'Pelon Pelorico 20pz 30gr', 7, 101) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'PAQUETE' (Factor: 20)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 20 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 20 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'PAQUETE', 20) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 115, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 115, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 0, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 0, 0);
    END IF;

    -- Row 358: 7501031305629 (Pepsi 2.5 Retornable Con 6pz) - [Factor: 6]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '7501031305629';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('7501031305629', 'Pepsi 2.5 Retornable Con 6pz', 1, 139.05) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'PAQUETE' (Factor: 6)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 6 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 6 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'PAQUETE', 6) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 150, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 150, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 17, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 17, 0);
    END IF;

    -- Row 359: 7501031311903 (Pepsi 2lt Retornable 8pz) - [Factor: 8]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '7501031311903';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('7501031311903', 'Pepsi 2lt Retornable 8pz', 1, 157.5) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'PAQUETE' (Factor: 8)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 8 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 8 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'PAQUETE', 8) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 170, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 170, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 8, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 8, 0);
    END IF;

    -- Row 360: 7501031310241 (Pepsi 355ml 12 Pz) - [Factor: 12]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '7501031310241';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('7501031310241', 'Pepsi 355ml 12 Pz', 1, 67.5) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'PAQUETE' (Factor: 12)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 12 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 12 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'PAQUETE', 12) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 82.5, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 82.5, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 2, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 2, 0);
    END IF;

    -- Row 361: 7501031310098 (Pepsi 3L Desechable Con 8pz) - [Factor: 8]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '7501031310098';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('7501031310098', 'Pepsi 3L Desechable Con 8pz', 1, 252) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'PAQUETE' (Factor: 8)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 8 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 8 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'PAQUETE', 8) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 270, precio_mayoreo = 260 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 270, 260);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 7, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 7, 0);
    END IF;

    -- Row 362: 7501031311606 (Pepsi De 2L desechable Con 8pz) - [Factor: 8]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '7501031311606';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('7501031311606', 'Pepsi De 2L desechable Con 8pz', 1, 214.5) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'PAQUETE' (Factor: 8)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 8 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 8 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'PAQUETE', 8) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 260, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 260, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 0, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 0, 0);
    END IF;

    -- Row 363: 7501022013700 (Pepsi Medio Litro Vidrio) - [Factor: 1]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '7501022013700';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('7501022013700', 'Pepsi Medio Litro Vidrio', 1, 208) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'Pieza' (Factor: 1)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 1 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 1 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'Pieza', 1) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 295, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 295, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 9, cantidad_minima = 1 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 9, 1);
    END IF;

    -- Row 364: 7501022012925 (Pepsi Multisabor 2lt Con 8pz) - [Factor: 8]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '7501022012925';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('7501022012925', 'Pepsi Multisabor 2lt Con 8pz', 1, 169.9) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'PAQUETE' (Factor: 8)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 8 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 8 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'PAQUETE', 8) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 190, precio_mayoreo = 190 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 190, 190);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 0, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 0, 0);
    END IF;

    -- Row 365: 7501022013649 (Pepsi Multisabor 400ml Con 24pz) - [Factor: 24]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '7501022013649';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('7501022013649', 'Pepsi Multisabor 400ml Con 24pz', 1, 190.1) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'PAQUETE' (Factor: 24)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 24 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 24 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'PAQUETE', 24) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 210, precio_mayoreo = 200 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 210, 200);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 15, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 15, 0);
    END IF;

    -- Row 366: 7501031345182 (Pepsi Sabor 355ml 12 Pz) - [Factor: 12]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '7501031345182';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('7501031345182', 'Pepsi Sabor 355ml 12 Pz', 1, 67.5) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'PAQUETE' (Factor: 12)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 12 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 12 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'PAQUETE', 12) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 82.5, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 82.5, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 1, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 1, 0);
    END IF;

    -- Row 367: 501022012697 (Pepsi Sabores Lata 36 Pz) - [Factor: 36]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '501022012697';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('501022012697', 'Pepsi Sabores Lata 36 Pz', 1, 385) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'PAQUETE' (Factor: 36)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 36 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 36 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'PAQUETE', 36) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 410, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 410, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 5, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 5, 0);
    END IF;

    -- Row 368: 7501073831964 (Peafiel 2lt Surtido Con 8Pz) - [Factor: 8]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '7501073831964';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('7501073831964', 'Peafiel 2lt Surtido Con 8Pz', 1, 181.9) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'PAQUETE' (Factor: 8)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 8 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 8 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'PAQUETE', 8) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 210, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 210, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 15, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 15, 0);
    END IF;

    -- Row 369: 7501073831186 (Peafiel 355ml 1 Surtido Con 12pz) - [Factor: 12]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '7501073831186';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('7501073831186', 'Peafiel 355ml 1 Surtido Con 12pz', 1, 110) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'PAQUETE' (Factor: 12)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 12 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 12 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'PAQUETE', 12) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 120, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 120, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 4, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 4, 0);
    END IF;

    -- Row 370: 7501073831926 (Peafiel 600ml Manzanita Con 12pz) - [Factor: 12]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '7501073831926';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('7501073831926', 'Peafiel 600ml Manzanita Con 12pz', 1, 157.5) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'PAQUETE' (Factor: 12)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 12 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 12 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'PAQUETE', 12) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 195, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 195, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 4, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 4, 0);
    END IF;

    -- Row 371: 7501073831896 (Peafiel 600ml Surtido Con 12pz) - [Factor: 12]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '7501073831896';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('7501073831896', 'Peafiel 600ml Surtido Con 12pz', 1, 174.9) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'PAQUETE' (Factor: 12)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 12 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 12 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'PAQUETE', 12) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 195, precio_mayoreo = 190 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 195, 190);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 16, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 16, 0);
    END IF;

    -- Row 372: AGUAMINERALCHICO (Peafiel Aagua Mineral Vidrio Chico Desechable Con 24) - [Factor: 24]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = 'AGUAMINERALCHICO';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('AGUAMINERALCHICO', 'Peafiel Aagua Mineral Vidrio Chico Desechable Con 24', 1, 255.61) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'PAQUETE' (Factor: 24)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 24 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 24 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'PAQUETE', 24) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 280, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 280, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 0, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 0, 0);
    END IF;

    -- Row 373: PENAFIELADASSDO2LT (Peafiel Adas 2lt Surtido Con 8pz) - [Factor: 8]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = 'PENAFIELADASSDO2LT';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('PENAFIELADASSDO2LT', 'Peafiel Adas 2lt Surtido Con 8pz', 1, 184.5) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'PAQUETE' (Factor: 8)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 8 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 8 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'PAQUETE', 8) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 210, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 210, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 19, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 19, 0);
    END IF;

    -- Row 374: PENAFIELADAS600 (Peafiel Adas 600ml Con 12pz) - [Factor: 12]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = 'PENAFIELADAS600';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('PENAFIELADAS600', 'Peafiel Adas 600ml Con 12pz', 1, 175.5) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'PAQUETE' (Factor: 12)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 12 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 12 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'PAQUETE', 12) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 195, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 195, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 40, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 40, 0);
    END IF;

    -- Row 375: 7501073800908 (Peafiel Agua Mineral 2L 8pz) - [Factor: 8]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '7501073800908';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('7501073800908', 'Peafiel Agua Mineral 2L 8pz', 1, 184.08) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'PAQUETE' (Factor: 8)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 8 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 8 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'PAQUETE', 8) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 200, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 200, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 28, cantidad_minima = 5 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 28, 5);
    END IF;

    -- Row 376: 7501073831148 (Peafiel Agua Mineral 355ml 24pz) - [Factor: 24]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '7501073831148';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('7501073831148', 'Peafiel Agua Mineral 355ml 24pz', 1, 221.4) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'PAQUETE' (Factor: 24)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 24 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 24 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'PAQUETE', 24) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 240, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 240, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 3, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 3, 0);
    END IF;

    -- Row 377: 7501073830509 (Peafiel Agua Mineral 600ml Con 12pz) - [Factor: 12]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '7501073830509';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('7501073830509', 'Peafiel Agua Mineral 600ml Con 12pz', 1, 166.5) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'PAQUETE' (Factor: 12)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 12 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 12 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'PAQUETE', 12) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 180, precio_mayoreo = 178 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 180, 178);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 7, cantidad_minima = 10 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 7, 10);
    END IF;

    -- Row 378: LIMONADA2LT (Peafiel Limonada 2lt Con 8pz) - [Factor: 8]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = 'LIMONADA2LT';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('LIMONADA2LT', 'Peafiel Limonada 2lt Con 8pz', 1, 189.9) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'PAQUETE' (Factor: 8)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 8 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 8 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'PAQUETE', 8) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 210, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 210, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 0, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 0, 0);
    END IF;

    -- Row 379: 7501073831988 (Peafiel Manzanita 2lt Con 8pz) - [Factor: 8]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '7501073831988';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('7501073831988', 'Peafiel Manzanita 2lt Con 8pz', 1, 189.9) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'PAQUETE' (Factor: 8)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 8 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 8 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'PAQUETE', 8) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 210, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 210, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 1, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 1, 0);
    END IF;

    -- Row 380: 7501073841024 (Peafiel Naranjada 1l 12pz) - [Factor: 12]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '7501073841024';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('7501073841024', 'Peafiel Naranjada 1l 12pz', 1, 193.5) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'PAQUETE' (Factor: 12)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 12 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 12 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'PAQUETE', 12) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 210, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 210, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 2, cantidad_minima = 1 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 2, 1);
    END IF;

    -- Row 381: PEAFIELNARANJADA2LT (Peafiel Naranjada 2lt Con 8pz) - [Factor: 8]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = 'PEAFIELNARANJADA2LT';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('PEAFIELNARANJADA2LT', 'Peafiel Naranjada 2lt Con 8pz', 1, 189.9) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'PAQUETE' (Factor: 8)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 8 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 8 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'PAQUETE', 8) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 210, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 210, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 13, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 13, 0);
    END IF;

    -- Row 382: PEAFIELPIADA2LT (Peafiel Piada 2lt Con 8pz) - [Factor: 8]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = 'PEAFIELPIADA2LT';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('PEAFIELPIADA2LT', 'Peafiel Piada 2lt Con 8pz', 1, 189.9) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'PAQUETE' (Factor: 8)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 8 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 8 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'PAQUETE', 8) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 210, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 210, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 7, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 7, 0);
    END IF;

    -- Row 383: 7501073840188 (Peafiel Twis Naranja Y Sal 600ml 12pz) - [Factor: 12]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '7501073840188';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('7501073840188', 'Peafiel Twis Naranja Y Sal 600ml 12pz', 1, 175.5) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'PAQUETE' (Factor: 12)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 12 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 12 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'PAQUETE', 12) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 195, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 195, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 7, cantidad_minima = 1 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 7, 1);
    END IF;

    -- Row 384: 7501073844179 (Peafieladas 400ml 12pz Surtd) - [Factor: 12]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '7501073844179';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('7501073844179', 'Peafieladas 400ml 12pz Surtd', 1, 110.7) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'PAQUETE' (Factor: 12)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 12 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 12 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'PAQUETE', 12) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 120, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 120, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 0, cantidad_minima = 1 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 0, 1);
    END IF;

    -- Row 385: 836456575 (Peafieladitas 355ml 12pz) - [Factor: 12]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '836456575';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('836456575', 'Peafieladitas 355ml 12pz', 1, 101.25) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'PAQUETE' (Factor: 12)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 12 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 12 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'PAQUETE', 12) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 113, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 113, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 0, cantidad_minima = 1 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 0, 1);
    END IF;

    -- Row 386: 757528038250 (Pica Fresa 200pz) - [Factor: 200]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '757528038250';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('757528038250', 'Pica Fresa 200pz', 7, 109.45) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'PAQUETE' (Factor: 200)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 200 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 200 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'PAQUETE', 200) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 120, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 120, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 0, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 0, 0);
    END IF;

    -- Row 387: 7500810005057 (Pop Karameladas 110g Pz) - [Factor: 1]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '7500810005057';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('7500810005057', 'Pop Karameladas 110g Pz', 7, 12.09) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'Pieza' (Factor: 1)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 1 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 1 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'Pieza', 1) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 14, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 14, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 4, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 4, 0);
    END IF;

    -- Row 388: 7500810005040 (Pop Karameladas 45gr) - [Factor: 1]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '7500810005040';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('7500810005040', 'Pop Karameladas 45gr', 7, 7.56) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'Pieza' (Factor: 1)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 1 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 1 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'Pieza', 1) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 8, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 8, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 0, cantidad_minima = 1 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 0, 1);
    END IF;

    -- Row 389: 7501055317653 (Powerade 1lt Mora 6pz) - [Factor: 6]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '7501055317653';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('7501055317653', 'Powerade 1lt Mora 6pz', 14, 130.23) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'PAQUETE' (Factor: 6)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 6 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 6 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'PAQUETE', 6) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 150, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 150, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 3, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 3, 0);
    END IF;

    -- Row 390: 7501055380602 (Powerade 1lt Surtido Con 12pz) - [Factor: 12]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '7501055380602';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('7501055380602', 'Powerade 1lt Surtido Con 12pz', 14, 258.29) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'PAQUETE' (Factor: 12)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 12 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 12 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'PAQUETE', 12) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 295, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 295, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 22, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 22, 0);
    END IF;

    -- Row 391: 7501055385065 (Powerade 500ml 15pz Surtd) - [Factor: 15]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '7501055385065';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('7501055385065', 'Powerade 500ml 15pz Surtd', 1, 204) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'PAQUETE' (Factor: 15)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 15 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 15 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'PAQUETE', 15) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 225, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 225, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 18, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 18, 0);
    END IF;

    -- Row 392: POWERADE600ML (Powerade 600ml Surtido 6pz) - [Factor: 6]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = 'POWERADE600ML';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('POWERADE600ML', 'Powerade 600ml Surtido 6pz', 14, 92) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'PAQUETE' (Factor: 6)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 6 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 6 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'PAQUETE', 6) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 105, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 105, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 0, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 0, 0);
    END IF;

    -- Row 393: 815154027007 (Predator Blu Berry 6pz) - [Factor: 6]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '815154027007';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('815154027007', 'Predator Blu Berry 6pz', 14, 0) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'PAQUETE' (Factor: 6)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 6 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 6 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'PAQUETE', 6) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 95, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 95, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 0, cantidad_minima = 1 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 0, 1);
    END IF;

    -- Row 394: 815154025744 (Predator Morado 473ml 4pz) - [Factor: 4]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '815154025744';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('815154025744', 'Predator Morado 473ml 4pz', 14, 92) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'PAQUETE' (Factor: 4)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 4 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 4 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'PAQUETE', 4) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 110, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 110, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 8, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 8, 0);
    END IF;

    -- Row 395: 725226005713 (Pulparindo 48pz) - [Factor: 48]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '725226005713';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('725226005713', 'Pulparindo 48pz', 7, 113.53) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'PAQUETE' (Factor: 48)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 48 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 48 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'PAQUETE', 48) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 130, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 130, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 0, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 0, 0);
    END IF;

    -- Row 396: 7506192507714 (Pz Amper Lata 473 Mora) - [Factor: 1]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '7506192507714';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('7506192507714', 'Pz Amper Lata 473 Mora', 14, 12.5) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'Pieza' (Factor: 1)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 1 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 1 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'Pieza', 1) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 14.6, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 14.6, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 216, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 216, 0);
    END IF;

    -- Row 397: 7506192507349 (Pz Amper Normal Energy 473) - [Factor: 1]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '7506192507349';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('7506192507349', 'Pz Amper Normal Energy 473', 14, 14.33) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'Pieza' (Factor: 1)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 1 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 1 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'Pieza', 1) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 15.83, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 15.83, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 168, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 168, 0);
    END IF;

    -- Row 398: 19836200218 (Pz Boing 500ml Durazno) - [Factor: 1]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '19836200218';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('19836200218', 'Pz Boing 500ml Durazno', 1, 10) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'Pieza' (Factor: 1)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 1 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 1 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'Pieza', 1) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 11.45, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 11.45, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 0, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 0, 0);
    END IF;

    -- Row 399: 7501039401149 (Pz Boing 500ml Guayaba) - [Factor: 1]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '7501039401149';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('7501039401149', 'Pz Boing 500ml Guayaba', 1, 11.97) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'Pieza' (Factor: 1)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 1 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 1 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'Pieza', 1) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 13.12, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 13.12, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 288, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 288, 0);
    END IF;

    -- Row 400: 7501039401132 (Pz Boing 500ml Mango) - [Factor: 1]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '7501039401132';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('7501039401132', 'Pz Boing 500ml Mango', 1, 11.1) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'Pieza' (Factor: 1)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 1 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 1 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'Pieza', 1) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 13.12, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 13.12, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 1032, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 1032, 0);
    END IF;

    -- Row 401: 75003159 (Pz Boing 500ml Manzana) - [Factor: 1]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '75003159';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('75003159', 'Pz Boing 500ml Manzana', 1, 10) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'Pieza' (Factor: 1)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 1 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 1 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'Pieza', 1) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 11.45, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 11.45, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 480, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 480, 0);
    END IF;

    -- Row 402: 75003180 (Pz Boing 500ml Uva) - [Factor: 1]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '75003180';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('75003180', 'Pz Boing 500ml Uva', 1, 12.36) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'Pieza' (Factor: 1)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 1 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 1 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'Pieza', 1) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 13.12, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 13.12, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 0, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 0, 0);
    END IF;

    -- Row 403: 75003111 (Pz Boing Guanabana 500ml) - [Factor: 1]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '75003111';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('75003111', 'Pz Boing Guanabana 500ml', 1, 11.08) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'Pieza' (Factor: 1)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 1 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 1 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'Pieza', 1) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 11.66, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 11.66, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 0, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 0, 0);
    END IF;

    -- Row 404: 19836103625 (Pz Boing Lata Guayaba 355) - [Factor: 1]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '19836103625';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('19836103625', 'Pz Boing Lata Guayaba 355', 1, 10) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'Pieza' (Factor: 1)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 1 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 1 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'Pieza', 1) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 11, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 11, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 0, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 0, 0);
    END IF;

    -- Row 405: 19836103618 (Pz Boing Lata Mango) - [Factor: 1]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '19836103618';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('19836103618', 'Pz Boing Lata Mango', 1, 10) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'Pieza' (Factor: 1)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 1 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 1 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'Pieza', 1) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 11, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 11, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 0, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 0, 0);
    END IF;

    -- Row 406: 19836103632 (Pz Boing Lata Manzana 355ml) - [Factor: 1]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '19836103632';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('19836103632', 'Pz Boing Lata Manzana 355ml', 1, 11) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'Pieza' (Factor: 1)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 1 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 1 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'Pieza', 1) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 11, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 11, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 0, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 0, 0);
    END IF;

    -- Row 407: 7501032485054 (Pz Caribe  Manzana Kiwi 300ml) - [Factor: 1]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '7501032485054';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('7501032485054', 'Pz Caribe  Manzana Kiwi 300ml', 10, 18.16) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'Pieza' (Factor: 1)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 1 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 1 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'Pieza', 1) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 18.16, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 18.16, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 16, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 16, 0);
    END IF;

    -- Row 408: 7501032485023 (Pz Caribe  Tinto300ml) - [Factor: 1]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '7501032485023';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('7501032485023', 'Pz Caribe  Tinto300ml', 10, 18.16) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'Pieza' (Factor: 1)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 1 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 1 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'Pieza', 1) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 19.16, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 19.16, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 88, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 88, 0);
    END IF;

    -- Row 409: 7501032485016 (Pz Caribe Durazno300ml) - [Factor: 1]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '7501032485016';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('7501032485016', 'Pz Caribe Durazno300ml', 10, 18) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'Pieza' (Factor: 1)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 1 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 1 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'Pieza', 1) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 19.16, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 19.16, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 10, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 10, 0);
    END IF;

    -- Row 410: 7501032485047 (Pz Caribe Fresa 300ml) - [Factor: 1]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '7501032485047';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('7501032485047', 'Pz Caribe Fresa 300ml', 10, 18.16) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'Pieza' (Factor: 1)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 1 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 1 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'Pieza', 1) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 19.16, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 19.16, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 99, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 99, 0);
    END IF;

    -- Row 411: 7501032485078 (Pz Caribe Mandarina) - [Factor: 1]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '7501032485078';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('7501032485078', 'Pz Caribe Mandarina', 10, 18.16) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'Pieza' (Factor: 1)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 1 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 1 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'Pieza', 1) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 19.16, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 19.16, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 88, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 88, 0);
    END IF;

    -- Row 412: 7501032485030 (Pz Caribe Mango Pia 300ml) - [Factor: 1]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '7501032485030';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('7501032485030', 'Pz Caribe Mango Pia 300ml', 10, 17.52) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'Pieza' (Factor: 1)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 1 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 1 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'Pieza', 1) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 19.16, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 19.16, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 4, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 4, 0);
    END IF;

    -- Row 413: 7501055313006 (Pz Ciel 10l) - [Factor: 1]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '7501055313006';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('7501055313006', 'Pz Ciel 10l', 10, 30) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'Pieza' (Factor: 1)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 1 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 1 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'Pieza', 1) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 40, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 40, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 0, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 0, 0);
    END IF;

    -- Row 414: 7501441615226 (Pz Durazno  3lt Jarrito) - [Factor: 1]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '7501441615226';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('7501441615226', 'Pz Durazno  3lt Jarrito', 1, 25) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'Pieza' (Factor: 1)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 1 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 1 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'Pieza', 1) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 26.87, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 26.87, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 16, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 16, 0);
    END IF;

    -- Row 415: 7501441629223 (Pz Durazno 2lt Pz) - [Factor: 1]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '7501441629223';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('7501441629223', 'Pz Durazno 2lt Pz', 1, 15.4) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'Pieza' (Factor: 1)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 1 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 1 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'Pieza', 1) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 18.76, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 18.76, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 72, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 72, 0);
    END IF;

    -- Row 416: 7501441604251 (Pz Grosella 2lt Jarrito) - [Factor: 1]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '7501441604251';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('7501441604251', 'Pz Grosella 2lt Jarrito', 1, 15.4) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'Pieza' (Factor: 1)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 1 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 1 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'Pieza', 1) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 21.5, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 21.5, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 0, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 0, 0);
    END IF;

    -- Row 417: 7501441615257 (Pz Grosella 3lt Jarrito) - [Factor: 1]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '7501441615257';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('7501441615257', 'Pz Grosella 3lt Jarrito', 1, 25) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'Pieza' (Factor: 1)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 1 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 1 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'Pieza', 1) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 30.5, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 30.5, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 0, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 0, 0);
    END IF;

    -- Row 418: 7501073839892 (Pz Limonada 2lt) - [Factor: 1]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '7501073839892';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('7501073839892', 'Pz Limonada 2lt', 1, 22.38) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'Pieza' (Factor: 1)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 1 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 1 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'Pieza', 1) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 26.25, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 26.25, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 123, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 123, 0);
    END IF;

    -- Row 419: 7501073839885 (Pz Limonada 600ml) - [Factor: 1]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '7501073839885';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('7501073839885', 'Pz Limonada 600ml', 1, 14.07) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'Pieza' (Factor: 1)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 1 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 1 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'Pieza', 1) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 16.25, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 16.25, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 372, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 372, 0);
    END IF;

    -- Row 420: 7501441615110 (Pz Mandarina 3lt Jarrito) - [Factor: 1]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '7501441615110';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('7501441615110', 'Pz Mandarina 3lt Jarrito', 1, 25) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'Pieza' (Factor: 1)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 1 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 1 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'Pieza', 1) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 26.87, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 26.87, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 3, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 3, 0);
    END IF;

    -- Row 421: 7501441610115 (Pz Mandarina 600 Ml) - [Factor: 1]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '7501441610115';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('7501441610115', 'Pz Mandarina 600 Ml', 1, 9.7) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'Pieza' (Factor: 1)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 1 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 1 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'Pieza', 1) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 11.66, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 11.66, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 0, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 0, 0);
    END IF;

    -- Row 422: 613008738808 (Pz Mango 680ml) - [Factor: 1]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '613008738808';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('613008738808', 'Pz Mango 680ml', 1, 15.2) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'Pieza' (Factor: 1)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 1 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 1 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'Pieza', 1) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 16, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 16, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 0, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 0, 0);
    END IF;

    -- Row 423: 7501031360024 (Pz Manzanita Sol 600 Ml) - [Factor: 1]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '7501031360024';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('7501031360024', 'Pz Manzanita Sol 600 Ml', 1, 10.69) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'Pieza' (Factor: 1)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 1 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 1 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'Pieza', 1) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 13.33, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 13.33, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 1, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 1, 0);
    END IF;

    -- Row 424: 7501031345052 (Pz Mirinda 600Ml) - [Factor: 1]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '7501031345052';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('7501031345052', 'Pz Mirinda 600Ml', 1, 10.69) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'Pieza' (Factor: 1)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 1 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 1 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'Pieza', 1) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 13.33, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 13.33, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 1, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 1, 0);
    END IF;

    -- Row 425: 7501441604114 (Pz Naranja 2L jarrito) - [Factor: 1]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '7501441604114';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('7501441604114', 'Pz Naranja 2L jarrito', 1, 15.4) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'Pieza' (Factor: 1)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 1 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 1 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'Pieza', 1) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 18.75, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 18.75, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 116, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 116, 0);
    END IF;

    -- Row 426: 7501073839861 (Pz Naranjada 2lt Pz) - [Factor: 1]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '7501073839861';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('7501073839861', 'Pz Naranjada 2lt Pz', 1, 22.24) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'Pieza' (Factor: 1)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 1 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 1 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'Pieza', 1) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 26.25, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 26.25, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 491, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 491, 0);
    END IF;

    -- Row 427: 7501073839854 (Pz Naranjada 600ml Pz) - [Factor: 1]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '7501073839854';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('7501073839854', 'Pz Naranjada 600ml Pz', 1, 14.58) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'Pieza' (Factor: 1)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 1 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 1 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'Pieza', 1) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 16.25, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 16.25, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 372, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 372, 0);
    END IF;

    -- Row 428: 7501441604121 (Pz Pia 2L Jarrito) - [Factor: 1]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '7501441604121';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('7501441604121', 'Pz Pia 2L Jarrito', 1, 15.4) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'Pieza' (Factor: 1)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 1 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 1 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'Pieza', 1) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 20, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 20, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 0, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 0, 0);
    END IF;

    -- Row 429: 7501441615127 (Pz Pia 3lt Jarrito) - [Factor: 1]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '7501441615127';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('7501441615127', 'Pz Pia 3lt Jarrito', 1, 26) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'Pieza' (Factor: 1)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 1 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 1 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'Pieza', 1) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 27.96, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 27.96, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 0, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 0, 0);
    END IF;

    -- Row 430: 7501441610122 (Pz Pia 600ml) - [Factor: 1]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '7501441610122';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('7501441610122', 'Pz Pia 600ml', 1, 9.7) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'Pieza' (Factor: 1)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 1 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 1 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'Pieza', 1) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 11.66, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 11.66, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 0, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 0, 0);
    END IF;

    -- Row 431: 7501073841949 (Pz Piada 2lt PZ) - [Factor: 1]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '7501073841949';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('7501073841949', 'Pz Piada 2lt PZ', 1, 22.81) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'Pieza' (Factor: 1)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 1 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 1 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'Pieza', 1) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 26.25, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 26.25, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 218, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 218, 0);
    END IF;

    -- Row 432: 7501073841925 (Pz Piada 600ml Pz) - [Factor: 1]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '7501073841925';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('7501073841925', 'Pz Piada 600ml Pz', 1, 13.96) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'Pieza' (Factor: 1)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 1 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 1 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'Pieza', 1) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 16.25, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 16.25, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 420, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 420, 0);
    END IF;

    -- Row 433: 7501441604213 (Pz Tamarindo 2lt Jarrito) - [Factor: 1]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '7501441604213';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('7501441604213', 'Pz Tamarindo 2lt Jarrito', 1, 15.4) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'Pieza' (Factor: 1)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 1 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 1 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'Pieza', 1) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 18.76, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 18.76, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 8, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 8, 0);
    END IF;

    -- Row 434: 7501441610214 (Pz Tamarindo 600ml) - [Factor: 1]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '7501441610214';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('7501441610214', 'Pz Tamarindo 600ml', 1, 9.7) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'Pieza' (Factor: 1)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 1 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 1 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'Pieza', 1) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 11.66, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 11.66, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 0, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 0, 0);
    END IF;

    -- Row 435: 7501441610412 (Pz Tutifruti 600ml) - [Factor: 1]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '7501441610412';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('7501441610412', 'Pz Tutifruti 600ml', 1, 9.7) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'Pieza' (Factor: 1)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 1 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 1 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'Pieza', 1) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 11.66, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 11.66, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 0, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 0, 0);
    END IF;

    -- Row 436: 7506192508711 (Pz Vive Lata 473 Xtreme) - [Factor: 1]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '7506192508711';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('7506192508711', 'Pz Vive Lata 473 Xtreme', 14, 12.5) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'Pieza' (Factor: 1)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 1 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 1 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'Pieza', 1) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 14.6, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 14.6, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 12, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 12, 0);
    END IF;

    -- Row 437: 7501031310012 (1 Pepsi 600ml Pieza) - [Factor: 1]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '7501031310012';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('7501031310012', '1 Pepsi 600ml Pieza', 1, 10.67) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'Pieza' (Factor: 1)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 1 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 1 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'Pieza', 1) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 13.33, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 13.33, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 0, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 0, 0);
    END IF;

    -- Row 438: SPRITEVIDRIO (REJA DE SPRITE VIDRIO) - [Factor: 1]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = 'SPRITEVIDRIO';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('SPRITEVIDRIO', 'REJA DE SPRITE VIDRIO', 1, 233) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'Pieza' (Factor: 1)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 1 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 1 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'Pieza', 1) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 260, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 260, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 1, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 1, 0);
    END IF;

    -- Row 439: 7501198355970 (Rc Cola 2l) - [Factor: 1]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '7501198355970';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('7501198355970', 'Rc Cola 2l', 1, 157) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'Pieza' (Factor: 1)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 1 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 1 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'Pieza', 1) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 170, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 170, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 0, cantidad_minima = 1 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 0, 1);
    END IF;

    -- Row 440: 9002490100490 (Red Bull Energy Drink 4pack) - [Factor: 1]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '9002490100490';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('9002490100490', 'Red Bull Energy Drink 4pack', 14, 132) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'Pieza' (Factor: 1)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 1 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 1 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'Pieza', 1) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 145, precio_mayoreo = 141.67 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 145, 141.67);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 54, cantidad_minima = 1 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 54, 1);
    END IF;

    -- Row 441: 7501055304745 (1 Coca  3L Desechable Pieza) - [Factor: 1]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '7501055304745';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('7501055304745', '1 Coca  3L Desechable Pieza', 1, 37.64) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'Pieza' (Factor: 1)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 1 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 1 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'Pieza', 1) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 39.37, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 39.37, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 168, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 168, 0);
    END IF;

    -- Row 442: 75007614 (1 Coca 600 ml) - [Factor: 1]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '75007614';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('75007614', '1 Coca 600 ml', 1, 16.45) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'Pieza' (Factor: 1)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 1 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 1 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'Pieza', 1) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 17.83, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 17.83, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 1792, cantidad_minima = 10 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 1792, 10);
    END IF;

    -- Row 443: 7501055304653 (1 Delawere Punch 600ml) - [Factor: 1]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '7501055304653';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('7501055304653', '1 Delawere Punch 600ml', 1, 12.66) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'Pieza' (Factor: 1)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 1 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 1 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'Pieza', 1) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 13.75, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 13.75, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 60, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 60, 0);
    END IF;

    -- Row 444: 7501055300181 (1 Fanta 355ml) - [Factor: 1]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '7501055300181';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('7501055300181', '1 Fanta 355ml', 1, 7.9) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'Pieza' (Factor: 1)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 1 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 1 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'Pieza', 1) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 8.75, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 8.75, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 0, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 0, 0);
    END IF;

    -- Row 445: 7501055310586 (1 Fanta 3lt Fresa) - [Factor: 1]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '7501055310586';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('7501055310586', '1 Fanta 3lt Fresa', 1, 30) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'Pieza' (Factor: 1)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 1 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 1 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'Pieza', 1) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 31.25, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 31.25, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 24, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 24, 0);
    END IF;

    -- Row 446: 7501055304790 (1 Fanta 3lt Naranja) - [Factor: 1]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '7501055304790';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('7501055304790', '1 Fanta 3lt Naranja', 1, 30) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'Pieza' (Factor: 1)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 1 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 1 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'Pieza', 1) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 33.8, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 33.8, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 170, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 170, 0);
    END IF;

    -- Row 447: 7501055317455 (1 Fanta 3lt Pia) - [Factor: 1]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '7501055317455';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('7501055317455', '1 Fanta 3lt Pia', 1, 30) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'Pieza' (Factor: 1)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 1 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 1 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'Pieza', 1) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 31.25, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 31.25, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 24, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 24, 0);
    END IF;

    -- Row 448: 7501055317462 (1 Fanta 3lt Uva) - [Factor: 1]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '7501055317462';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('7501055317462', '1 Fanta 3lt Uva', 1, 30) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'Pieza' (Factor: 1)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 1 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 1 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'Pieza', 1) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 31.25, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 31.25, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 23, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 23, 0);
    END IF;

    -- Row 449: 7501055305230 (1 Fanta Fresa 600ml) - [Factor: 1]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '7501055305230';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('7501055305230', '1 Fanta Fresa 600ml', 1, 13.38) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'Pieza' (Factor: 1)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 1 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 1 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'Pieza', 1) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 16.25, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 16.25, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 60, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 60, 0);
    END IF;

    -- Row 450: 7501055303779 (1 Fanta Naranja 600ml) - [Factor: 1]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '7501055303779';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('7501055303779', '1 Fanta Naranja 600ml', 1, 12.8) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'Pieza' (Factor: 1)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 1 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 1 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'Pieza', 1) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 15, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 15, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 0, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 0, 0);
    END IF;

    -- Row 451: 7501055304813 (1 Fresca 3lt) - [Factor: 1]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '7501055304813';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('7501055304813', '1 Fresca 3lt', 1, 27) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'Pieza' (Factor: 1)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 1 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 1 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'Pieza', 1) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 31.25, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 31.25, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 120, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 120, 0);
    END IF;

    -- Row 452: 7501055303786 (1 Fresca 600ml) - [Factor: 1]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '7501055303786';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('7501055303786', '1 Fresca 600ml', 1, 12.8) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'Pieza' (Factor: 1)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 1 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 1 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'Pieza', 1) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 13.75, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 13.75, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 840, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 840, 0);
    END IF;

    -- Row 453: 7501055330812 (1 Pz Valle Frut 3lt) - [Factor: 1]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '7501055330812';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('7501055330812', '1 Pz Valle Frut 3lt', 1, 26.77) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'Pieza' (Factor: 1)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 1 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 1 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'Pieza', 1) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 28.75, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 28.75, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 32, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 32, 0);
    END IF;

    -- Row 454: 7501055308330 (1 Senzao 600ml) - [Factor: 1]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '7501055308330';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('7501055308330', '1 Senzao 600ml', 1, 14.9) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'Pieza' (Factor: 1)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 1 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 1 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'Pieza', 1) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 16.25, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 16.25, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 0, cantidad_minima = 12 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 0, 12);
    END IF;

    -- Row 455: 7501055340422 (1 Sidral 3lt) - [Factor: 1]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '7501055340422';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('7501055340422', '1 Sidral 3lt', 1, 30) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'Pieza' (Factor: 1)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 1 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 1 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'Pieza', 1) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 31.25, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 31.25, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 0, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 0, 0);
    END IF;

    -- Row 456: 7501055339983 (1 Sidral 600ml) - [Factor: 1]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '7501055339983';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('7501055339983', '1 Sidral 600ml', 1, 12.8) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'Pieza' (Factor: 1)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 1 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 1 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'Pieza', 1) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 13.75, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 13.75, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 312, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 312, 0);
    END IF;

    -- Row 457: 7501055302246 (1 Sprite 355ml) - [Factor: 1]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '7501055302246';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('7501055302246', '1 Sprite 355ml', 1, 7.96) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'Pieza' (Factor: 1)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 1 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 1 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'Pieza', 1) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 8.75, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 8.75, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 36, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 36, 0);
    END IF;

    -- Row 458: 7501055343263 (1 Sprite 355ml) - [Factor: 1]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '7501055343263';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('7501055343263', '1 Sprite 355ml', 1, 7.96) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'Pieza' (Factor: 1)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 1 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 1 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'Pieza', 1) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 8.75, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 8.75, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 0, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 0, 0);
    END IF;

    -- Row 459: 7501055304806 (1 Sprite 3lt) - [Factor: 1]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '7501055304806';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('7501055304806', '1 Sprite 3lt', 1, 30) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'Pieza' (Factor: 1)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 1 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 1 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'Pieza', 1) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 31.25, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 31.25, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 8, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 8, 0);
    END IF;

    -- Row 460: 7501055305629 (1 Sprite 600ml) - [Factor: 1]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '7501055305629';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('7501055305629', '1 Sprite 600ml', 1, 12.8) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'Pieza' (Factor: 1)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 1 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 1 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'Pieza', 1) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 13.33, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 13.33, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 408, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 408, 0);
    END IF;

    -- Row 461: 7501055342716 (1 Valle Frut 600ml Guayaba) - [Factor: 1]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '7501055342716';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('7501055342716', '1 Valle Frut 600ml Guayaba', 1, 14.16) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'Pieza' (Factor: 1)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 1 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 1 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'Pieza', 1) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 15.41, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 15.41, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 0, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 0, 0);
    END IF;

    -- Row 462: 7501055380862 (1 Valle Frut 600ml Mandarina) - [Factor: 1]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '7501055380862';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('7501055380862', '1 Valle Frut 600ml Mandarina', 1, 11.4) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'Pieza' (Factor: 1)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 1 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 1 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'Pieza', 1) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 12.5, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 12.5, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 0, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 0, 0);
    END IF;

    -- Row 463: 7501055337477 (1 Valle Frut 600ml Manzana) - [Factor: 1]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '7501055337477';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('7501055337477', '1 Valle Frut 600ml Manzana', 1, 11.4) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'Pieza' (Factor: 1)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 1 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 1 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'Pieza', 1) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 15.41, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 15.41, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 0, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 0, 0);
    END IF;

    -- Row 464: 7501055330683 (1 Valle frut 600ml Naranaja) - [Factor: 1]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '7501055330683';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('7501055330683', '1 Valle frut 600ml Naranaja', 1, 14.16) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'Pieza' (Factor: 1)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 1 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 1 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'Pieza', 1) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 15, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 15, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 144, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 144, 0);
    END IF;

    -- Row 465: 659190000989 (Ricaleta) - [Factor: 1]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '659190000989';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('659190000989', 'Ricaleta', 7, 110.5) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'Pieza' (Factor: 1)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 1 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 1 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'Pieza', 1) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 125, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 125, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 0, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 0, 0);
    END IF;

    -- Row 466: 7501011110731 (Rokaleta) - [Factor: 1]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '7501011110731';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('7501011110731', 'Rokaleta', 7, 184) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'Pieza' (Factor: 1)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 1 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 1 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'Pieza', 1) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 200, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 200, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 2, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 2, 0);
    END IF;

    -- Row 467: 7500810028407 (Runners Blue Heat 72g P`z) - [Factor: 1]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '7500810028407';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('7500810028407', 'Runners Blue Heat 72g P`z', 7, 12.09) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'Pieza' (Factor: 1)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 1 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 1 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'Pieza', 1) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 14, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 14, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 0, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 0, 0);
    END IF;

    -- Row 468: 7500810027837 (Runners Chile Limon 72gr) - [Factor: 1]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '7500810027837';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('7500810027837', 'Runners Chile Limon 72gr', 7, 12.09) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'Pieza' (Factor: 1)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 1 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 1 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'Pieza', 1) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 14, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 14, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 1, cantidad_minima = 1 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 1, 1);
    END IF;

    -- Row 469: 7500810027820 (Runners Fuego 72g Pz) - [Factor: 1]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '7500810027820';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('7500810027820', 'Runners Fuego 72g Pz', 7, 12.09) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'Pieza' (Factor: 1)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 1 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 1 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'Pieza', 1) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 14, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 14, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 2, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 2, 0);
    END IF;

    -- Row 470: 7501071120176 (SQUIRT 1.5L CON 12PZ) - [Factor: 12]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '7501071120176';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('7501071120176', 'SQUIRT 1.5L CON 12PZ', 1, 237.86) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'PAQUETE' (Factor: 12)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 12 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 12 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'PAQUETE', 12) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 270, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 270, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 1, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 1, 0);
    END IF;

    -- Row 471: 7501055346882 (Sabor 2lt Coca) - [Factor: 1]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '7501055346882';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('7501055346882', 'Sabor 2lt Coca', 1, 191) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'Pieza' (Factor: 1)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 1 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 1 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'Pieza', 1) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 220, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 220, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 36, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 36, 0);
    END IF;

    -- Row 472: SURTIDO355ML12PZ (Sabor 355ml Surtido 12pz) - [Factor: 12]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = 'SURTIDO355ML12PZ';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('SURTIDO355ML12PZ', 'Sabor 355ml Surtido 12pz', 1, 95.55) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'PAQUETE' (Factor: 12)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 12 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 12 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'PAQUETE', 12) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 110, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 110, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 5, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 5, 0);
    END IF;

    -- Row 473: SABOR 3LT (Sabor 3lt Coca Con 8pz Naranja) - [Factor: 8]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = 'SABOR 3LT';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('SABOR 3LT', 'Sabor 3lt Coca Con 8pz Naranja', 1, 220) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'PAQUETE' (Factor: 8)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 8 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 8 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'PAQUETE', 8) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 280, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 280, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 27, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 27, 0);
    END IF;

    -- Row 474: SABOR3LTPINA (Sabor 3lt Coca Con 8pz Pia) - [Factor: 8]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = 'SABOR3LTPINA';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('SABOR3LTPINA', 'Sabor 3lt Coca Con 8pz Pia', 1, 217) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'PAQUETE' (Factor: 8)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 8 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 8 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'PAQUETE', 8) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 250, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 250, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 0, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 0, 0);
    END IF;

    -- Row 475: SABOR600MLCONFRESA (Sabor 600ml Coca 12pz Fresa) - [Factor: 12]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = 'SABOR600MLCONFRESA';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('SABOR600MLCONFRESA', 'Sabor 600ml Coca 12pz Fresa', 1, 163) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'PAQUETE' (Factor: 12)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 12 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 12 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'PAQUETE', 12) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 195, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 195, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 0, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 0, 0);
    END IF;

    -- Row 476: SABORES600MLNARANJA (Sabor 600ml Coca 12pz Naranja) - [Factor: 12]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = 'SABORES600MLNARANJA';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('SABORES600MLNARANJA', 'Sabor 600ml Coca 12pz Naranja', 1, 149) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'PAQUETE' (Factor: 12)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 12 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 12 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'PAQUETE', 12) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 205, precio_mayoreo = 175 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 205, 175);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 11, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 11, 0);
    END IF;

    -- Row 477: SIDRAL (Sabor Coca Vidrio 355) - [Factor: 1]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = 'SIDRAL';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('SIDRAL', 'Sabor Coca Vidrio 355', 1, 267.5) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'Pieza' (Factor: 1)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 1 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 1 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'Pieza', 1) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 305, precio_mayoreo = 280 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 305, 280);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 3, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 3, 0);
    END IF;

    -- Row 478: 7501055378463 (Sabor Lata Coca Con 12pz) - [Factor: 12]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '7501055378463';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('7501055378463', 'Sabor Lata Coca Con 12pz', 1, 182) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'PAQUETE' (Factor: 12)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 12 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 12 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'PAQUETE', 12) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 225, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 225, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 36, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 36, 0);
    END IF;

    -- Row 479: 7501055371075 (Sabores Coca Medio Litro Vidrio Ret.) - [Factor: 1]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '7501055371075';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('7501055371075', 'Sabores Coca Medio Litro Vidrio Ret.', 1, 267.5) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'Pieza' (Factor: 1)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 1 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 1 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'Pieza', 1) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 320, precio_mayoreo = 280 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 320, 280);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 0, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 0, 0);
    END IF;

    -- Row 480: 7500478018536 (Sabrinegocio) - [Factor: 1]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '7500478018536';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('7500478018536', 'Sabrinegocio', 2, 383.62) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'Pieza' (Factor: 1)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 1 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 1 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'Pieza', 1) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 405, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 405, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 1, cantidad_minima = 5 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 1, 5);
    END IF;

    -- Row 481: 97339000238 (Salsa Valentina 6pz) - [Factor: 6]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '97339000238';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('97339000238', 'Salsa Valentina 6pz', 2, 81) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'PAQUETE' (Factor: 6)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 6 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 6 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'PAQUETE', 6) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 90, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 90, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 4, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 4, 0);
    END IF;

    -- Row 482: 7501505630073 (Sangria Cacera 600Ml) - [Factor: 1]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '7501505630073';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('7501505630073', 'Sangria Cacera 600Ml', 1, 160.24) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'Pieza' (Factor: 1)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 1 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 1 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'Pieza', 1) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 180, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 180, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 0, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 0, 0);
    END IF;

    -- Row 483: 7501022013694 (Sangria Casera Vidrio 355ml) - [Factor: 1]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '7501022013694';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('7501022013694', 'Sangria Casera Vidrio 355ml', 1, 292) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'Pieza' (Factor: 1)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 1 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 1 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'Pieza', 1) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 310, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 310, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 0, cantidad_minima = 1 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 0, 1);
    END IF;

    -- Row 484: 7501055377022 (Senzao 2lt 8pz) - [Factor: 8]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '7501055377022';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('7501055377022', 'Senzao 2lt 8pz', 1, 165) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'PAQUETE' (Factor: 8)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 8 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 8 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'PAQUETE', 8) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 185, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 185, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 0, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 0, 0);
    END IF;

    -- Row 485: 7501055368600 (Sidral 2.5 Retornable Con 8pz) - [Factor: 8]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '7501055368600';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('7501055368600', 'Sidral 2.5 Retornable Con 8pz', 1, 150) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'PAQUETE' (Factor: 8)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 8 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 8 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'PAQUETE', 8) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 170, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 170, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 0, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 0, 0);
    END IF;

    -- Row 486: 7501055367412 (Sidral 2l Pera Con 8pz) - [Factor: 8]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '7501055367412';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('7501055367412', 'Sidral 2l Pera Con 8pz', 1, 139.24) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'PAQUETE' (Factor: 8)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 8 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 8 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'PAQUETE', 8) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 185, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 185, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 0, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 0, 0);
    END IF;

    -- Row 487: 7501055376681 (Sidral 2lt Kiwi Fresa Con 8pz) - [Factor: 8]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '7501055376681';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('7501055376681', 'Sidral 2lt Kiwi Fresa Con 8pz', 1, 139.24) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'PAQUETE' (Factor: 8)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 8 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 8 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'PAQUETE', 8) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 185, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 185, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 0, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 0, 0);
    END IF;

    -- Row 488: 7501055365135 (Sidral 2lt Mandarina 8 Pz) - [Factor: 8]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '7501055365135';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('7501055365135', 'Sidral 2lt Mandarina 8 Pz', 1, 166.04) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'PAQUETE' (Factor: 8)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 8 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 8 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'PAQUETE', 8) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 185, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 185, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 0, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 0, 0);
    END IF;

    -- Row 489: SIDRAL2LSDO (Sidral 2lt Surtido Con 8) - [Factor: 8]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = 'SIDRAL2LSDO';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('SIDRAL2LSDO', 'Sidral 2lt Surtido Con 8', 1, 166) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'PAQUETE' (Factor: 8)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 8 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 8 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'PAQUETE', 8) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 185, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 185, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 0, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 0, 0);
    END IF;

    -- Row 490: SIDRAL 600ML (Sidral 600ml Con 12 Pz) - [Factor: 12]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = 'SIDRAL 600ML';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('SIDRAL 600ML', 'Sidral 600ml Con 12 Pz', 1, 149) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'PAQUETE' (Factor: 12)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 12 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 12 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'PAQUETE', 12) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 205, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 205, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 0, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 0, 0);
    END IF;

    -- Row 491: 7501055364077 (Sidral Durazno 2lt 8pz) - [Factor: 8]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '7501055364077';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('7501055364077', 'Sidral Durazno 2lt 8pz', 1, 157.5) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'PAQUETE' (Factor: 8)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 8 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 8 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'PAQUETE', 8) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 185, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 185, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 30, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 30, 0);
    END IF;

    -- Row 492: 7501055363162 (Sidral Lata De 355 12 Pz) - [Factor: 12]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '7501055363162';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('7501055363162', 'Sidral Lata De 355 12 Pz', 1, 182) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'PAQUETE' (Factor: 12)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 12 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 12 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'PAQUETE', 12) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 195, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 195, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 0, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 0, 0);
    END IF;

    -- Row 493: 7502226819761 (Skwinkles Rellenos) - [Factor: 1]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '7502226819761';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('7502226819761', 'Skwinkles Rellenos', 7, 172.88) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'Pieza' (Factor: 1)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 1 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 1 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'Pieza', 1) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 185, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 185, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 0, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 0, 0);
    END IF;

    -- Row 494: 725181628101 (Skwinkles Salsagheti 24pz) - [Factor: 24]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '725181628101';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('725181628101', 'Skwinkles Salsagheti 24pz', 7, 172.88) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'PAQUETE' (Factor: 24)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 24 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 24 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'PAQUETE', 24) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 185, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 185, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 1, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 1, 0);
    END IF;

    -- Row 495: SPRITE600ML CON 12PZ (Sprite 600ml Con 12pz Desechable) - [Factor: 12]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = 'SPRITE600ML CON 12PZ';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('SPRITE600ML CON 12PZ', 'Sprite 600ml Con 12pz Desechable', 1, 149) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'PAQUETE' (Factor: 12)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 12 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 12 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'PAQUETE', 12) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 205, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 205, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 0, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 0, 0);
    END IF;

    -- Row 496: 7501071120077 (Squirt  2L Desechable Con 8pz) - [Factor: 8]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '7501071120077';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('7501071120077', 'Squirt  2L Desechable Con 8pz', 1, 190) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'PAQUETE' (Factor: 8)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 8 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 8 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'PAQUETE', 8) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 210, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 210, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 9, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 9, 0);
    END IF;

    -- Row 497: 7501071120305 (Squirt  3lt Con 6pz) - [Factor: 6]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '7501071120305';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('7501071120305', 'Squirt  3lt Con 6pz', 1, 184) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'PAQUETE' (Factor: 6)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 6 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 6 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'PAQUETE', 6) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 215, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 215, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 2, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 2, 0);
    END IF;

    -- Row 498: 7501071120411 (Squirt 2.5lt Con 8 Pz Desechable) - [Factor: 8]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '7501071120411';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('7501071120411', 'Squirt 2.5lt Con 8 Pz Desechable', 1, 202.5) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'PAQUETE' (Factor: 8)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 8 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 8 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'PAQUETE', 8) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 225, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 225, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 2, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 2, 0);
    END IF;

    -- Row 499: 7501071120664 (Squirt 400ml Con 12 Pz) - [Factor: 12]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '7501071120664';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('7501071120664', 'Squirt 400ml Con 12 Pz', 1, 110.7) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'PAQUETE' (Factor: 12)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 12 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 12 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'PAQUETE', 12) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 125, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 125, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 11, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 11, 0);
    END IF;

    -- Row 500: 7501071120183 (Squirt 600 Ml Con 12 Pz) - [Factor: 12]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '7501071120183';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('7501071120183', 'Squirt 600 Ml Con 12 Pz', 1, 173.83) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'PAQUETE' (Factor: 12)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 12 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 12 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'PAQUETE', 12) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 195, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 195, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 92, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 92, 0);
    END IF;

    -- Row 501: 7501071122040 (Squirt Lata 355ml Con 12 Pz) - [Factor: 12]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '7501071122040';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('7501071122040', 'Squirt Lata 355ml Con 12 Pz', 1, 156) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'PAQUETE' (Factor: 12)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 12 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 12 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'PAQUETE', 12) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 175, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 175, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 44, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 44, 0);
    END IF;

    -- Row 502: 7501071121692 (Squirt Pepino Limon 600ml 12pz) - [Factor: 12]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '7501071121692';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('7501071121692', 'Squirt Pepino Limon 600ml 12pz', 1, 175.5) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'PAQUETE' (Factor: 12)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 12 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 12 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'PAQUETE', 12) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 195, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 195, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 0, cantidad_minima = 1 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 0, 1);
    END IF;

    -- Row 503: SQUIRTVIDRIO (Squirt Vidrio Con 24pz Retornable) - [Factor: 24]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = 'SQUIRTVIDRIO';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('SQUIRTVIDRIO', 'Squirt Vidrio Con 24pz Retornable', 1, 279) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'PAQUETE' (Factor: 24)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 24 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 24 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'PAQUETE', 24) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 300, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 300, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 1, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 1, 0);
    END IF;

    -- Row 504: 876548643 (Suerox Surtd 12pz 630ml) - [Factor: 12]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '876548643';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('876548643', 'Suerox Surtd 12pz 630ml', 1, 165) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'PAQUETE' (Factor: 12)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 12 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 12 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'PAQUETE', 12) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 190, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 190, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 9, cantidad_minima = 1 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 9, 1);
    END IF;

    -- Row 505: 75022474292150 (Surtichidas 35pz) - [Factor: 35]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '75022474292150';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('75022474292150', 'Surtichidas 35pz', 7, 289) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'PAQUETE' (Factor: 35)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 35 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 35 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'PAQUETE', 35) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 310, precio_mayoreo = 305 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 310, 305);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 0, cantidad_minima = 1 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 0, 1);
    END IF;

    -- Row 506: 7500810028353 (Takis Caja Surtida 70gr) - [Factor: 1]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '7500810028353';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('7500810028353', 'Takis Caja Surtida 70gr', 7, 15.11) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'Pieza' (Factor: 1)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 1 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 1 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'Pieza', 1) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 17, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 17, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 214, cantidad_minima = 1 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 214, 1);
    END IF;

    -- Row 507: 634130104873 (Tamborines 200pz) - [Factor: 200]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '634130104873';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('634130104873', 'Tamborines 200pz', 7, 101.25) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'PAQUETE' (Factor: 200)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 200 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 200 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'PAQUETE', 200) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 120, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 120, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 1, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 1, 0);
    END IF;

    -- Row 508: 7501055379866 (Topo Chico Hard Seltzer 6pz) - [Factor: 6]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '7501055379866';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('7501055379866', 'Topo Chico Hard Seltzer 6pz', 10, 98) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'PAQUETE' (Factor: 6)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 6 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 6 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'PAQUETE', 6) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 115, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 115, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 3, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 3, 0);
    END IF;

    -- Row 509: 21136010541 (Topochico De 600Ml De 12 Pz) - [Factor: 12]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '21136010541';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('21136010541', 'Topochico De 600Ml De 12 Pz', 1, 178.5) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'PAQUETE' (Factor: 12)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 12 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 12 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'PAQUETE', 12) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 205, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 205, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 1, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 1, 0);
    END IF;

    -- Row 510: 7501063500542 (Tutsi Pop Con 80 Pz) - [Factor: 80]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '7501063500542';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('7501063500542', 'Tutsi Pop Con 80 Pz', 7, 224) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'PAQUETE' (Factor: 80)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 80 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 80 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'PAQUETE', 80) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 250, precio_mayoreo = 245 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 250, 245);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 0, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 0, 0);
    END IF;

    -- Row 511: 7501064194504 (Ultra 355ml Bote 24pz) - [Factor: 24]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '7501064194504';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('7501064194504', 'Ultra 355ml Bote 24pz', 10, 428) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'PAQUETE' (Factor: 24)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 24 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 24 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'PAQUETE', 24) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 445, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 445, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 0, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 0, 0);
    END IF;

    -- Row 512: 7503024460896 (Ultra 710ml 12pz Laton) - [Factor: 12]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '7503024460896';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('7503024460896', 'Ultra 710ml 12pz Laton', 10, 436.5) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'PAQUETE' (Factor: 12)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 12 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 12 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'PAQUETE', 12) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 450, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 450, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 0, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 0, 0);
    END IF;

    -- Row 513: 7503034941361 (Ultra 850ml 12pz Decs) - [Factor: 12]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '7503034941361';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('7503034941361', 'Ultra 850ml 12pz Decs', 10, 480) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'PAQUETE' (Factor: 12)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 12 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 12 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'PAQUETE', 12) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 500, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 500, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 0, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 0, 0);
    END IF;

    -- Row 514: 7501064198168 (Ultra Vidrio 355ml 24pz) - [Factor: 24]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '7501064198168';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('7501064198168', 'Ultra Vidrio 355ml 24pz', 10, 421) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'PAQUETE' (Factor: 24)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 24 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 24 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'PAQUETE', 24) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 435, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 435, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 3, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 3, 0);
    END IF;

    -- Row 515: 75752803663 (VALENTONES FUEGO 60GR) - [Factor: 1]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '75752803663';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('75752803663', 'VALENTONES FUEGO 60GR', 7, 12.09) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'Pieza' (Factor: 1)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 1 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 1 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'Pieza', 1) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 15, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 15, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 3, cantidad_minima = 1 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 3, 1);
    END IF;

    -- Row 516: 7501055379484 (VALLE FIZZ 600ML 6 PZ) - [Factor: 6]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '7501055379484';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('7501055379484', 'VALLE FIZZ 600ML 6 PZ', 1, 75) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'PAQUETE' (Factor: 6)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 6 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 6 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'PAQUETE', 6) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 90, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 90, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 20, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 20, 0);
    END IF;

    -- Row 517: 7501055381371 (VALLE GUAYABA 500ML 3PZ) - [Factor: 3]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '7501055381371';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('7501055381371', 'VALLE GUAYABA 500ML 3PZ', 1, 30.6) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'PAQUETE' (Factor: 3)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 3 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 3 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'PAQUETE', 3) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 40, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 40, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 72, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 72, 0);
    END IF;

    -- Row 518: 7501055381364 (VALLE MANGO 500ML 3 PZ) - [Factor: 3]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '7501055381364';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('7501055381364', 'VALLE MANGO 500ML 3 PZ', 1, 30) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'PAQUETE' (Factor: 3)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 3 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 3 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'PAQUETE', 3) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 40, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 40, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 15, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 15, 0);
    END IF;

    -- Row 519: 7501055383047 (VALLE PULPY 237ML 16PZ SURTD) - [Factor: 16]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '7501055383047';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('7501055383047', 'VALLE PULPY 237ML 16PZ SURTD', 1, 100) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'PAQUETE' (Factor: 16)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 16 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 16 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'PAQUETE', 16) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 115, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 115, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 10, cantidad_minima = 1 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 10, 1);
    END IF;

    -- Row 520: 7501064195334 (VICKY CHELADA 473ML CON 24 PZ) - [Factor: 24]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '7501064195334';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('7501064195334', 'VICKY CHELADA 473ML CON 24 PZ', 10, 445) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'PAQUETE' (Factor: 24)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 24 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 24 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'PAQUETE', 24) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 510, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 510, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 1, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 1, 0);
    END IF;

    -- Row 521: 7506192510752 (VIVE 100 AMARILLO 600ML 24PZ) - [Factor: 24]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '7506192510752';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('7506192510752', 'VIVE 100 AMARILLO 600ML 24PZ', 14, 275) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'PAQUETE' (Factor: 24)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 24 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 24 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'PAQUETE', 24) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 295, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 295, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 0, cantidad_minima = 1 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 0, 1);
    END IF;

    -- Row 522: 7506192510745 (VIVE 100 MORADO 600ML 24PZ) - [Factor: 24]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '7506192510745';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('7506192510745', 'VIVE 100 MORADO 600ML 24PZ', 14, 275) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'PAQUETE' (Factor: 24)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 24 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 24 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'PAQUETE', 24) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 295, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 295, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 0, cantidad_minima = 1 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 0, 1);
    END IF;

    -- Row 523: 7501020556988 (Vainilla Yomy) - [Factor: 1]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '7501020556988';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('7501020556988', 'Vainilla Yomy', 9, 6.25) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'Pieza' (Factor: 1)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 1 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 1 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'Pieza', 1) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 7.22, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 7.22, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 0, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 0, 0);
    END IF;

    -- Row 524: 7501055376537 (Valle 1lt Surtido 6pz) - [Factor: 6]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '7501055376537';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('7501055376537', 'Valle 1lt Surtido 6pz', 1, 124.24) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'PAQUETE' (Factor: 6)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 6 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 6 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'PAQUETE', 6) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 145, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 145, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 14, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 14, 0);
    END IF;

    -- Row 525: 32239058781 (Valle 200ml Surtido Con 40pz) - [Factor: 40]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '32239058781';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('32239058781', 'Valle 200ml Surtido Con 40pz', 1, 200) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'PAQUETE' (Factor: 40)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 40 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 40 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'PAQUETE', 40) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 220, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 220, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 10, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 10, 0);
    END IF;

    -- Row 526: 7501055380886 (Valle 2lt Mandarina 2lt 4pz) - [Factor: 4]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '7501055380886';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('7501055380886', 'Valle 2lt Mandarina 2lt 4pz', 1, 45) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'PAQUETE' (Factor: 4)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 4 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 4 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'PAQUETE', 4) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 75, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 75, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 0, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 0, 0);
    END IF;

    -- Row 527: 17501055356758 (Valle Carton De 1lt Durazno 12pz) - [Factor: 12]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '17501055356758';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('17501055356758', 'Valle Carton De 1lt Durazno 12pz', 1, 192) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'PAQUETE' (Factor: 12)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 12 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 12 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'PAQUETE', 12) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 210, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 210, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 1, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 1, 0);
    END IF;

    -- Row 528: 7501055382590 (Valle Fizz 230ml Surtido 12pz) - [Factor: 12]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '7501055382590';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('7501055382590', 'Valle Fizz 230ml Surtido 12pz', 1, 57.33) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'PAQUETE' (Factor: 12)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 12 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 12 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'PAQUETE', 12) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 70, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 70, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 1, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 1, 0);
    END IF;

    -- Row 529: 7501055379538 (Valle Fizz 2lt Con 8pz Limonada) - [Factor: 8]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '7501055379538';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('7501055379538', 'Valle Fizz 2lt Con 8pz Limonada', 1, 140) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'PAQUETE' (Factor: 8)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 8 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 8 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'PAQUETE', 8) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 180, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 180, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 0, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 0, 0);
    END IF;

    -- Row 530: 7501055379491 (Valle Fizz 2lt Naranaja 8pz) - [Factor: 8]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '7501055379491';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('7501055379491', 'Valle Fizz 2lt Naranaja 8pz', 1, 178.36) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'PAQUETE' (Factor: 8)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 8 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 8 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'PAQUETE', 8) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 185, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 185, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 11, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 11, 0);
    END IF;

    -- Row 531: 7501055368617 (Valle Frut 2.5 Retornable Con 8pz) - [Factor: 8]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '7501055368617';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('7501055368617', 'Valle Frut 2.5 Retornable Con 8pz', 1, 150) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'PAQUETE' (Factor: 8)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 8 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 8 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'PAQUETE', 8) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 170, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 170, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 0, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 0, 0);
    END IF;

    -- Row 532: 7501055330461 (Valle Frut 2l Con 8pz) - [Factor: 8]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '7501055330461';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('7501055330461', 'Valle Frut 2l Con 8pz', 1, 178.8) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'PAQUETE' (Factor: 8)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 8 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 8 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'PAQUETE', 8) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 215, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 215, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 39, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 39, 0);
    END IF;

    -- Row 533: 7501055342198 (Valle Frut 355ml Con 12pz) - [Factor: 12]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '7501055342198';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('7501055342198', 'Valle Frut 355ml Con 12pz', 1, 62.48) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'PAQUETE' (Factor: 12)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 12 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 12 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'PAQUETE', 12) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 85, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 85, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 8, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 8, 0);
    END IF;

    -- Row 534: 7501055334018 (Valle Mega Lata 453ml Con 6pz Durazno) - [Factor: 6]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '7501055334018';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('7501055334018', 'Valle Mega Lata 453ml Con 6pz Durazno', 1, 80.75) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'PAQUETE' (Factor: 6)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 6 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 6 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'PAQUETE', 6) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 105, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 105, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 8, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 8, 0);
    END IF;

    -- Row 535: 7501055334001 (Valle Mega Lata Mango 453ml  6pz) - [Factor: 6]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '7501055334001';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('7501055334001', 'Valle Mega Lata Mango 453ml  6pz', 1, 78.54) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'PAQUETE' (Factor: 6)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 6 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 6 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'PAQUETE', 6) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 105, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 105, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 12, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 12, 0);
    END IF;

    -- Row 536: 7501055356928 (Valle Pulpy 237ml 24pz) - [Factor: 24]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '7501055356928';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('7501055356928', 'Valle Pulpy 237ml 24pz', 1, 135) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'PAQUETE' (Factor: 24)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 24 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 24 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'PAQUETE', 24) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 165, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 165, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 13, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 13, 0);
    END IF;

    -- Row 537: 7501055356898 (Valle Pulpy Mango) - [Factor: 1]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '7501055356898';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('7501055356898', 'Valle Pulpy Mango', 1, 49.3) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'Pieza' (Factor: 1)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 1 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 1 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'Pieza', 1) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 55, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 55, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 1, cantidad_minima = 1 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 1, 1);
    END IF;

    -- Row 538: 32239052000 (Valle Vidrio Mango 413ml 6pz) - [Factor: 6]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '32239052000';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('32239052000', 'Valle Vidrio Mango 413ml 6pz', 1, 80) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'PAQUETE' (Factor: 6)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 6 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 6 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'PAQUETE', 6) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 105, precio_mayoreo = 82 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 105, 82);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 32, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 32, 0);
    END IF;

    -- Row 539: 32239052024 (Valle Vidrio Manzana 413ml 6pz) - [Factor: 6]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '32239052024';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('32239052024', 'Valle Vidrio Manzana 413ml 6pz', 1, 80) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'PAQUETE' (Factor: 6)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 6 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 6 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'PAQUETE', 6) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 105, precio_mayoreo = 82 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 105, 82);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 6, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 6, 0);
    END IF;

    -- Row 540: 32239052017 (Valle Vidrio durazno 413ml 6 Pz) - [Factor: 6]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '32239052017';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('32239052017', 'Valle Vidrio durazno 413ml 6 Pz', 1, 80) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'PAQUETE' (Factor: 6)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 6 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 6 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'PAQUETE', 6) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 105, precio_mayoreo = 82 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 105, 82);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 30, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 30, 0);
    END IF;

    -- Row 541: 7503044233470 (Vicky Chamoy 355 12pz) - [Factor: 12]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '7503044233470';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('7503044233470', 'Vicky Chamoy 355 12pz', 10, 212.97) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'PAQUETE' (Factor: 12)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 12 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 12 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'PAQUETE', 12) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 230, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 230, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 3, cantidad_minima = 1 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 3, 1);
    END IF;

    -- Row 542: 7501064199769 (Vicky Chamoy 473ml Con 24pz) - [Factor: 24]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '7501064199769';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('7501064199769', 'Vicky Chamoy 473ml Con 24pz', 10, 445) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'PAQUETE' (Factor: 24)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 24 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 24 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'PAQUETE', 24) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 510, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 510, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 36, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 36, 0);
    END IF;

    -- Row 543: 7503044233494 (Vicky Mango 355 12pz) - [Factor: 12]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '7503044233494';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('7503044233494', 'Vicky Mango 355 12pz', 10, 212.97) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'PAQUETE' (Factor: 12)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 12 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 12 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'PAQUETE', 12) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 230, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 230, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 2, cantidad_minima = 1 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 2, 1);
    END IF;

    -- Row 544: 7503024460698 (Vicky Mango 473ml Con 24 Pz) - [Factor: 24]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '7503024460698';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('7503024460698', 'Vicky Mango 473ml Con 24 Pz', 10, 445) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'PAQUETE' (Factor: 24)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 24 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 24 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'PAQUETE', 24) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 510, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 510, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 15, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 15, 0);
    END IF;

    -- Row 545: 7503034941903 (Vicky Mexcal Jengibre Limon Con 6pz) - [Factor: 6]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '7503034941903';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('7503034941903', 'Vicky Mexcal Jengibre Limon Con 6pz', 10, 117) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'PAQUETE' (Factor: 6)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 6 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 6 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'PAQUETE', 6) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 125, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 125, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 0, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 0, 0);
    END IF;

    -- Row 546: 7503034941989 (Vicky Mexcal Ponche 355ml Con 6pz) - [Factor: 6]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '7503034941989';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('7503034941989', 'Vicky Mexcal Ponche 355ml Con 6pz', 10, 117) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'PAQUETE' (Factor: 6)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 6 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 6 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'PAQUETE', 6) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 125, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 125, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 0, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 0, 0);
    END IF;

    -- Row 547: 7503034941897 (Vicky Mezcal Jamaica 355ml Con 6pz) - [Factor: 6]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '7503034941897';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('7503034941897', 'Vicky Mezcal Jamaica 355ml Con 6pz', 10, 117) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'PAQUETE' (Factor: 6)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 6 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 6 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'PAQUETE', 6) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 125, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 125, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 0, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 0, 0);
    END IF;

    -- Row 548: 7503034941767 (Vicky Pia 473ml Con 24pz) - [Factor: 24]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '7503034941767';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('7503034941767', 'Vicky Pia 473ml Con 24pz', 10, 445) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'PAQUETE' (Factor: 24)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 24 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 24 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'PAQUETE', 24) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 510, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 510, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 17, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 17, 0);
    END IF;

    -- Row 549: 7503052713285 (Vicky Tajin) - [Factor: 1]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '7503052713285';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('7503052713285', 'Vicky Tajin', 10, 466) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'Pieza' (Factor: 1)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 1 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 1 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'Pieza', 1) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 510, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 510, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 1, cantidad_minima = 1 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 1, 1);
    END IF;

    -- Row 550: 7501064194146 (Victoria 710ml Lata 12pz) - [Factor: 12]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '7501064194146';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('7501064194146', 'Victoria 710ml Lata 12pz', 10, 406) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'PAQUETE' (Factor: 12)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 12 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 12 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'PAQUETE', 12) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 420, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 420, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 7, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 7, 0);
    END IF;

    -- Row 551: 7501064195310 (Victoria Bote 355ml Con 24pz) - [Factor: 24]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '7501064195310';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('7501064195310', 'Victoria Bote 355ml Con 24pz', 10, 370) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'PAQUETE' (Factor: 24)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 24 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 24 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'PAQUETE', 24) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 390, precio_mayoreo = 380 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 390, 380);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 66, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 66, 0);
    END IF;

    -- Row 552: 7503034941194 (Victoria Cepasuchilt 473ml) - [Factor: 1]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '7503034941194';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('7503034941194', 'Victoria Cepasuchilt 473ml', 10, 400) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'Pieza' (Factor: 1)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 1 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 1 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'Pieza', 1) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 425, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 425, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 0, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 0, 0);
    END IF;

    -- Row 553: 75026967 (Victoria Cuarto 24pz) - [Factor: 24]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '75026967';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('75026967', 'Victoria Cuarto 24pz', 10, 212.09) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'PAQUETE' (Factor: 24)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 24 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 24 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'PAQUETE', 24) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 235, precio_mayoreo = 220 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 235, 220);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 139, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 139, 0);
    END IF;

    -- Row 554: 7503024460483 (Victoria Lata Chica 330ml) - [Factor: 1]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '7503024460483';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('7503024460483', 'Victoria Lata Chica 330ml', 10, 290) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'Pieza' (Factor: 1)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 1 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 1 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'Pieza', 1) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 315, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 315, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 0, cantidad_minima = 1 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 0, 1);
    END IF;

    -- Row 555: 7501064194139 (Victoria Laton 473ml Con 24pz) - [Factor: 24]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '7501064194139';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('7501064194139', 'Victoria Laton 473ml Con 24pz', 10, 442.87) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'PAQUETE' (Factor: 24)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 24 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 24 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'PAQUETE', 24) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 470, precio_mayoreo = 465 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 470, 465);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 1652, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 1652, 0);
    END IF;

    -- Row 556: VICTORIAPROMO122344 (Victoria Laton Promo) - [Factor: 1]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = 'VICTORIAPROMO122344';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('VICTORIAPROMO122344', 'Victoria Laton Promo', 10, 415) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'Pieza' (Factor: 1)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 1 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 1 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'Pieza', 1) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 440, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 440, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 0, cantidad_minima = 2 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 0, 2);
    END IF;

    -- Row 557: 7506192506816 (Vitaloe 320 Ml Con 12 Pz) - [Factor: 12]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '7506192506816';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('7506192506816', 'Vitaloe 320 Ml Con 12 Pz', 14, 130) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'PAQUETE' (Factor: 12)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 12 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 12 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'PAQUETE', 12) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 150, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 150, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 14, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 14, 0);
    END IF;

    -- Row 558: 7506192507561 (Vitaloe 500ml Copn 12pz) - [Factor: 12]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '7506192507561';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('7506192507561', 'Vitaloe 500ml Copn 12pz', 14, 170) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'PAQUETE' (Factor: 12)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 12 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 12 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'PAQUETE', 12) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 190, precio_mayoreo = 200 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 190, 200);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 12, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 12, 0);
    END IF;

    -- Row 559: 7506192510684 (Vive 100 400ml 12 Pz) - [Factor: 12]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '7506192510684';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('7506192510684', 'Vive 100 400ml 12 Pz', 14, 105) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'PAQUETE' (Factor: 12)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 12 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 12 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'PAQUETE', 12) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 120, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 120, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 48, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 48, 0);
    END IF;

    -- Row 560: 7506192507417 (Vive 100 Citrus Amarillo 500ml Con 12pz) - [Factor: 12]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '7506192507417';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('7506192507417', 'Vive 100 Citrus Amarillo 500ml Con 12pz', 14, 152.5) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'PAQUETE' (Factor: 12)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 12 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 12 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'PAQUETE', 12) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 163, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 163, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 0, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 0, 0);
    END IF;

    -- Row 561: 7506192506953 (Vive 100 Fuzion Morado 500ml 12 Pz) - [Factor: 12]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '7506192506953';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('7506192506953', 'Vive 100 Fuzion Morado 500ml 12 Pz', 14, 152.5) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'PAQUETE' (Factor: 12)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 12 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 12 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'PAQUETE', 12) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 163, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 163, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 0, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 0, 0);
    END IF;

    -- Row 562: 7506192508001 (Vive 100 Mora 500ml 12pz) - [Factor: 12]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '7506192508001';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('7506192508001', 'Vive 100 Mora 500ml 12pz', 14, 152.5) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'PAQUETE' (Factor: 12)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 12 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 12 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'PAQUETE', 12) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 163, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 163, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 2, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 2, 0);
    END IF;

    -- Row 563: 7506192505451 (Vive 100 Normal 12 Pz 600ML) - [Factor: 12]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '7506192505451';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('7506192505451', 'Vive 100 Normal 12 Pz 600ML', 14, 120) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'PAQUETE' (Factor: 12)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 12 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 12 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'PAQUETE', 12) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 170, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 170, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 12, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 12, 0);
    END IF;

    -- Row 564: 7506192509619 (Vive 100 Xtreme 12pz 500ml) - [Factor: 12]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '7506192509619';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('7506192509619', 'Vive 100 Xtreme 12pz 500ml', 14, 120) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'PAQUETE' (Factor: 12)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 12 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 12 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'PAQUETE', 12) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 170, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 170, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 8, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 8, 0);
    END IF;

    -- Row 565: 7506192503259 (Vive 100 Xtreme Power 355ml 12pz Lata) - [Factor: 12]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '7506192503259';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('7506192503259', 'Vive 100 Xtreme Power 355ml 12pz Lata', 10, 130) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'PAQUETE' (Factor: 12)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 12 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 12 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'PAQUETE', 12) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 145, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 145, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 1, cantidad_minima = 1 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 1, 1);
    END IF;

    -- Row 566: VINAREAL330ML (Via Real 330ml 12pz Surtd) - [Factor: 12]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = 'VINAREAL330ML';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('VINAREAL330ML', 'Via Real 330ml 12pz Surtd', 10, 234) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'PAQUETE' (Factor: 12)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 12 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 12 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'PAQUETE', 12) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 250, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 250, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 4, cantidad_minima = 1 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 4, 1);
    END IF;

    -- Row 567: 37050153670560 (Via Real Fresa Sandia) - [Factor: 1]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '37050153670560';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('37050153670560', 'Via Real Fresa Sandia', 10, 343.8) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'Pieza' (Factor: 1)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 1 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 1 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'Pieza', 1) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 360, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 360, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 0, cantidad_minima = 1 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 0, 1);
    END IF;

    -- Row 568: 17501053675509 (Via Real Sabor Bluberry) - [Factor: 1]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '17501053675509';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('17501053675509', 'Via Real Sabor Bluberry', 10, 343.8) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'Pieza' (Factor: 1)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 1 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 1 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'Pieza', 1) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 360, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 360, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 1, cantidad_minima = 1 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 1, 1);
    END IF;

    -- Row 569: 17501053670504 (Via Real Sabor Durazno) - [Factor: 1]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '17501053670504';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('17501053670504', 'Via Real Sabor Durazno', 10, 343.8) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'Pieza' (Factor: 1)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 1 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 1 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'Pieza', 1) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 360, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 360, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 0, cantidad_minima = 1 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 0, 1);
    END IF;

    -- Row 570: 7503037623721 (Volt Gamer 12pz) - [Factor: 12]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '7503037623721';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('7503037623721', 'Volt Gamer 12pz', 10, 204) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'PAQUETE' (Factor: 12)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 12 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 12 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'PAQUETE', 12) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 220, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 220, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 0, cantidad_minima = 1 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 0, 1);
    END IF;

    -- Row 571: 7503027753605 (Volt Lata Dark Energy 473ml Con 12pz) - [Factor: 12]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '7503027753605';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('7503027753605', 'Volt Lata Dark Energy 473ml Con 12pz', 14, 204) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'PAQUETE' (Factor: 12)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 12 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 12 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'PAQUETE', 12) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 220, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 220, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 0, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 0, 0);
    END IF;

    -- Row 572: 7506241204144 (Volt Lata Magnesio Frutos Rojos 473ml Con 12pz) - [Factor: 12]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '7506241204144';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('7506241204144', 'Volt Lata Magnesio Frutos Rojos 473ml Con 12pz', 14, 200) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'PAQUETE' (Factor: 12)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 12 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 12 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'PAQUETE', 12) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 220, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 220, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 9, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 9, 0);
    END IF;

    -- Row 573: 7506241205646 (Volt Lata Pink  Energy 473ml Con 12pz) - [Factor: 12]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '7506241205646';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('7506241205646', 'Volt Lata Pink  Energy 473ml Con 12pz', 14, 204) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'PAQUETE' (Factor: 12)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 12 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 12 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'PAQUETE', 12) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 220, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 220, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 0, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 0, 0);
    END IF;

    -- Row 574: 7503027753650 (Volt Mora Lata 473ml Con 15pz) - [Factor: 15]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '7503027753650';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('7503027753650', 'Volt Mora Lata 473ml Con 15pz', 14, 207) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'PAQUETE' (Factor: 15)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 15 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 15 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'PAQUETE', 15) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 220, precio_mayoreo = 220 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 220, 220);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 9, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 9, 0);
    END IF;

    -- Row 575: 7503027753667 (Volt Mora Plastico 400ml) - [Factor: 1]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '7503027753667';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('7503027753667', 'Volt Mora Plastico 400ml', 14, 130) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'Pieza' (Factor: 1)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 1 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 1 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'Pieza', 1) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 145, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 145, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 0, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 0, 0);
    END IF;

    -- Row 576: 7503027753629 (Volt Normal Azul Yellow 473ml Con 15pz) - [Factor: 15]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '7503027753629';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('7503027753629', 'Volt Normal Azul Yellow 473ml Con 15pz', 14, 207) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'PAQUETE' (Factor: 15)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 15 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 15 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'PAQUETE', 15) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 220, precio_mayoreo = 220 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 220, 220);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 96, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 96, 0);
    END IF;

    -- Row 577: 7503027753636 (Volt Yellow 400ml Plastico Con 12 Pz) - [Factor: 12]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '7503027753636';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('7503027753636', 'Volt Yellow 400ml Plastico Con 12 Pz', 14, 110) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'PAQUETE' (Factor: 12)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 12 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 12 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'PAQUETE', 12) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 125, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 125, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 4, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 4, 0);
    END IF;

    -- Row 578: VUALASURTD245667 (Vuala Surtido Tira) - [Factor: 1]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = 'VUALASURTD245667';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('VUALASURTD245667', 'Vuala Surtido Tira', 7, 80) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'Pieza' (Factor: 1)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 1 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 1 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'Pieza', 1) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 87, precio_mayoreo = 85 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 87, 85);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 17, cantidad_minima = 1 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 17, 1);
    END IF;

    -- Row 579: 754177837159 (Winis Sdo Con 20 Pz) - [Factor: 20]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '754177837159';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('754177837159', 'Winis Sdo Con 20 Pz', 2, 40.45) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'PAQUETE' (Factor: 20)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 20 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 20 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'PAQUETE', 20) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 50, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 50, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 7, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 7, 0);
    END IF;

    -- Row 580: 7501032398743 (YOGHURT DANONE FRESA MANZANA CON 12) - [Factor: 12]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '7501032398743';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('7501032398743', 'YOGHURT DANONE FRESA MANZANA CON 12', 9, 101.5) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'PAQUETE' (Factor: 12)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 12 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 12 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'PAQUETE', 12) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 110, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 110, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 0, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 0, 0);
    END IF;

    -- Row 581: 7501055399758 (YOLIS 355ML 12PZ) - [Factor: 12]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '7501055399758';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('7501055399758', 'YOLIS 355ML 12PZ', 1, 95.55) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'PAQUETE' (Factor: 12)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 12 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 12 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'PAQUETE', 12) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 110, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 110, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 0, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 0, 0);
    END IF;

    -- Row 582: 7501055915873 (Yogurt Alpura Vaso Surtido) - [Factor: 1]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '7501055915873';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('7501055915873', 'Yogurt Alpura Vaso Surtido', 9, 68.18) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'Pieza' (Factor: 1)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 1 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 1 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'Pieza', 1) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 80, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 80, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 0, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 0, 0);
    END IF;

    -- Row 583: 7506443104082 (Yogurt Danone Surtido Con 12pz) - [Factor: 12]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '7506443104082';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('7506443104082', 'Yogurt Danone Surtido Con 12pz', 9, 101.5) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'PAQUETE' (Factor: 12)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 12 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 12 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'PAQUETE', 12) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 110, precio_mayoreo = 0 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 110, 0);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 0, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 0, 0);
    END IF;

    -- Row 584: 7501020561241 (Yogurth Lala Surtido Con 12Pz) - [Factor: 12]
    
    -- 1. Get or Create Product
    SELECT id_producto INTO prod_id FROM productos WHERE sku_pieza = '7501020561241';
    
    IF prod_id IS NULL THEN
        INSERT INTO productos (sku_pieza, nombre_producto, id_categoria, precio_costo) 
        VALUES ('7501020561241', 'Yogurth Lala Surtido Con 12Pz', 9, 90.51) 
        RETURNING id_producto INTO prod_id;
    END IF;

    -- 2. Get or Create Unit 'PAQUETE' (Factor: 12)
    -- Logic: If 'Pieza', look for standard piece. If 'PAQUETE', look for specific factor.
    IF 12 = 1 THEN
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND (LOWER(nombre_presentacion) = 'pieza' OR factor_conversion_cantidad = 1) 
        LIMIT 1;
    ELSE
        SELECT id_unidad_venta INTO unit_id FROM unidadesventa 
        WHERE id_producto = prod_id AND LOWER(nombre_presentacion) = 'paquete' AND factor_conversion_cantidad = 12 
        LIMIT 1;
    END IF;
    
    IF unit_id IS NULL THEN
        INSERT INTO unidadesventa (id_producto, nombre_presentacion, factor_conversion_cantidad) 
        VALUES (prod_id, 'PAQUETE', 12) 
        RETURNING id_unidad_venta INTO unit_id;
    END IF;

    -- 3. Upsert Price for Branch 2
    IF EXISTS (SELECT 1 FROM precios WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id) THEN
        UPDATE precios SET precio_venta = 110, precio_mayoreo = 105 
        WHERE id_unidad_venta = unit_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO precios (id_unidad_venta, id_sucursal, precio_venta, precio_mayoreo) 
        VALUES (unit_id, sucursal_id, 110, 105);
    END IF;

    -- 4. Upsert Stock for Branch 2
    IF EXISTS (SELECT 1 FROM inventariostock WHERE id_producto = prod_id AND id_sucursal = sucursal_id) THEN
        UPDATE inventariostock SET cantidad_actual = 0, cantidad_minima = 0 
        WHERE id_producto = prod_id AND id_sucursal = sucursal_id;
    ELSE
        INSERT INTO inventariostock (id_producto, id_sucursal, cantidad_actual, cantidad_minima) 
        VALUES (prod_id, sucursal_id, 0, 0);
    END IF;

END $$;
